<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-EV8RVEFX82"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-EV8RVEFX82');
            
        </script>
    <meta property="og:title" content="Miscellaneous workflows with Datalab" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.cleanlab.ai/master/tutorials/datalab/workflows.html" />
<meta property="og:site_name" content="cleanlab" />
<meta property="og:description" content="This tutorial demonstrates various useful things you can do with Datalab that may not be covered in other tutorials. First get familiar with Datalab via the quickstart/ advanced tutorials before go..." />
<meta property="og:image" content="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/clos-preview-card.png" />
<meta property="og:image:alt" content="cleanlab" />
<meta name="description" content="This tutorial demonstrates various useful things you can do with Datalab that may not be covered in other tutorials. First get familiar with Datalab via the quickstart/ advanced tutorials before go..." />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Improving ML Performance via Data Curation with Train vs Test Splits" href="../improving_ml_performance.html" /><link rel="prev" title="Datalab Issue Types" href="../../cleanlab/datalab/guide/issue_type_description.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/cleanlab/assets/a4483476d449f2f05a4c7cde329e72358099cc07/cleanlab/cleanlab_favicon.svg"/><!-- Generated with Sphinx 7.1.2 and Furo 2023.09.10 -->
        <title>Miscellaneous workflows with Datalab - cleanlab</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=96bccb3e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">cleanlab</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a style="padding-bottom: 0px;" class="sidebar-brand" href="../../index.html">
    
    <div class="sidebar-logo-container">
        <img class="sidebar-logo" src="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/cleanlab_logo_only.png" alt="Logo" />
    </div>
    
    <span style="margin-bottom:0px" class="sidebar-brand-text">
        cleanlab
    </span>
    
</a>

<div class="centered">
    <a style="margin-top: 6px;" class="github-button" href="https://github.com/cleanlab/cleanlab" data-size="large" data-show-count="true"
    aria-label="Star cleanlab/cleanlab on GitHub">Star</a>
</div>
<form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Datalab Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Datalab Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="datalab_quickstart.html">Detecting Common Data Issues with Datalab</a></li>
<li class="toctree-l2"><a class="reference internal" href="datalab_advanced.html">Advanced Data Auditing with Datalab</a></li>
<li class="toctree-l2"><a class="reference internal" href="text.html">Text Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="tabular.html">Tabular Data (Numeric/Categorical)</a></li>
<li class="toctree-l2"><a class="reference internal" href="image.html">Image Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="audio.html">Audio Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/datalab/guide/issue_type_description.html">Guide to Datalab Issue Types</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Miscellaneous workflows with Datalab</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../improving_ml_performance.html">Improving ML Performance</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../clean_learning/index.html">CleanLearning Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of CleanLearning Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../clean_learning/text.html">Text Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clean_learning/tabular.html">Tabular Classification (Numeric/Categorical)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../indepth_overview.html">Workflows of Data-Centric AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset_health.html">Analyze Dataset-level Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../outliers.html">Outlier Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multiannotator.html">Improving Consensus Labels for Multiannotator Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multilabel_classification.html">Multi-Label Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regression.html">Noisy Labels in Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../token_classification.html">Token Classification (text)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../segmentation.html">Image Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../object_detection.html">Object Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pred_probs_cross_val.html">Predicted Probabilities via Cross Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/datalab/index.html">datalab</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of datalab</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cleanlab/datalab/guide/index.html">Datalab guides</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Datalab guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/guide/issue_type_description.html">Datalab Issue Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/guide/custom_issue_manager.html">Creating Your Own Issues Manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/datalab/datalab.html">datalab</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cleanlab/datalab/internal/index.html">internal</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of internal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/internal/data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/internal/data_issues.html">data_issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_finder.html">issue_finder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/internal/factory.html">factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/internal/model_outputs.html">model_outputs</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/index.html">issue_manager</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of issue_manager</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/issue_manager.html">Base issue_manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/label.html">label</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/outlier.html">outlier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/duplicate.html">duplicate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/noniid.html">noniid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/imbalance.html">imbalance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/underperforming_group.html">underperforming_group</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/null.html">null</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/data_valuation.html">data_valuation</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/regression/index.html">regression</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of regression</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/regression/label.html">label</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/multilabel/index.html">multilabel</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of multilabel</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../cleanlab/datalab/internal/issue_manager/multilabel/label.html">label</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/internal/report.html">report</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/datalab/internal/task.html">task</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/classification.html">classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/filter.html">filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/rank.html">rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/count.html">count</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/dataset.html">dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/outlier.html">outlier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/multiannotator.html">multiannotator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cleanlab/data_valuation.html">data_valuation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/multilabel_classification/index.html">multilabel_classification</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of multilabel_classification</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/multilabel_classification/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/multilabel_classification/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/multilabel_classification/dataset.html">dataset</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/regression/index.html">regression</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of regression</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/regression/rank.html">regression.rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/regression/learn.html">regression.learn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/token_classification/index.html">token_classification</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of token_classification</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/token_classification/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/token_classification/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/token_classification/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/segmentation/index.html">segmentation</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of segmentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/segmentation/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/segmentation/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/segmentation/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/object_detection/index.html">object_detection</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of object_detection</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/object_detection/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/object_detection/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/object_detection/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/benchmarking/index.html">benchmarking</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of benchmarking</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/benchmarking/noise_generation.html">noise_generation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/models/index.html">models</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/models/keras.html">keras</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/experimental/index.html">experimental</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of experimental</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/experimental/label_issues_batched.html">label_issues_batched</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/experimental/span_classification.html">span_classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/experimental/mnist_pytorch.html">mnist_pytorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/experimental/coteaching.html">coteaching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/experimental/cifar_cnn.html">cifar_cnn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/internal/index.html">internal</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of internal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/util.html">util</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/latent_algebra.html">latent_algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/label_quality_utils.html">label_quality_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/multilabel_utils.html">multilabel_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/multilabel_scorer.html">multilabel_scorer</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cleanlab/internal/neighbor/index.html">neighbor</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of neighbor</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/internal/neighbor/knn_graph.html">knn_graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/internal/neighbor/metric.html">metric</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cleanlab/internal/neighbor/search.html">search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/outlier.html">outlier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/token_classification_utils.html">token_classification_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/internal/validation.html">validation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cleanlab/datalab/guide/index.html">Datalab issue types</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Datalab issue types</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/datalab/guide/issue_type_description.html">Datalab Issue Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cleanlab/datalab/guide/custom_issue_manager.html">Creating Your Own Issues Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/cleanlab/cleanlab/blob/master/CONTRIBUTING.md">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai">Website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/cleanlab/cleanlab">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/cleanlab/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://anaconda.org/conda-forge/cleanlab">Conda</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai/slack">Community Discussions</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai/blog/">Blog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/@CleanlabAI/playlists">Videos</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai/blog/data-centric-ai/">Cleanlab Studio (Easy Mode)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://help.cleanlab.ai">Cleanlab Studio Docs</a></li>
</ul>

</div>


<!-- Start of versioning -->

<div class="sidebar-tree">
    <p class="caption" role="heading">
        <span class="caption-text">Versions</span>
    </p>
    <ul>
        <li class="toctree-l1">
            <a
                id="version_number"
                class="reference internal"
                href="/cleanlab-docs/"
                >stable</a
            >
        </li>
        <li class="toctree-l1">
            <a
                id="commit_hash"
                class="reference internal"
                href="/cleanlab-docs/master/"
                >developer</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.6"
                class="reference internal"
                href="/cleanlab-docs/v2.6.6/"
                >v2.6.6</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.5"
                class="reference internal"
                href="/cleanlab-docs/v2.6.5/"
                >v2.6.5</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.4"
                class="reference internal"
                href="/cleanlab-docs/v2.6.4/"
                >v2.6.4</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.3"
                class="reference internal"
                href="/cleanlab-docs/v2.6.3/"
                >v2.6.3</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.2"
                class="reference internal"
                href="/cleanlab-docs/v2.6.2/"
                >v2.6.2</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.1"
                class="reference internal"
                href="/cleanlab-docs/v2.6.1/"
                >v2.6.1</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.0"
                class="reference internal"
                href="/cleanlab-docs/v2.6.0/"
                >v2.6.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.5.0"
                class="reference internal"
                href="/cleanlab-docs/v2.5.0/"
                >v2.5.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.4.0"
                class="reference internal"
                href="/cleanlab-docs/v2.4.0/"
                >v2.4.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.3.1"
                class="reference internal"
                href="/cleanlab-docs/v2.3.1/"
                >v2.3.1</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.3.0"
                class="reference internal"
                href="/cleanlab-docs/v2.3.0/"
                >v2.3.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.2.0"
                class="reference internal"
                href="/cleanlab-docs/v2.2.0/"
                >v2.2.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.1.0"
                class="reference internal"
                href="/cleanlab-docs/v2.1.0/"
                >v2.1.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.0.0"
                class="reference internal"
                href="/cleanlab-docs/v2.0.0/"
                >v2.0.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v1.0.1"
                class="reference internal"
                href="/cleanlab-docs/v1.0.1/"
                >v1.0.1</a
            >
        </li>
        
    </ul>
</div>

<br>
<br>

<script
    type="text/javascript"
    src="/cleanlab-docs/versioning.js"
></script>

<script type="text/javascript">
    window.addEventListener("load", () => {
        const version_number = Version.version_number;
        const commit_hash = Version.commit_hash;

        document.getElementById("version_number").innerHTML =
            "stable <code class='docutils literal notranslate'><span class='pre'> (" +
            version_number +
            ")</span></code>";
        document.getElementById("commit_hash").innerHTML =
            "master <code class='docutils literal notranslate'><span class='pre'> (" +
            commit_hash.slice(0, 7) +
            "&hellip;)</span></code>";
    });
</script>

<!-- End of versioning -->

</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          

<noscript>
  <div class="admonition warning">
    <p class="admonition-title">Warning</p>
    <p>Parts of this site uses JavaScript, but your browser does not support it.</p>
  </div>
</noscript>



<!-- Start of Version Warning Banner -->

<p id="doc_ver_warning"></p>

<script
    type="text/javascript"
    src="/cleanlab-docs/versioning.js"
></script>
<script type="text/javascript">
    window.addEventListener("load", () => {
        const version_number = Version.version_number;
        const path_arr = window.location.pathname.split("/");

        if (path_arr.includes("master")) {
            document.getElementById("doc_ver_warning").innerHTML =
            `<div class="admonition warning">
            <p class="admonition-title">Warning</p>
            <p>This version of the documentation corresponds to the master branch of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> source code from <a href="https://github.com/cleanlab/cleanlab/">GitHub</a>. To see the documentation for the latest <code class="docutils literal notranslate"><span class="pre">pip</span></code>-installed version, click <a href="/cleanlab-docs/">here</a>.</p>
            </div>`;
        } else if (!path_arr.includes(version_number) && !path_arr.includes("stable")) {
            document.getElementById("doc_ver_warning").innerHTML =
            `<div class="admonition warning">
            <p class="admonition-title">Warning</p>
            <p>This documentation is for an old version (<code class="docutils literal notranslate"><span class="pre">master</span></code>) of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code>. To see the documentation for the latest stable version (<code class="docutils literal notranslate"><span class="pre">` + version_number + `</span></code>), click <a href="/cleanlab-docs/">here</a>.</p>
            </div>`;
        } else {
            document.getElementById("doc_ver_warning").remove();
        }
    });
</script>

<!-- End of Version Warning Banner -->

 <style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }

    .output_area {
        max-height: 300px;
        overflow: auto;
    }

    .dataframe {
        background: #D7D7D7;
    }

    th {
        color:black;
    }
</style>

<script type="text/javascript">
    window.addEventListener('load', () => {
        const h1_element = document.getElementsByTagName("h1");
        h1_element[0].insertAdjacentHTML("afterend", `
        <p>
            <a style="background-color:white;color:black;padding:4px 12px;text-decoration:none;display:inline-block;border-radius:8px;box-shadow:0 2px 4px 0 rgba(0, 0, 0, 0.2), 0 3px 10px 0 rgba(0, 0, 0, 0.19)" href="https://colab.research.google.com/github/elisno/cleanlab-docs/blob/master/master/tutorials/datalab/workflows.ipynb" target="_blank">
            <img src="https://colab.research.google.com/img/colab_favicon_256px.png" alt="" style="width:40px;height:40px;vertical-align:middle">
            <span style="vertical-align:middle">Run in Google Colab</span>
            </a>
        </p>
        `);
    })

</script><section id="Miscellaneous-workflows-with-Datalab">
<h1>Miscellaneous workflows with Datalab<a class="headerlink" href="#Miscellaneous-workflows-with-Datalab" title="Permalink to this heading">#</a></h1>
<p>This tutorial demonstrates various useful things you can do with <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> that may not be covered in other tutorials. First get familiar with <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> via the <a class="reference external" href="datalab_quickstart.html">quickstart</a>/<a class="reference external" href="datalab_advanced.html">advanced</a> tutorials before going through this one.</p>
<section id="Accelerate-Issue-Checks-with-Pre-computed-kNN-Graphs">
<h2>Accelerate Issue Checks with Pre-computed kNN Graphs<a class="headerlink" href="#Accelerate-Issue-Checks-with-Pre-computed-kNN-Graphs" title="Permalink to this heading">#</a></h2>
<p>By default, <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> will detect certain types of issues by constructing a k-nearest neighbors graph of your dataset using the <a class="reference external" href="https://scikit-learn.org/stable/modules/neighbors.html">scikit-learn</a> package. Here we demonstrate how to use your own pre-computed k-nearest neighbors (kNN) graphs with <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>. This allows you to use more efficient approximate kNN graphs to scale to bigger datasets.</p>
<p>Using pre-computed kNN graphs is optional and not required for <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to function. <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> can automatically compute these graphs for you.</p>
<p>While we use a toy dataset for demonstration, these steps can be applied to any dataset.</p>
<section id="1.-Load-and-Prepare-Your-Dataset">
<h3>1. Load and Prepare Your Dataset<a class="headerlink" href="#1.-Load-and-Prepare-Your-Dataset" title="Permalink to this heading">#</a></h3>
<p>Here we’ll generate a synthetic dataset, but you should replace this with your own dataset loading process.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Replace this section with your own dataset loading</span>
<span class="c1"># For demonstration, we create a synthetic classification dataset</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_informative</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_redundant</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">n_repeated</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">n_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">n_clusters_per_class</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">flip_y</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
    <span class="n">class_sep</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># Example: Add a duplicate example to the dataset</span>
<span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.001</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Compute-kNN-Graph">
<h3>2. Compute kNN Graph<a class="headerlink" href="#2.-Compute-kNN-Graph" title="Permalink to this heading">#</a></h3>
<p>We will compute the kNN graph using <a class="reference external" href="https://github.com/facebookresearch/faiss">FAISS</a>, a library for efficient similarity search. This step involves creating a kNN graph that represents the nearest neighbors for each point in your dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">faiss</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Faiss uses single precision, so we need to convert the data type</span>
<span class="n">X_faiss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Normalize the vectors for inner product similarity (effectively cosine similarity)</span>
<span class="n">faiss</span><span class="o">.</span><span class="n">normalize_L2</span><span class="p">(</span><span class="n">X_faiss</span><span class="p">)</span>

<span class="c1"># Build the index using FAISS</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">faiss</span><span class="o">.</span><span class="n">index_factory</span><span class="p">(</span><span class="n">X_faiss</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;HNSW32,Flat&quot;</span><span class="p">,</span> <span class="n">faiss</span><span class="o">.</span><span class="n">METRIC_INNER_PRODUCT</span><span class="p">)</span>

<span class="c1"># Add the dataset to the index</span>
<span class="n">index</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">X_faiss</span><span class="p">)</span>

<span class="c1"># Perform the search to find k-nearest neighbors</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Number of neighbors to consider</span>
<span class="n">D</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">X_faiss</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Include the point itself during search</span>

<span class="c1"># Remove the first column (self-distances)</span>
<span class="n">D</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">D</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">I</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>

<span class="c1"># Convert cosine similarity to cosine distance</span>
<span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">D</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>

<span class="c1"># Create the kNN graph</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">csr_matrix</span>


<span class="k">def</span> <span class="nf">create_knn_graph</span><span class="p">(</span><span class="n">distances</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">csr_matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a K-nearest neighbors (KNN) graph in CSR format from provided distances and indices.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    distances (np.ndarray): 2D array of shape (n_samples, n_neighbors) containing distances to nearest neighbors.</span>
<span class="sd">    indices (np.ndarray): 2D array of shape (n_samples, n_neighbors) containing indices of nearest neighbors.</span>

<span class="sd">    Returns:</span>
<span class="sd">    scipy.sparse.csr_matrix: KNN graph in CSR format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">distances</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">indices</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;distances and indices must have the same shape&quot;</span>

    <span class="n">n_samples</span><span class="p">,</span> <span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># Convert to 1D arrays for CSR matrix creation</span>
    <span class="n">indices_1d</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">distances_1d</span> <span class="o">=</span> <span class="n">distances</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">indptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">*</span> <span class="n">n_neighbors</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="p">)</span>

    <span class="c1"># Create the CSR matrix</span>
    <span class="k">return</span> <span class="n">csr_matrix</span><span class="p">((</span><span class="n">distances_1d</span><span class="p">,</span> <span class="n">indices_1d</span><span class="p">,</span> <span class="n">indptr</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">))</span>


<span class="n">knn_graph</span> <span class="o">=</span> <span class="n">create_knn_graph</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">I</span><span class="p">)</span>

<span class="c1"># Ensure the kNN graph is sorted by row values</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">sort_graph_by_row_values</span>
<span class="n">sort_graph_by_row_values</span><span class="p">(</span><span class="n">knn_graph</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">warn_when_not_sorted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Compressed Sparse Row sparse matrix of dtype &#39;float32&#39;
        with 50000 stored elements and shape (5000, 5000)&gt;
</pre></div></div>
</div>
</section>
<section id="3.-Train-a-Classifier-and-Obtain-Predicted-Probabilities">
<h3>3. Train a Classifier and Obtain Predicted Probabilities<a class="headerlink" href="#3.-Train-a-Classifier-and-Obtain-Predicted-Probabilities" title="Permalink to this heading">#</a></h3>
<p>Predicted class probabilities from a model trained on your dataset are used to identify label issues.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_predict</span>

<span class="c1"># Obtain predicted probabilities using cross-validation</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">pred_probs</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;predict_proba&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Identify-Data-Issues-Using-Datalab">
<h3>4. Identify Data Issues Using Datalab<a class="headerlink" href="#4.-Identify-Data-Issues-Using-Datalab" title="Permalink to this heading">#</a></h3>
<p>Use the pre-computed kNN graph and predicted probabilities to find issues in the dataset using <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="c1"># Initialize Datalab with the dataset</span>
<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>

<span class="c1"># Perform issue detection using the kNN graph and predicted probabilities, when possible</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span><span class="n">knn_graph</span><span class="o">=</span><span class="n">knn_graph</span><span class="p">,</span> <span class="n">pred_probs</span><span class="o">=</span><span class="n">pred_probs</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Collect the identified issues and a summary</span>
<span class="n">issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">()</span>
<span class="n">issue_summary</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issue_summary</span><span class="p">()</span>

<span class="c1"># Display the issues and summary</span>
<span class="n">display</span><span class="p">(</span><span class="n">issue_summary</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">issues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding null issues ...
Finding label issues ...
Finding outlier issues ...
Finding near_duplicate issues ...
Finding non_iid issues ...
Finding class_imbalance issues ...
Finding underperforming_group issues ...

Audit complete. 524 issues found in the dataset.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>issue_type</th>
      <th>score</th>
      <th>num_issues</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>null</td>
      <td>1.000000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>label</td>
      <td>0.991400</td>
      <td>52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>outlier</td>
      <td>0.356925</td>
      <td>363</td>
    </tr>
    <tr>
      <th>3</th>
      <td>near_duplicate</td>
      <td>0.619581</td>
      <td>108</td>
    </tr>
    <tr>
      <th>4</th>
      <td>non_iid</td>
      <td>0.000000</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>class_imbalance</td>
      <td>0.500000</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>underperforming_group</td>
      <td>0.651838</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_null_issue</th>
      <th>null_score</th>
      <th>is_label_issue</th>
      <th>label_score</th>
      <th>is_outlier_issue</th>
      <th>outlier_score</th>
      <th>is_near_duplicate_issue</th>
      <th>near_duplicate_score</th>
      <th>is_non_iid_issue</th>
      <th>non_iid_score</th>
      <th>is_class_imbalance_issue</th>
      <th>class_imbalance_score</th>
      <th>is_underperforming_group_issue</th>
      <th>underperforming_group_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.999827</td>
      <td>True</td>
      <td>0.031217</td>
      <td>False</td>
      <td>0.933716</td>
      <td>False</td>
      <td>0.627345</td>
      <td>False</td>
      <td>0.5</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.998540</td>
      <td>False</td>
      <td>0.530909</td>
      <td>False</td>
      <td>0.296974</td>
      <td>False</td>
      <td>0.646765</td>
      <td>False</td>
      <td>0.5</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.942721</td>
      <td>False</td>
      <td>0.332824</td>
      <td>False</td>
      <td>0.803246</td>
      <td>False</td>
      <td>0.625202</td>
      <td>False</td>
      <td>0.5</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.999816</td>
      <td>False</td>
      <td>0.474031</td>
      <td>False</td>
      <td>0.706253</td>
      <td>False</td>
      <td>0.655108</td>
      <td>False</td>
      <td>0.5</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.997703</td>
      <td>False</td>
      <td>0.131466</td>
      <td>False</td>
      <td>0.912389</td>
      <td>False</td>
      <td>0.639200</td>
      <td>False</td>
      <td>0.5</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4995</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.998646</td>
      <td>False</td>
      <td>0.504755</td>
      <td>False</td>
      <td>0.746777</td>
      <td>False</td>
      <td>0.680033</td>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4996</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.894230</td>
      <td>False</td>
      <td>0.340986</td>
      <td>False</td>
      <td>0.816472</td>
      <td>False</td>
      <td>0.640711</td>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4997</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.999100</td>
      <td>False</td>
      <td>0.428545</td>
      <td>False</td>
      <td>0.592421</td>
      <td>False</td>
      <td>0.658949</td>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4998</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.986792</td>
      <td>False</td>
      <td>0.273710</td>
      <td>True</td>
      <td>0.000000</td>
      <td>False</td>
      <td>0.618033</td>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4999</th>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>0.986776</td>
      <td>False</td>
      <td>0.273524</td>
      <td>True</td>
      <td>0.000000</td>
      <td>False</td>
      <td>0.618084</td>
      <td>False</td>
      <td>1.0</td>
      <td>False</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>5000 rows × 14 columns</p>
</div></div>
</div>
<section id="Explanation:">
<h4>Explanation:<a class="headerlink" href="#Explanation:" title="Permalink to this heading">#</a></h4>
<p><strong>Creating the kNN Graph:</strong></p>
<ul>
<li><p>Compute the kNN graph using FAISS or another library, ensuring the self-points (points referring to themselves) are omitted from the neighbors.</p>
<ul>
<li><p>Some distance kernels or search algorithms (like those in FAISS) may return negative distances or suffer from numerical instability when comparing points that are extremely close to each other. This can lead to incorrect results when constructing the kNN graph.</p></li>
<li><p><strong>Note</strong>: kNN graphs are generally poorly suited for detecting exact duplicates, especially when the number of exact duplicates exceeds the number of requested neighbors. The strengths of this data structure lie in the assumption that data points are similar but not identical, allowing efficient similarity searches and proximity-based analyses.</p></li>
<li><p>If you are comfortable with exploring non-public API functions in the library, you can use the following helper function to ensure that exact duplicate sets are correctly represented in the kNN graph. Please note, this function is not officially supported and is not part of the public API:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab.internal.neighbor.knn_graph</span> <span class="kn">import</span> <span class="n">correct_knn_graph</span>

<span class="n">knn_graph</span> <span class="o">=</span> <span class="n">correct_knn_graph</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">X_faiss</span><span class="p">,</span> <span class="n">knn_graph</span><span class="o">=</span><span class="n">knn_graph</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>You may need to handle self-points yourself with third-party libraries.</p></li>
<li><p>Construct the CSR (Compressed Sparse Row) matrix from the distances and indices arrays.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Datalab</span></code> can automatically construct a kNN graph from a numerical <code class="docutils literal notranslate"><span class="pre">features</span></code> array if one is not provided, in an accurate and reliable manner.</p></li>
</ul>
</li>
<li><p>Sort the kNN graph by row values.</p></li>
</ul>
<p>When using approximate kNN graphs, it is important to understand their strengths and limitations to apply them effectively.</p>
</section>
</section>
</section>
<section id="Data-Valuation">
<h2>Data Valuation<a class="headerlink" href="#Data-Valuation" title="Permalink to this heading">#</a></h2>
<p>In this section, we will show how to use <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to estimate how much each data point contributes to a trained classifier model. Data valuation helps you understand the importance of each data point, where you can identify more/less valuable data points for your machine learning models.</p>
<p>We will use a text dataset for this example, but this approach can be applied to any dataset.</p>
<section id="1.-Load-and-Prepare-the-Dataset">
<h3>1. Load and Prepare the Dataset<a class="headerlink" href="#1.-Load-and-Prepare-the-Dataset" title="Permalink to this heading">#</a></h3>
<p>We will use a subset of the 20 Newsgroups dataset, which is a collection of newsgroup documents suitable for text classification tasks. For demonstration purposes, we’ll classify documents from two categories: “alt.atheism” and “sci.space”.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load the 20 Newsgroups dataset</span>
<span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;alt.atheism&#39;</span><span class="p">,</span> <span class="s1">&#39;sci.space&#39;</span><span class="p">],</span> <span class="n">remove</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;headers&#39;</span><span class="p">,</span> <span class="s1">&#39;footers&#39;</span><span class="p">,</span> <span class="s1">&#39;quotes&#39;</span><span class="p">))</span>

<span class="c1"># Create a DataFrame with the text data and labels</span>
<span class="n">df_text</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Text&quot;</span><span class="p">:</span> <span class="n">newsgroups_train</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;Label&quot;</span><span class="p">:</span> <span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="p">})</span>
<span class="n">df_text</span><span class="p">[</span><span class="s2">&quot;Label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_text</span><span class="p">[</span><span class="s2">&quot;Label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">category</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">)})</span>

<span class="c1"># Display the first few samples</span>
<span class="n">df_text</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Text</th>
      <th>Label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>: \n: &gt;&gt; Please enlighten me.  How is omnipote...</td>
      <td>alt.atheism</td>
    </tr>
    <tr>
      <th>1</th>
      <td>In &lt;19APR199320262420@kelvin.jpl.nasa.gov&gt; baa...</td>
      <td>sci.space</td>
    </tr>
    <tr>
      <th>2</th>
      <td>\nHenry, I made the assumption that he who get...</td>
      <td>sci.space</td>
    </tr>
    <tr>
      <th>3</th>
      <td>\n\n\nNo. I estimate a 99 % probability the Ge...</td>
      <td>sci.space</td>
    </tr>
    <tr>
      <th>4</th>
      <td>\nLucky for them that the baby didn't have any...</td>
      <td>alt.atheism</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="2.-Vectorize-the-Text-Data">
<h3>2. Vectorize the Text Data<a class="headerlink" href="#2.-Vectorize-the-Text-Data" title="Permalink to this heading">#</a></h3>
<p>We will use a <code class="docutils literal notranslate"><span class="pre">TfidfVectorizer</span></code> to convert the text data into a numerical format suitable for machine learning models.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>

<span class="c1"># Initialize the TfidfVectorizer</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>

<span class="c1"># Transform the text data into a feature matrix</span>
<span class="n">X_vectorized</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_text</span><span class="p">[</span><span class="s2">&quot;Text&quot;</span><span class="p">])</span>

<span class="c1"># Convert the sparse matrix to a dense matrix</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X_vectorized</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-Perform-Data-Valuation-with-Datalab">
<h3>3. Perform Data Valuation with Datalab<a class="headerlink" href="#3.-Perform-Data-Valuation-with-Datalab" title="Permalink to this heading">#</a></h3>
<p>Next, we will initialize <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> and perform data valuation to assess the value of each data point in the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="c1"># Initialize Datalab with the dataset</span>
<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_text</span><span class="p">,</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;Label&quot;</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>

<span class="c1"># Perform data valuation</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">issue_types</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;data_valuation&quot;</span><span class="p">:</span> <span class="p">{}})</span>

<span class="c1"># Collect the identified issues</span>
<span class="n">data_valuation_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;data_valuation&quot;</span><span class="p">)</span>

<span class="c1"># Display the data valuation issues</span>
<span class="n">display</span><span class="p">(</span><span class="n">data_valuation_issues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding data_valuation issues ...

Audit complete. 147 issues found in the dataset.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_data_valuation_issue</th>
      <th>data_valuation_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>0.500047</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>0.500093</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>0.500047</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>0.499953</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>False</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>False</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>1070</th>
      <td>False</td>
      <td>0.500047</td>
    </tr>
    <tr>
      <th>1071</th>
      <td>False</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>1072</th>
      <td>False</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
<p>1073 rows × 2 columns</p>
</div></div>
</div>
</section>
<section id="4.-(Optional)-Visualize-Data-Valuation-Scores">
<h3>4. (Optional) Visualize Data Valuation Scores<a class="headerlink" href="#4.-(Optional)-Visualize-Data-Valuation-Scores" title="Permalink to this heading">#</a></h3>
<p>Let’s visualize the data valuation scores across our dataset.</p>
<p>Cleanlab’s Shapely scores are transformed to lie between 0 and 1 such that: a score below 0.5 indicates a negative contribution to the model’s training performance, while a score above 0.5 indicates a positive contribution.</p>
<p>By examining the scores across different classes, we can identify whether positive or negative contributions are disproportionately concentrated in a single class. This can help detect biases in the training data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Prepare the data for plotting</span>
<span class="n">plot_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">data_valuation_issues</span>
    <span class="c1"># Optionally, add a &#39;given_label&#39; column to distinguish between labels in the histogram</span>
    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;given_label&quot;</span><span class="p">:</span> <span class="n">df_text</span><span class="p">[</span><span class="s2">&quot;Label&quot;</span><span class="p">]}))</span>
<span class="p">)</span>

<span class="c1"># Plot strip plots of data valuation scores for each label</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">plot_data</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;data_valuation_score&quot;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;given_label&quot;</span><span class="p">,</span>  <span class="c1"># Comment out if no labels should be used in the visualization</span>
    <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">jitter</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">lab</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;data_valuation&quot;</span><span class="p">][</span><span class="s2">&quot;threshold&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Issue Threshold&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Strip plot of Data Valuation Scores by Label&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Data Valuation Score&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_19_0.png" src="../../_images/tutorials_datalab_workflows_19_0.png" />
</div>
</div>
<p>Learn more about the data valuation issue type in the <a class="reference external" href="../../cleanlab/datalab/guide/issue_type_description.html#data-valuation-issue">Issue Type Guide</a>.</p>
</section>
</section>
<section id="Find-Underperforming-Groups-in-a-Dataset">
<h2>Find Underperforming Groups in a Dataset<a class="headerlink" href="#Find-Underperforming-Groups-in-a-Dataset" title="Permalink to this heading">#</a></h2>
<p>Here we will demonstrate how to use <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to identify subgroups in a dataset over which the ML model is producing consistently worse predictions than for the overall dataset.</p>
<p><code class="docutils literal notranslate"><span class="pre">Datalab</span></code> will automatically find underperforming groups if you provide numerical embeddings and predicted probabilities from any model. For this section, we’ll determine which data subgroups to consider ourselves, such as by using clustering.</p>
<section id="1.-Generate-a-Synthetic-Dataset">
<h3>1. Generate a Synthetic Dataset<a class="headerlink" href="#1.-Generate-a-Synthetic-Dataset" title="Permalink to this heading">#</a></h3>
<p>First, we will generate a synthetic dataset with blobs. This dataset will include some noisy labels in one of the blobs.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Generate synthetic data with blobs</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Add noise to the labels</span>
<span class="n">n_noisy_labels</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">y</span><span class="p">[:</span><span class="n">n_noisy_labels</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_noisy_labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Train-a-Classifier-and-Obtain-Predicted-Probabilities">
<h3>2. Train a Classifier and Obtain Predicted Probabilities<a class="headerlink" href="#2.-Train-a-Classifier-and-Obtain-Predicted-Probabilities" title="Permalink to this heading">#</a></h3>
<p>Next, we will train a basic classifier (you can use any type of model) and obtain predicted probabilities for the dataset using cross-validation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_predict</span>

<span class="c1"># Obtain predicted probabilities using cross-validation</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_probs</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;predict_proba&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-(Optional)-Cluster-the-Data">
<h3>3. (Optional) Cluster the Data<a class="headerlink" href="#3.-(Optional)-Cluster-the-Data" title="Permalink to this heading">#</a></h3>
<p>Datalab identifies meaningful data subgroups by automatically clustering your dataset. You can optionally provide your own clusters to control this process. Here we show how to use KMeans clustering, but this manual clustering is entirely optional.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>


<span class="c1"># Function to use in GridSearchCV for silhouette score</span>
<span class="k">def</span> <span class="nf">silhouette_scorer</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>


<span class="c1"># Use GridSearchCV to determine the optimal number of clusters</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_clusters&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)}</span>
<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">KMeans</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">silhouette_scorer</span><span class="p">)</span>
<span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Get the best estimator and predict clusters</span>
<span class="n">best_kmeans</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">cluster_ids</span> <span class="o">=</span> <span class="n">best_kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Identify-Underperforming-Groups-with-Datalab">
<h3>4. Identify Underperforming Groups with Datalab<a class="headerlink" href="#4.-Identify-Underperforming-Groups-with-Datalab" title="Permalink to this heading">#</a></h3>
<p>We will use <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to find underperforming groups in the dataset based on the predicted probabilities and optionally the cluster assignments.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Initialize Datalab with the dataset</span>
<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="n">X</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>

<span class="c1"># Find issues related to underperforming groups, optionally using cluster_ids</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span>
    <span class="c1"># features=X  # Uncomment this line if &#39;cluster_ids&#39; is not provided to allow Datalab to run clustering automatically.</span>
    <span class="n">pred_probs</span><span class="o">=</span><span class="n">pred_probs</span><span class="p">,</span>
    <span class="n">issue_types</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;underperforming_group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>          <span class="c1"># Set a custom threshold for identifying underperforming groups.</span>
                                        <span class="c1"># The default threshold is lower, optimized for higher precision (fewer false positives),</span>
                                        <span class="c1"># but for this toy example, a higher threshold increases sensitivity to underperforming groups.</span>
            <span class="s2">&quot;cluster_ids&quot;</span><span class="p">:</span> <span class="n">cluster_ids</span>  <span class="c1"># Optional: Provide cluster IDs if clustering is used.</span>
                                        <span class="c1"># If not provided, Datalab will automatically run clustering under the hood.</span>
                                        <span class="c1"># In that case, you need to provide the &#39;features&#39; array as an additional argument.</span>
            <span class="p">},</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="c1"># Collect the identified issues</span>
<span class="n">underperforming_group_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;underperforming_group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_underperforming_group_issue&quot;</span><span class="p">)</span>

<span class="c1"># Display the issues along with given and predicted labels</span>
<span class="n">display</span><span class="p">(</span><span class="n">underperforming_group_issues</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;given_label&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;predicted_label&quot;</span><span class="p">:</span> <span class="n">pred_probs</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)})))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding underperforming_group issues ...

Audit complete. 11 issues found in the dataset.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_underperforming_group_issue</th>
      <th>underperforming_group_score</th>
      <th>given_label</th>
      <th>predicted_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>True</td>
      <td>0.328308</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>True</td>
      <td>0.328308</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>True</td>
      <td>0.328308</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>True</td>
      <td>0.328308</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>True</td>
      <td>0.328308</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>True</td>
      <td>0.328308</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>True</td>
      <td>0.328308</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>True</td>
      <td>0.328308</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>True</td>
      <td>0.328308</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>True</td>
      <td>0.328308</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>True</td>
      <td>0.328308</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="5.-(Optional)-Visualize-the-Results">
<h3>5. (Optional) Visualize the Results<a class="headerlink" href="#5.-(Optional)-Visualize-the-Results" title="Permalink to this heading">#</a></h3>
<p>Finally, we will optionally visualize the dataset, highlighting the underperforming groups identified by <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Plot the original data points</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;tab10&quot;</span><span class="p">)</span>

<span class="c1"># Highlight the underperforming group (if any issues are detected)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">underperforming_group_issues</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">X</span><span class="p">[</span><span class="n">underperforming_group_issues</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">underperforming_group_issues</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Underperforming Group&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">2.0</span>
    <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No underperforming group issues detected.&quot;</span><span class="p">)</span>

<span class="c1"># Add title and legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Underperforming Groups in the Dataset&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_31_0.png" src="../../_images/tutorials_datalab_workflows_31_0.png" />
</div>
</div>
<p>Learn more about the underperforming group issue type in the <a class="reference external" href="../../cleanlab/datalab/guide/issue_type_description.html#underperforming-group-issue">Issue Type Guide</a>.</p>
</section>
</section>
<section id="Predefining-Data-Slices-for-Detecting-Underperforming-Groups">
<h2>Predefining Data Slices for Detecting Underperforming Groups<a class="headerlink" href="#Predefining-Data-Slices-for-Detecting-Underperforming-Groups" title="Permalink to this heading">#</a></h2>
<p>Instead of clustering the data to determine what data slices are considered when detecting underperforming groups, you can define these slices yourself. For say a tabular dataset, you can use the values of a categorical column as cluster IDs to predefine the relevant data subgroups/slices to consider. This allows you to focus on meaningful slices of your data defined by domain knowledge or specific attributes.</p>
<section id="id2">
<h3>1. Load and Prepare the Dataset<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>We’ll work with a toy tabular dataset with several categorical and numerical columns, just to illustrate how to use predefined data slices for detecting underperforming groups.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the dataset as a multi-line string</span>
<span class="n">dataset_tsv</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Age Gender  Location        Education       Experience      HighSalary</span>
<span class="s2">60  Other   Indiana PhD     21      0</span>
<span class="s2">50  Male    Indiana Bachelor&#39;s      21      0</span>
<span class="s2">36  Female  Indiana PhD     21      0</span>
<span class="s2">64  Male    Kansas  High School     37      1</span>
<span class="s2">29  Male    Kansas  PhD     14      0</span>
<span class="s2">42  Male    Ohio    PhD     7       0</span>
<span class="s2">60  Male    Kansas  High School     26      0</span>
<span class="s2">40  Other   Ohio    Bachelor&#39;s      25      0</span>
<span class="s2">44  Male    Indiana High School     29      0</span>
<span class="s2">32  Male    Ohio    PhD     17      0</span>
<span class="s2">32  Male    Kansas  Bachelor&#39;s      17      0</span>
<span class="s2">45  Other   Ohio    PhD     30      0</span>
<span class="s2">57  Male    California      High School     27      1</span>
<span class="s2">61  Male    Kansas  High School     32      0</span>
<span class="s2">45  Other   Indiana PhD     4       0</span>
<span class="s2">24  Other   Kansas  Bachelor&#39;s      9       0</span>
<span class="s2">43  Other   Ohio    Master&#39;s        3       0</span>
<span class="s2">23  Male    Ohio    High School     8       0</span>
<span class="s2">45  Other   Kansas  High School     16      0</span>
<span class="s2">51  Other   Ohio    Master&#39;s        27      0</span>
<span class="s2">59  Male    Ohio    Master&#39;s        29      0</span>
<span class="s2">23  Other   Indiana Bachelor&#39;s      8       0</span>
<span class="s2">42  Male    Kansas  PhD     5       0</span>
<span class="s2">54  Female  Kansas  Master&#39;s        34      0</span>
<span class="s2">33  Other   Kansas  PhD     18      0</span>
<span class="s2">43  Female  Kansas  PhD     23      0</span>
<span class="s2">46  Male    Ohio    Bachelor&#39;s      28      0</span>
<span class="s2">48  Other   Ohio    PhD     30      0</span>
<span class="s2">63  Male    Kansas  High School     34      0</span>
<span class="s2">49  Female  Kansas  PhD     32      1</span>
<span class="s2">37  Male    Kansas  PhD     20      0</span>
<span class="s2">36  Other   Indiana Master&#39;s        21      1</span>
<span class="s2">24  Other   Indiana High School     9       0</span>
<span class="s2">58  Female  Kansas  PhD     32      0</span>
<span class="s2">28  Male    California      Master&#39;s        2       0</span>
<span class="s2">42  Other   Kansas  Bachelor&#39;s      17      0</span>
<span class="s2">30  Female  California      PhD     15      1</span>
<span class="s2">60  Other   Ohio    PhD     30      0</span>
<span class="s2">39  Other   Kansas  Bachelor&#39;s      2       0</span>
<span class="s2">25  Male    Ohio    Master&#39;s        10      0</span>
<span class="s2">46  Other   Indiana PhD     23      0</span>
<span class="s2">35  Male    Indiana Bachelor&#39;s      20      0</span>
<span class="s2">30  Other   Ohio    High School     15      0</span>
<span class="s2">47  Female  Ohio    Master&#39;s        22      0</span>
<span class="s2">23  Other   Ohio    High School     1       0</span>
<span class="s2">41  Male    Ohio    High School     26      0</span>
<span class="s2">49  Male    Kansas  Bachelor&#39;s      1       0</span>
<span class="s2">28  Female  Ohio    Master&#39;s        13      0</span>
<span class="s2">29  Other   Kansas  Bachelor&#39;s      14      0</span>
<span class="s2">56  Other   Indiana Bachelor&#39;s      39      1</span>
<span class="s2">35  Female  Ohio    Bachelor&#39;s      20      0</span>
<span class="s2">38  Other   California      Bachelor&#39;s      8       1</span>
<span class="s2">57  Other   Ohio    Master&#39;s        38      1</span>
<span class="s2">61  Male    Indiana PhD     28      0</span>
<span class="s2">25  Other   Indiana High School     10      0</span>
<span class="s2">23  Other   Kansas  High School     8       0</span>
<span class="s2">27  Female  Ohio    Master&#39;s        12      0</span>
<span class="s2">63  Female  Indiana High School     23      0</span>
<span class="s2">25  Male    Indiana Master&#39;s        10      0</span>
<span class="s2">50  Other   Ohio    High School     6       0</span>
<span class="s2">39  Other   Kansas  Bachelor&#39;s      24      0</span>
<span class="s2">47  Other   Indiana High School     19      0</span>
<span class="s2">55  Male    Indiana PhD     0       0</span>
<span class="s2">31  Male    Ohio    PhD     7       0</span>
<span class="s2">57  Female  Kansas  PhD     15      0</span>
<span class="s2">35  Male    California      PhD     13      0</span>
<span class="s2">52  Other   Ohio    PhD     11      0</span>
<span class="s2">36  Other   Ohio    Master&#39;s        21      0</span>
<span class="s2">29  Male    Indiana Master&#39;s        14      0</span>
<span class="s2">35  Other   Indiana High School     20      0</span>
<span class="s2">44  Other   Indiana PhD     29      1</span>
<span class="s2">61  Male    Kansas  High School     1       0</span>
<span class="s2">42  Male    Ohio    PhD     27      0</span>
<span class="s2">37  Other   Indiana PhD     22      0</span>
<span class="s2">39  Other   Kansas  Master&#39;s        21      0</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Import necessary libraries</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load the dataset into a DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">StringIO</span><span class="p">(</span><span class="n">dataset_tsv</span><span class="p">),</span>
    <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Display the original DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Location</th>
      <th>Education</th>
      <th>Experience</th>
      <th>HighSalary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60</td>
      <td>Other</td>
      <td>Indiana</td>
      <td>PhD</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>Male</td>
      <td>Indiana</td>
      <td>Bachelor's</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36</td>
      <td>Female</td>
      <td>Indiana</td>
      <td>PhD</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>64</td>
      <td>Male</td>
      <td>Kansas</td>
      <td>High School</td>
      <td>37</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29</td>
      <td>Male</td>
      <td>Kansas</td>
      <td>PhD</td>
      <td>14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>44</td>
      <td>Other</td>
      <td>Indiana</td>
      <td>PhD</td>
      <td>29</td>
      <td>1</td>
    </tr>
    <tr>
      <th>71</th>
      <td>61</td>
      <td>Male</td>
      <td>Kansas</td>
      <td>High School</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>72</th>
      <td>42</td>
      <td>Male</td>
      <td>Ohio</td>
      <td>PhD</td>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>37</td>
      <td>Other</td>
      <td>Indiana</td>
      <td>PhD</td>
      <td>22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>39</td>
      <td>Other</td>
      <td>Kansas</td>
      <td>Master's</td>
      <td>21</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>75 rows × 6 columns</p>
</div></div>
</div>
<p><strong>Optional</strong>: The categorical features of the dataset can encoded to numerical values for easier. For simplicity, y, we will use <code class="docutils literal notranslate"><span class="pre">OrdinalEncoder</span></code> from <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OrdinalEncoder.html">scikit-learn</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OrdinalEncoder</span>

<span class="c1"># Encode the categorical columns</span>
<span class="n">columns_to_encode</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">,</span> <span class="s2">&quot;Location&quot;</span><span class="p">,</span> <span class="s2">&quot;Education&quot;</span><span class="p">]</span>
<span class="n">encoded_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">encoded_df</span><span class="p">[</span><span class="n">columns_to_encode</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">encoded_df</span><span class="p">[</span><span class="n">columns_to_encode</span><span class="p">])</span>
<span class="c1"># encoded_df.drop(columns=[&quot;Salary&quot;], inplace=True)</span>

<span class="c1"># Display the encoded DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">encoded_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Location</th>
      <th>Education</th>
      <th>Experience</th>
      <th>HighSalary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>21</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>64</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>37</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>29</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>14</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>44</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>29</td>
      <td>1</td>
    </tr>
    <tr>
      <th>71</th>
      <td>61</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>72</th>
      <td>42</td>
      <td>1</td>
      <td>3</td>
      <td>3</td>
      <td>27</td>
      <td>0</td>
    </tr>
    <tr>
      <th>73</th>
      <td>37</td>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>22</td>
      <td>0</td>
    </tr>
    <tr>
      <th>74</th>
      <td>39</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>21</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>75 rows × 6 columns</p>
</div></div>
</div>
</section>
<section id="id3">
<h3>2. Train a Classifier and Obtain Predicted Probabilities<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>Next, we will train a basic classifier (you can use any type of model) and obtain predicted probabilities for the dataset using cross-validation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_predict</span>

<span class="c1"># Split data</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">encoded_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HighSalary&quot;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">encoded_df</span><span class="p">[</span><span class="s2">&quot;HighSalary&quot;</span><span class="p">]</span>

<span class="c1"># Obtain predicted probabilities using cross-validation</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pred_probs</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;predict_proba&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-Define-a-Data-Slice">
<h3>3. Define a Data Slice<a class="headerlink" href="#3.-Define-a-Data-Slice" title="Permalink to this heading">#</a></h3>
<p>For a tabular dataset, you can use a categorical column’s values as pre-computed data slices, so that Datalab skips its default clustering step and directly uses the encoded values for each row in the dataset.</p>
<p>For this example, we’ll focus our attention to the <code class="docutils literal notranslate"><span class="pre">&quot;Location&quot;</span></code> column which has 4 unique categorical values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster_ids</span> <span class="o">=</span> <span class="n">encoded_df</span><span class="p">[</span><span class="s2">&quot;Location&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="id4">
<h3>4. Identify Underperforming Groups with Datalab<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>Now use <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to detect underperforming groups in the dataset based on the model predicted probabilities and our predefined data slices.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="c1"># Initialize Datalab with the dataset</span>
<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;HighSalary&quot;</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>

<span class="c1"># Find issues related to underperforming groups, optionally using cluster_ids</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span>
    <span class="c1"># features=X  # Uncomment this line if &#39;cluster_ids&#39; is not provided to allow Datalab to run clustering automatically.</span>
    <span class="n">pred_probs</span><span class="o">=</span><span class="n">pred_probs</span><span class="p">,</span>
    <span class="n">issue_types</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;underperforming_group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>          <span class="c1"># Set a custom threshold for identifying underperforming groups.</span>
                                        <span class="c1"># The default threshold is lower, optimized for higher precision (fewer false positives),</span>
                                        <span class="c1"># but for this toy example, a higher threshold increases sensitivity to underperforming groups.</span>
            <span class="s2">&quot;cluster_ids&quot;</span><span class="p">:</span> <span class="n">cluster_ids</span>  <span class="c1"># Optional: Provide cluster IDs if manual data-slicing is used.</span>
                                        <span class="c1"># If not provided, Datalab will automatically run clustering under the hood.</span>
                                        <span class="c1"># In that case, you need to provide the &#39;features&#39; array as an additional argument.</span>
            <span class="p">},</span>
    <span class="p">},</span>
<span class="p">)</span>

<span class="c1"># Collect the identified issues</span>
<span class="n">underperforming_group_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;underperforming_group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_underperforming_group_issue&quot;</span><span class="p">)</span>

<span class="c1"># Display the issues along with given and predicted labels</span>
<span class="n">display</span><span class="p">(</span><span class="n">underperforming_group_issues</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;given_label&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;predicted_label&quot;</span><span class="p">:</span> <span class="n">pred_probs</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)})))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding underperforming_group issues ...

Audit complete. 5 issues found in the dataset.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_underperforming_group_issue</th>
      <th>underperforming_group_score</th>
      <th>given_label</th>
      <th>predicted_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>True</td>
      <td>0.573681</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>34</th>
      <td>True</td>
      <td>0.573681</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>True</td>
      <td>0.573681</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>True</td>
      <td>0.573681</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>65</th>
      <td>True</td>
      <td>0.573681</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>
<section id="Detect-if-your-dataset-is-non-IID">
<h2>Detect if your dataset is non-IID<a class="headerlink" href="#Detect-if-your-dataset-is-non-IID" title="Permalink to this heading">#</a></h2>
<p>Here we demonstrate how to discover when your data might violate the foundational IID assumption that underpins most machine learning and analytics. Common violations (that can be caught with <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>) include: data drift, or lack of statistical independence where different data points affect one another. For this demonstration, we’ll work with a 2D dataset where the data points are not independent.</p>
<section id="id5">
<h3>1. Load and Prepare the Dataset<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>For simplicity, we’ll just work with a numerical dataset. If your data are not numerical, we recommend using numeric model embeddings of the data.</p>
<p>This issue check is automatically run by <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> whenever you provide numerical data embeddings or predicted probabilities.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">generate_data_dependent</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
    <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.975</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
    <span class="n">X</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>


<span class="n">X</span> <span class="o">=</span> <span class="n">generate_data_dependent</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Detect-Non-IID-Issues-Using-Datalab">
<h3>2. Detect Non-IID Issues Using Datalab<a class="headerlink" href="#2.-Detect-Non-IID-Issues-Using-Datalab" title="Permalink to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="c1"># Initialize Datalab with the dataset</span>
<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X&quot;</span><span class="p">:</span> <span class="n">X</span><span class="p">})</span>

<span class="c1"># Perform data valuation</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">issue_types</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;non_iid&quot;</span><span class="p">:</span> <span class="p">{}})</span>

<span class="c1"># Collect the identified issues</span>
<span class="n">non_iid_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;non_iid&quot;</span><span class="p">)</span>

<span class="c1"># Display the non-iid issues</span>
<span class="n">display</span><span class="p">(</span><span class="n">non_iid_issues</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding non_iid issues ...

Audit complete. 1 issues found in the dataset.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_non_iid_issue</th>
      <th>non_iid_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>0.796474</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>0.842432</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>0.922562</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>0.820759</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>0.873136</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>0.887373</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>0.825101</td>
    </tr>
    <tr>
      <th>7</th>
      <td>False</td>
      <td>0.855875</td>
    </tr>
    <tr>
      <th>8</th>
      <td>True</td>
      <td>0.751795</td>
    </tr>
    <tr>
      <th>9</th>
      <td>False</td>
      <td>0.835796</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="3.-(Optional)-Visualize-the-Results">
<h3>3. (Optional) Visualize the Results<a class="headerlink" href="#3.-(Optional)-Visualize-the-Results" title="Permalink to this heading">#</a></h3>
<p>Finally, we’ll visualize the dataset and highlight the non-iid issues detected by <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>.</p>
<p>Note that only the dataset as a whole can be considered to be non-iid, but no individual data point can be considered non-iid.</p>
<p>To be compatible with <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>, the point with the lowest non-iid score is assigned the <code class="docutils literal notranslate"><span class="pre">is_non_iid_issue</span></code> flag if the entire dataset is considered non-iid.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Plot the non-iid scores</span>
<span class="n">non_iid_issues</span><span class="p">[</span><span class="s2">&quot;non_iid_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Highlight the point assigned as a non-iid issue</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">non_iid_issues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_non_iid_issue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">non_iid_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;non_iid_score&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Non-iid Issue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Non-iid Scores&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample Index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Non-iid Score&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Visualize dataset ordering</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Dataset with data-dependent ordering&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Feature 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature 2&#39;</span><span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sample Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_50_0.png" src="../../_images/tutorials_datalab_workflows_50_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_50_1.png" src="../../_images/tutorials_datalab_workflows_50_1.png" />
</div>
</div>
<p>These plots help visualize the non-iid scores for each data point and the dataset ordering, highlighting potential dependencies and issues.</p>
<p>After detecting non-iid issues, you might be interested in quantifying the likelihood that your dataset is non-iid.</p>
<p>To check if your data is non-iid, <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> computes a p-value. A low p-value (close to 0) indicates strong evidence against the null hypothesis that the data is iid, either because the data appear to be drifting in distribution or inter-dependent across samples.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p-value:&quot;</span><span class="p">,</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="s2">&quot;non_iid&quot;</span><span class="p">)[</span><span class="s2">&quot;p-value&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
p-value: 0.0
</pre></div></div>
</div>
<p>Learn more about the non-iid issue type in the <a class="reference external" href="../../cleanlab/datalab/guide/issue_type_description.html#non-iid-issue">Issue Type Guide</a>.</p>
</section>
</section>
<section id="Catch-Null-Values-in-a-Dataset">
<h2>Catch Null Values in a Dataset<a class="headerlink" href="#Catch-Null-Values-in-a-Dataset" title="Permalink to this heading">#</a></h2>
<p>Here we demonstrate how to use <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to catch null values in a dataset and visualize them. Models may learn incorrect patterns if null values are present, and may even error during model training. Dealing with null values can mitigate those risks.</p>
<p>While <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> automatically runs this check by default, this section dives deeper into how to detect the effect of null values in your dataset.</p>
<section id="1.-Load-the-Dataset">
<h3>1. Load the Dataset<a class="headerlink" href="#1.-Load-the-Dataset" title="Permalink to this heading">#</a></h3>
<p>First, we will load the dataset into a Pandas DataFrame. For simplicity, we will use a dataset in TSV (tab-separated values) format. Some care is needed when loading the dataset to ensure that the data is correctly parsed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the dataset as a multi-line string</span>
<span class="n">dataset_tsv</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Age Gender  Location        Annual_Spending Number_of_Transactions  Last_Purchase_Date</span>
<span class="s2">56.0        Other   Rural   4099.62 3       2024-01-03</span>
<span class="s2">NaN Female  Rural   6421.16 5       NaT</span>
<span class="s2">46.0        Male    Suburban        5436.55 3       2024-02-26</span>
<span class="s2">32.0        Female  Rural   4046.66 3       2024-03-23</span>
<span class="s2">60.0        Female  Suburban        3467.67 6       2024-03-01</span>
<span class="s2">25.0        Female  Suburban        4757.37 4       2024-01-03</span>
<span class="s2">38.0        Female  Rural   4199.53 6       2024-01-03</span>
<span class="s2">56.0        Male    Suburban        4991.71 6       2024-04-03</span>
<span class="s2">NaN</span>
<span class="s2">NaN Male    Rural   4655.82 1       NaT</span>
<span class="s2">40.0        Female  Rural   5584.02 7       2024-03-29</span>
<span class="s2">28.0        Female  Urban   3102.32 2       2024-04-07</span>
<span class="s2">28.0        Male    Rural   6637.99 11      2024-04-08</span>
<span class="s2">NaN Male    Urban   9167.47 4       2024-01-02</span>
<span class="s2">NaN Male    Rural   6790.46 3       NaT</span>
<span class="s2">NaN Other   Rural   5327.96 8       2024-01-03</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Import necessary libraries</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load the dataset into a DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="n">StringIO</span><span class="p">(</span><span class="n">dataset_tsv</span><span class="p">),</span>
    <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Last_Purchase_Date&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Display the original DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Location</th>
      <th>Annual_Spending</th>
      <th>Number_of_Transactions</th>
      <th>Last_Purchase_Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56.0</td>
      <td>Other</td>
      <td>Rural</td>
      <td>4099.62</td>
      <td>3.0</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>Female</td>
      <td>Rural</td>
      <td>6421.16</td>
      <td>5.0</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46.0</td>
      <td>Male</td>
      <td>Suburban</td>
      <td>5436.55</td>
      <td>3.0</td>
      <td>2024-02-26</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32.0</td>
      <td>Female</td>
      <td>Rural</td>
      <td>4046.66</td>
      <td>3.0</td>
      <td>2024-03-23</td>
    </tr>
    <tr>
      <th>4</th>
      <td>60.0</td>
      <td>Female</td>
      <td>Suburban</td>
      <td>3467.67</td>
      <td>6.0</td>
      <td>2024-03-01</td>
    </tr>
    <tr>
      <th>5</th>
      <td>25.0</td>
      <td>Female</td>
      <td>Suburban</td>
      <td>4757.37</td>
      <td>4.0</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>6</th>
      <td>38.0</td>
      <td>Female</td>
      <td>Rural</td>
      <td>4199.53</td>
      <td>6.0</td>
      <td>2024-01-03</td>
    </tr>
    <tr>
      <th>7</th>
      <td>56.0</td>
      <td>Male</td>
      <td>Suburban</td>
      <td>4991.71</td>
      <td>6.0</td>
      <td>2024-04-03</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>Male</td>
      <td>Rural</td>
      <td>4655.82</td>
      <td>1.0</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>10</th>
      <td>40.0</td>
      <td>Female</td>
      <td>Rural</td>
      <td>5584.02</td>
      <td>7.0</td>
      <td>2024-03-29</td>
    </tr>
    <tr>
      <th>11</th>
      <td>28.0</td>
      <td>Female</td>
      <td>Urban</td>
      <td>3102.32</td>
      <td>2.0</td>
      <td>2024-04-07</td>
    </tr>
    <tr>
      <th>12</th>
      <td>28.0</td>
      <td>Male</td>
      <td>Rural</td>
      <td>6637.99</td>
      <td>11.0</td>
      <td>2024-04-08</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>Male</td>
      <td>Urban</td>
      <td>9167.47</td>
      <td>4.0</td>
      <td>2024-01-02</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NaN</td>
      <td>Male</td>
      <td>Rural</td>
      <td>6790.46</td>
      <td>3.0</td>
      <td>NaT</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NaN</td>
      <td>Other</td>
      <td>Rural</td>
      <td>5327.96</td>
      <td>8.0</td>
      <td>2024-01-03</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="2:-Encode-Categorical-Values">
<h3>2: Encode Categorical Values<a class="headerlink" href="#2:-Encode-Categorical-Values" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">features</span></code> argument to <code class="docutils literal notranslate"><span class="pre">Datalab.find_issues()</span></code> generally requires a numerical array. Therefore, we need to numerically encode any categorical values. A common workflow is to encode categorical values in the dataset before passing it to the <code class="docutils literal notranslate"><span class="pre">find_issues</span></code> method (or provide model embeddings of the data instead of the data values themselves). However, some encoding strategies may lose the original null values.</p>
<p>Here’s a strategy to encode categorical columns while keeping the original DataFrame structure intact:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function to encode categorical columns</span>
<span class="k">def</span> <span class="nf">encode_categorical_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
        <span class="c1"># Drop NaN values or replace them with a placeholder</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># Create a mapping from categories to numbers</span>
        <span class="n">category_to_number</span> <span class="o">=</span> <span class="p">{</span><span class="n">category</span><span class="p">:</span> <span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">category</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categories</span><span class="p">)}</span>

        <span class="c1"># Apply the mapping to the column</span>
        <span class="n">df</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s1">&#39;_encoded&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">category_to_number</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">drop</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>


<span class="c1"># Encode the categorical columns</span>
<span class="n">columns_to_encode</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Gender&quot;</span><span class="p">,</span> <span class="s2">&quot;Location&quot;</span><span class="p">]</span>
<span class="n">encoded_df</span> <span class="o">=</span> <span class="n">encode_categorical_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns_to_encode</span><span class="p">)</span>

<span class="c1"># Display the encoded DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">encoded_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Annual_Spending</th>
      <th>Number_of_Transactions</th>
      <th>Last_Purchase_Date</th>
      <th>Gender_encoded</th>
      <th>Location_encoded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>56.0</td>
      <td>4099.62</td>
      <td>3.0</td>
      <td>2024-01-03</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>6421.16</td>
      <td>5.0</td>
      <td>NaT</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46.0</td>
      <td>5436.55</td>
      <td>3.0</td>
      <td>2024-02-26</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32.0</td>
      <td>4046.66</td>
      <td>3.0</td>
      <td>2024-03-23</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>60.0</td>
      <td>3467.67</td>
      <td>6.0</td>
      <td>2024-03-01</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>25.0</td>
      <td>4757.37</td>
      <td>4.0</td>
      <td>2024-01-03</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>38.0</td>
      <td>4199.53</td>
      <td>6.0</td>
      <td>2024-01-03</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>56.0</td>
      <td>4991.71</td>
      <td>6.0</td>
      <td>2024-04-03</td>
      <td>2.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>4655.82</td>
      <td>1.0</td>
      <td>NaT</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>40.0</td>
      <td>5584.02</td>
      <td>7.0</td>
      <td>2024-03-29</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>28.0</td>
      <td>3102.32</td>
      <td>2.0</td>
      <td>2024-04-07</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>28.0</td>
      <td>6637.99</td>
      <td>11.0</td>
      <td>2024-04-08</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>9167.47</td>
      <td>4.0</td>
      <td>2024-01-02</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NaN</td>
      <td>6790.46</td>
      <td>3.0</td>
      <td>NaT</td>
      <td>2.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NaN</td>
      <td>5327.96</td>
      <td>8.0</td>
      <td>2024-01-03</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="3.-Initialize-Datalab">
<h3>3. Initialize Datalab<a class="headerlink" href="#3.-Initialize-Datalab" title="Permalink to this heading">#</a></h3>
<p>Next, we initialize <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> with the original DataFrame, which will help us discover all kinds of data issues.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the Datalab class from cleanlab</span>
<span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="c1"># Initialize Datalab with the original DataFrame</span>
<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Detect-Null-Values">
<h3>4. Detect Null Values<a class="headerlink" href="#4.-Detect-Null-Values" title="Permalink to this heading">#</a></h3>
<p>We will use the find_issues method from <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to detect null values in our dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Detect issues in the dataset, focusing on null values</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">encoded_df</span><span class="p">,</span> <span class="n">issue_types</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;null&quot;</span><span class="p">:</span> <span class="p">{}})</span>

<span class="c1"># Display the identified issues</span>
<span class="n">null_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;null&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">null_issues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding null issues ...

Audit complete. 1 issues found in the dataset.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_null_issue</th>
      <th>null_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>True</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>False</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>10</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>13</th>
      <td>False</td>
      <td>0.833333</td>
    </tr>
    <tr>
      <th>14</th>
      <td>False</td>
      <td>0.666667</td>
    </tr>
    <tr>
      <th>15</th>
      <td>False</td>
      <td>0.833333</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="5.-Sort-the-Dataset-by-Null-Issues">
<h3>5. Sort the Dataset by Null Issues<a class="headerlink" href="#5.-Sort-the-Dataset-by-Null-Issues" title="Permalink to this heading">#</a></h3>
<p>To better understand the impact of null values, we will sort the original DataFrame by the <code class="docutils literal notranslate"><span class="pre">null_score</span></code> from the <code class="docutils literal notranslate"><span class="pre">null_issues</span></code> DataFrame.</p>
<p>This score indicates the severity of null issues for each row.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sort the issues DataFrame by &#39;null_score&#39; and get the sorted indices</span>
<span class="n">sorted_indices</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">null_issues</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;null_score&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">index</span>
<span class="p">)</span>

<span class="c1"># Sort the original DataFrame based on the sorted indices from the issues DataFrame</span>
<span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="6.-(Optional)-Visualize-the-Results">
<h3>6. (Optional) Visualize the Results<a class="headerlink" href="#6.-(Optional)-Visualize-the-Results" title="Permalink to this heading">#</a></h3>
<p>Finally, we will create a nicely formatted DataFrame that highlights the null values and the issues detected by <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>.</p>
<p>We will use Pandas’ styler to add custom styles for better visualization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a column of separators</span>
<span class="n">separator</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sorted_df</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;|&#39;</span><span class="p">])</span>

<span class="c1"># Join the sorted DataFrame, separator, and issues DataFrame</span>
<span class="n">combined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sorted_df</span><span class="p">,</span> <span class="n">separator</span><span class="p">,</span> <span class="n">null_issues</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="c1"># Define functions to highlight null values and Datalab columns</span>
<span class="k">def</span> <span class="nf">highlight_null_values</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;background-color: yellow&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span>


<span class="k">def</span> <span class="nf">highlight_datalab_columns</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;background-color: lightblue&#39;</span>


<span class="k">def</span> <span class="nf">highlight_is_null_issue</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;background-color: orange&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span>


<span class="c1"># Apply styles to the combined DataFrame</span>
<span class="n">styled_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">combined_df</span>
    <span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">highlight_null_values</span><span class="p">)</span>  <span class="c1"># Highlight null and NaT values</span>
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">highlight_datalab_columns</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="n">null_issues</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># Highlight columns provided by Datalab</span>
    <span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">highlight_is_null_issue</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;is_null_issue&#39;</span><span class="p">])</span>  <span class="c1"># Highlight rows with null issues</span>
<span class="p">)</span>

<span class="c1"># Display the styled DataFrame</span>
<span class="n">display</span><span class="p">(</span><span class="n">styled_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style type="text/css">
#T_cfe13_row0_col0, #T_cfe13_row0_col1, #T_cfe13_row0_col2, #T_cfe13_row0_col3, #T_cfe13_row0_col4, #T_cfe13_row0_col5, #T_cfe13_row1_col0, #T_cfe13_row1_col5, #T_cfe13_row2_col0, #T_cfe13_row2_col5, #T_cfe13_row3_col0, #T_cfe13_row3_col5, #T_cfe13_row4_col0, #T_cfe13_row5_col0 {
  background-color: yellow;
}
#T_cfe13_row0_col7 {
  background-color: lightblue;
  background-color: orange;
}
#T_cfe13_row0_col8, #T_cfe13_row1_col7, #T_cfe13_row1_col8, #T_cfe13_row2_col7, #T_cfe13_row2_col8, #T_cfe13_row3_col7, #T_cfe13_row3_col8, #T_cfe13_row4_col7, #T_cfe13_row4_col8, #T_cfe13_row5_col7, #T_cfe13_row5_col8, #T_cfe13_row6_col7, #T_cfe13_row6_col8, #T_cfe13_row7_col7, #T_cfe13_row7_col8, #T_cfe13_row8_col7, #T_cfe13_row8_col8, #T_cfe13_row9_col7, #T_cfe13_row9_col8, #T_cfe13_row10_col7, #T_cfe13_row10_col8, #T_cfe13_row11_col7, #T_cfe13_row11_col8, #T_cfe13_row12_col7, #T_cfe13_row12_col8, #T_cfe13_row13_col7, #T_cfe13_row13_col8, #T_cfe13_row14_col7, #T_cfe13_row14_col8, #T_cfe13_row15_col7, #T_cfe13_row15_col8 {
  background-color: lightblue;
}
</style>
<table id="T_cfe13">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_cfe13_level0_col0" class="col_heading level0 col0" >Age</th>
      <th id="T_cfe13_level0_col1" class="col_heading level0 col1" >Gender</th>
      <th id="T_cfe13_level0_col2" class="col_heading level0 col2" >Location</th>
      <th id="T_cfe13_level0_col3" class="col_heading level0 col3" >Annual_Spending</th>
      <th id="T_cfe13_level0_col4" class="col_heading level0 col4" >Number_of_Transactions</th>
      <th id="T_cfe13_level0_col5" class="col_heading level0 col5" >Last_Purchase_Date</th>
      <th id="T_cfe13_level0_col6" class="col_heading level0 col6" >|</th>
      <th id="T_cfe13_level0_col7" class="col_heading level0 col7" >is_null_issue</th>
      <th id="T_cfe13_level0_col8" class="col_heading level0 col8" >null_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_cfe13_level0_row0" class="row_heading level0 row0" >8</th>
      <td id="T_cfe13_row0_col0" class="data row0 col0" >nan</td>
      <td id="T_cfe13_row0_col1" class="data row0 col1" >nan</td>
      <td id="T_cfe13_row0_col2" class="data row0 col2" >nan</td>
      <td id="T_cfe13_row0_col3" class="data row0 col3" >nan</td>
      <td id="T_cfe13_row0_col4" class="data row0 col4" >nan</td>
      <td id="T_cfe13_row0_col5" class="data row0 col5" >NaT</td>
      <td id="T_cfe13_row0_col6" class="data row0 col6" ></td>
      <td id="T_cfe13_row0_col7" class="data row0 col7" >True</td>
      <td id="T_cfe13_row0_col8" class="data row0 col8" >0.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row1" class="row_heading level0 row1" >1</th>
      <td id="T_cfe13_row1_col0" class="data row1 col0" >nan</td>
      <td id="T_cfe13_row1_col1" class="data row1 col1" >Female</td>
      <td id="T_cfe13_row1_col2" class="data row1 col2" >Rural</td>
      <td id="T_cfe13_row1_col3" class="data row1 col3" >6421.160000</td>
      <td id="T_cfe13_row1_col4" class="data row1 col4" >5.000000</td>
      <td id="T_cfe13_row1_col5" class="data row1 col5" >NaT</td>
      <td id="T_cfe13_row1_col6" class="data row1 col6" ></td>
      <td id="T_cfe13_row1_col7" class="data row1 col7" >False</td>
      <td id="T_cfe13_row1_col8" class="data row1 col8" >0.666667</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row2" class="row_heading level0 row2" >9</th>
      <td id="T_cfe13_row2_col0" class="data row2 col0" >nan</td>
      <td id="T_cfe13_row2_col1" class="data row2 col1" >Male</td>
      <td id="T_cfe13_row2_col2" class="data row2 col2" >Rural</td>
      <td id="T_cfe13_row2_col3" class="data row2 col3" >4655.820000</td>
      <td id="T_cfe13_row2_col4" class="data row2 col4" >1.000000</td>
      <td id="T_cfe13_row2_col5" class="data row2 col5" >NaT</td>
      <td id="T_cfe13_row2_col6" class="data row2 col6" ></td>
      <td id="T_cfe13_row2_col7" class="data row2 col7" >False</td>
      <td id="T_cfe13_row2_col8" class="data row2 col8" >0.666667</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row3" class="row_heading level0 row3" >14</th>
      <td id="T_cfe13_row3_col0" class="data row3 col0" >nan</td>
      <td id="T_cfe13_row3_col1" class="data row3 col1" >Male</td>
      <td id="T_cfe13_row3_col2" class="data row3 col2" >Rural</td>
      <td id="T_cfe13_row3_col3" class="data row3 col3" >6790.460000</td>
      <td id="T_cfe13_row3_col4" class="data row3 col4" >3.000000</td>
      <td id="T_cfe13_row3_col5" class="data row3 col5" >NaT</td>
      <td id="T_cfe13_row3_col6" class="data row3 col6" ></td>
      <td id="T_cfe13_row3_col7" class="data row3 col7" >False</td>
      <td id="T_cfe13_row3_col8" class="data row3 col8" >0.666667</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row4" class="row_heading level0 row4" >13</th>
      <td id="T_cfe13_row4_col0" class="data row4 col0" >nan</td>
      <td id="T_cfe13_row4_col1" class="data row4 col1" >Male</td>
      <td id="T_cfe13_row4_col2" class="data row4 col2" >Urban</td>
      <td id="T_cfe13_row4_col3" class="data row4 col3" >9167.470000</td>
      <td id="T_cfe13_row4_col4" class="data row4 col4" >4.000000</td>
      <td id="T_cfe13_row4_col5" class="data row4 col5" >2024-01-02 00:00:00</td>
      <td id="T_cfe13_row4_col6" class="data row4 col6" ></td>
      <td id="T_cfe13_row4_col7" class="data row4 col7" >False</td>
      <td id="T_cfe13_row4_col8" class="data row4 col8" >0.833333</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row5" class="row_heading level0 row5" >15</th>
      <td id="T_cfe13_row5_col0" class="data row5 col0" >nan</td>
      <td id="T_cfe13_row5_col1" class="data row5 col1" >Other</td>
      <td id="T_cfe13_row5_col2" class="data row5 col2" >Rural</td>
      <td id="T_cfe13_row5_col3" class="data row5 col3" >5327.960000</td>
      <td id="T_cfe13_row5_col4" class="data row5 col4" >8.000000</td>
      <td id="T_cfe13_row5_col5" class="data row5 col5" >2024-01-03 00:00:00</td>
      <td id="T_cfe13_row5_col6" class="data row5 col6" ></td>
      <td id="T_cfe13_row5_col7" class="data row5 col7" >False</td>
      <td id="T_cfe13_row5_col8" class="data row5 col8" >0.833333</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row6" class="row_heading level0 row6" >0</th>
      <td id="T_cfe13_row6_col0" class="data row6 col0" >56.000000</td>
      <td id="T_cfe13_row6_col1" class="data row6 col1" >Other</td>
      <td id="T_cfe13_row6_col2" class="data row6 col2" >Rural</td>
      <td id="T_cfe13_row6_col3" class="data row6 col3" >4099.620000</td>
      <td id="T_cfe13_row6_col4" class="data row6 col4" >3.000000</td>
      <td id="T_cfe13_row6_col5" class="data row6 col5" >2024-01-03 00:00:00</td>
      <td id="T_cfe13_row6_col6" class="data row6 col6" ></td>
      <td id="T_cfe13_row6_col7" class="data row6 col7" >False</td>
      <td id="T_cfe13_row6_col8" class="data row6 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row7" class="row_heading level0 row7" >2</th>
      <td id="T_cfe13_row7_col0" class="data row7 col0" >46.000000</td>
      <td id="T_cfe13_row7_col1" class="data row7 col1" >Male</td>
      <td id="T_cfe13_row7_col2" class="data row7 col2" >Suburban</td>
      <td id="T_cfe13_row7_col3" class="data row7 col3" >5436.550000</td>
      <td id="T_cfe13_row7_col4" class="data row7 col4" >3.000000</td>
      <td id="T_cfe13_row7_col5" class="data row7 col5" >2024-02-26 00:00:00</td>
      <td id="T_cfe13_row7_col6" class="data row7 col6" ></td>
      <td id="T_cfe13_row7_col7" class="data row7 col7" >False</td>
      <td id="T_cfe13_row7_col8" class="data row7 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row8" class="row_heading level0 row8" >3</th>
      <td id="T_cfe13_row8_col0" class="data row8 col0" >32.000000</td>
      <td id="T_cfe13_row8_col1" class="data row8 col1" >Female</td>
      <td id="T_cfe13_row8_col2" class="data row8 col2" >Rural</td>
      <td id="T_cfe13_row8_col3" class="data row8 col3" >4046.660000</td>
      <td id="T_cfe13_row8_col4" class="data row8 col4" >3.000000</td>
      <td id="T_cfe13_row8_col5" class="data row8 col5" >2024-03-23 00:00:00</td>
      <td id="T_cfe13_row8_col6" class="data row8 col6" ></td>
      <td id="T_cfe13_row8_col7" class="data row8 col7" >False</td>
      <td id="T_cfe13_row8_col8" class="data row8 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row9" class="row_heading level0 row9" >4</th>
      <td id="T_cfe13_row9_col0" class="data row9 col0" >60.000000</td>
      <td id="T_cfe13_row9_col1" class="data row9 col1" >Female</td>
      <td id="T_cfe13_row9_col2" class="data row9 col2" >Suburban</td>
      <td id="T_cfe13_row9_col3" class="data row9 col3" >3467.670000</td>
      <td id="T_cfe13_row9_col4" class="data row9 col4" >6.000000</td>
      <td id="T_cfe13_row9_col5" class="data row9 col5" >2024-03-01 00:00:00</td>
      <td id="T_cfe13_row9_col6" class="data row9 col6" ></td>
      <td id="T_cfe13_row9_col7" class="data row9 col7" >False</td>
      <td id="T_cfe13_row9_col8" class="data row9 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row10" class="row_heading level0 row10" >5</th>
      <td id="T_cfe13_row10_col0" class="data row10 col0" >25.000000</td>
      <td id="T_cfe13_row10_col1" class="data row10 col1" >Female</td>
      <td id="T_cfe13_row10_col2" class="data row10 col2" >Suburban</td>
      <td id="T_cfe13_row10_col3" class="data row10 col3" >4757.370000</td>
      <td id="T_cfe13_row10_col4" class="data row10 col4" >4.000000</td>
      <td id="T_cfe13_row10_col5" class="data row10 col5" >2024-01-03 00:00:00</td>
      <td id="T_cfe13_row10_col6" class="data row10 col6" ></td>
      <td id="T_cfe13_row10_col7" class="data row10 col7" >False</td>
      <td id="T_cfe13_row10_col8" class="data row10 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row11" class="row_heading level0 row11" >6</th>
      <td id="T_cfe13_row11_col0" class="data row11 col0" >38.000000</td>
      <td id="T_cfe13_row11_col1" class="data row11 col1" >Female</td>
      <td id="T_cfe13_row11_col2" class="data row11 col2" >Rural</td>
      <td id="T_cfe13_row11_col3" class="data row11 col3" >4199.530000</td>
      <td id="T_cfe13_row11_col4" class="data row11 col4" >6.000000</td>
      <td id="T_cfe13_row11_col5" class="data row11 col5" >2024-01-03 00:00:00</td>
      <td id="T_cfe13_row11_col6" class="data row11 col6" ></td>
      <td id="T_cfe13_row11_col7" class="data row11 col7" >False</td>
      <td id="T_cfe13_row11_col8" class="data row11 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row12" class="row_heading level0 row12" >7</th>
      <td id="T_cfe13_row12_col0" class="data row12 col0" >56.000000</td>
      <td id="T_cfe13_row12_col1" class="data row12 col1" >Male</td>
      <td id="T_cfe13_row12_col2" class="data row12 col2" >Suburban</td>
      <td id="T_cfe13_row12_col3" class="data row12 col3" >4991.710000</td>
      <td id="T_cfe13_row12_col4" class="data row12 col4" >6.000000</td>
      <td id="T_cfe13_row12_col5" class="data row12 col5" >2024-04-03 00:00:00</td>
      <td id="T_cfe13_row12_col6" class="data row12 col6" ></td>
      <td id="T_cfe13_row12_col7" class="data row12 col7" >False</td>
      <td id="T_cfe13_row12_col8" class="data row12 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row13" class="row_heading level0 row13" >10</th>
      <td id="T_cfe13_row13_col0" class="data row13 col0" >40.000000</td>
      <td id="T_cfe13_row13_col1" class="data row13 col1" >Female</td>
      <td id="T_cfe13_row13_col2" class="data row13 col2" >Rural</td>
      <td id="T_cfe13_row13_col3" class="data row13 col3" >5584.020000</td>
      <td id="T_cfe13_row13_col4" class="data row13 col4" >7.000000</td>
      <td id="T_cfe13_row13_col5" class="data row13 col5" >2024-03-29 00:00:00</td>
      <td id="T_cfe13_row13_col6" class="data row13 col6" ></td>
      <td id="T_cfe13_row13_col7" class="data row13 col7" >False</td>
      <td id="T_cfe13_row13_col8" class="data row13 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row14" class="row_heading level0 row14" >11</th>
      <td id="T_cfe13_row14_col0" class="data row14 col0" >28.000000</td>
      <td id="T_cfe13_row14_col1" class="data row14 col1" >Female</td>
      <td id="T_cfe13_row14_col2" class="data row14 col2" >Urban</td>
      <td id="T_cfe13_row14_col3" class="data row14 col3" >3102.320000</td>
      <td id="T_cfe13_row14_col4" class="data row14 col4" >2.000000</td>
      <td id="T_cfe13_row14_col5" class="data row14 col5" >2024-04-07 00:00:00</td>
      <td id="T_cfe13_row14_col6" class="data row14 col6" ></td>
      <td id="T_cfe13_row14_col7" class="data row14 col7" >False</td>
      <td id="T_cfe13_row14_col8" class="data row14 col8" >1.000000</td>
    </tr>
    <tr>
      <th id="T_cfe13_level0_row15" class="row_heading level0 row15" >12</th>
      <td id="T_cfe13_row15_col0" class="data row15 col0" >28.000000</td>
      <td id="T_cfe13_row15_col1" class="data row15 col1" >Male</td>
      <td id="T_cfe13_row15_col2" class="data row15 col2" >Rural</td>
      <td id="T_cfe13_row15_col3" class="data row15 col3" >6637.990000</td>
      <td id="T_cfe13_row15_col4" class="data row15 col4" >11.000000</td>
      <td id="T_cfe13_row15_col5" class="data row15 col5" >2024-04-08 00:00:00</td>
      <td id="T_cfe13_row15_col6" class="data row15 col6" ></td>
      <td id="T_cfe13_row15_col7" class="data row15 col7" >False</td>
      <td id="T_cfe13_row15_col8" class="data row15 col8" >1.000000</td>
    </tr>
  </tbody>
</table></div>
</div>
<p>Learn more about the null issue type in the <a class="reference external" href="../../cleanlab/datalab/guide/issue_type_description.html#null-issue">Issue Type Guide</a>.</p>
</section>
</section>
<section id="Detect-class-imbalance-in-your-dataset">
<h2>Detect class imbalance in your dataset<a class="headerlink" href="#Detect-class-imbalance-in-your-dataset" title="Permalink to this heading">#</a></h2>
<p>Here we consider class imbalance, a common issue when working with datasets where one or more classes is significantly rarer than the others. Class imbalance can cause models to become biased towards frequent classes, but detecting this issue can help inform adjustments for fairer and more reliable predictions.</p>
<section id="1.-Prepare-data">
<h3>1. Prepare data<a class="headerlink" href="#1.-Prepare-data" title="Permalink to this heading">#</a></h3>
<p>Here work with a fixed toy dataset with randomly generated labels. For this issue type, it is enough to provide labels without any additional features of the dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
   <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span>
    <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Detect-class-imbalance-with-Datalab">
<h3>2. Detect class imbalance with Datalab<a class="headerlink" href="#2.-Detect-class-imbalance-with-Datalab" title="Permalink to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">},</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">&quot;classification&quot;</span><span class="p">)</span>

<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span><span class="n">issue_types</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;class_imbalance&quot;</span><span class="p">:</span> <span class="p">{}})</span>

<span class="n">class_imbalance_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;class_imbalance&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding class_imbalance issues ...

Audit complete. 4 issues found in the dataset.
</pre></div></div>
</div>
</section>
<section id="3.-(Optional)-Visualize-class-imbalance-issues">
<h3>3. (Optional) Visualize class imbalance issues<a class="headerlink" href="#3.-(Optional)-Visualize-class-imbalance-issues" title="Permalink to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot the distribution of labels in the dataset</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;given_label&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">class_imbalance_issues</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;is_class_imbalance_issue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Distribution of Labels&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Given Label&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Annotate plot with score of each issue class</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">given_label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]):</span>
    <span class="n">filtered_df</span> <span class="o">=</span> <span class="n">class_imbalance_issues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;given_label == @given_label&quot;</span><span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">filtered_df</span><span class="p">[</span><span class="s2">&quot;class_imbalance_score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">filtered_df</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="c1"># Add textual annotation to explain the scores</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span> <span class="o">*</span> <span class="mf">0.35</span><span class="p">,</span> <span class="s2">&quot;Numbers on top of</span><span class="se">\n</span><span class="s2">bars indicate class</span><span class="se">\n</span><span class="s2">imbalance scores&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Adjust the legend</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;No Class Imbalance&quot;</span><span class="p">,</span> <span class="s2">&quot;Class Imbalance&quot;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Class Imbalance Issue&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">title_fontsize</span><span class="o">=</span><span class="s1">&#39;14&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_74_0.png" src="../../_images/tutorials_datalab_workflows_74_0.png" />
</div>
</div>
</section>
</section>
<section id="Identify-Spurious-Correlations-in-Image-Datasets">
<h2>Identify Spurious Correlations in Image Datasets<a class="headerlink" href="#Identify-Spurious-Correlations-in-Image-Datasets" title="Permalink to this heading">#</a></h2>
<p>This section demonstrates how to detect spurious correlations in image datasets by measuring how strongly individual image properties correlate with class labels. These correlations could lead to unreliable model predictions and poor generalization.</p>
<p><code class="docutils literal notranslate"><span class="pre">Datalab</span></code> automatically analyzes image-specific attributes such as:</p>
<ul class="simple">
<li><p>Darkness</p></li>
<li><p>Blurriness</p></li>
<li><p>Aspect ratio anomalies</p></li>
<li><p>More image-specific features from <a class="reference external" href="https://cleanvision.readthedocs.io/en/latest/tutorials/tutorial.html#What-is-CleanVision?">CleanVision</a></p></li>
</ul>
<p>This analysis helps identify unintended biases in datasets and guides steps to enhance the robustness of machine learning models.</p>
<section id="id8">
<h3>1. Load the Dataset<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<p>For this tutorial, we’ll use a subset of the CIFAR-10 dataset with artificially introduced biases to illustrate how Datalab detects spurious correlations. We’ll assume you have a directory of images organized into subdirectories by class.</p>
<p>To fetch the data for this tutorial, make sure you have <code class="docutils literal notranslate"><span class="pre">wget</span></code> and <code class="docutils literal notranslate"><span class="pre">zip</span></code> installed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download the dataset</span>
<span class="o">!</span>wget<span class="w"> </span>-nc<span class="w"> </span>https://s.cleanlab.ai/CIFAR-10-subset.zip
<span class="o">!</span>unzip<span class="w"> </span>-q<span class="w"> </span>CIFAR-10-subset.zip
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--2024-09-03 16:19:59--  https://s.cleanlab.ai/CIFAR-10-subset.zip
Resolving s.cleanlab.ai (s.cleanlab.ai)... 185.199.110.153, 185.199.111.153, 185.199.108.153, ...
Connecting to s.cleanlab.ai (s.cleanlab.ai)|185.199.110.153|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 986707 (964K) [application/zip]
Saving to: ‘CIFAR-10-subset.zip’

CIFAR-10-subset.zip 100%[===================&gt;] 963.58K  --.-KB/s    in 0.04s

2024-09-03 16:19:59 (26.0 MB/s) - ‘CIFAR-10-subset.zip’ saved [986707/986707]

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="kn">import</span> <span class="n">ImageFolder</span>

<span class="k">def</span> <span class="nf">load_image_dataset</span><span class="p">(</span><span class="n">data_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load images from a directory structure and create a datasets.Dataset object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_dir : str</span>
<span class="sd">        Path to the root directory containing class subdirectories.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    datasets.Dataset</span>
<span class="sd">        A Dataset object containing &#39;image&#39; and &#39;label&#39; columns.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_dataset</span> <span class="o">=</span> <span class="n">ImageFolder</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
    <span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">img</span> <span class="k">for</span> <span class="n">img</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">image_dataset</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">image_dataset</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">images</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">labels</span><span class="p">})</span>

<span class="c1"># Load the dataset</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="s2">&quot;CIFAR-10-subset/darkened_images&quot;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_image_dataset</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Run-Datalab-Analysis">
<h3>2. Run Datalab Analysis<a class="headerlink" href="#2.-Run-Datalab-Analysis" title="Permalink to this heading">#</a></h3>
<p>Now that we have loaded our dataset, let’s use <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> to analyze it for potential spurious correlations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="c1"># Initialize Datalab with the dataset</span>
<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">image_key</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>

<span class="c1"># Run the analysis</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">()</span>

<span class="c1"># Generate and display the report</span>
<span class="n">lab</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding class_imbalance issues ...
Finding dark, light, low_information, odd_aspect_ratio, odd_size, grayscale, blurry images ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "fa519d7dd6874ad9abdd73a57dc2b828"}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Removing dark, blurry from potential issues in the dataset as it exceeds max_prevalence=0.1
Finding spurious correlation issues in the dataset ...

Audit complete. 0 issues found in the dataset.
No issues found in the data. Good job!

Try re-running Datalab.report() with `show_summary_score = True` and `show_all_issues = True`.



Removing dark from potential issues in the dataset as it exceeds max_prevalence=0.1
Removing blurry from potential issues in the dataset as it exceeds max_prevalence=0.1



Summary of (potentially spurious) correlations between image properties and class labels detected in the data:

Lower scores below correspond to images properties that are more strongly correlated with the class labels.


       property  score
low_information  0.015
          light  0.180
           dark  0.000
         blurry  0.015

Here are the images corresponding to the extreme (minimum and maximum) individual scores for each of the detected correlated properties:


Images with minimum and maximum individual scores for low_information issue:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_82_3.png" src="../../_images/tutorials_datalab_workflows_82_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Images with minimum and maximum individual scores for light issue:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_82_5.png" src="../../_images/tutorials_datalab_workflows_82_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Images with minimum and maximum individual scores for dark issue:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_82_7.png" src="../../_images/tutorials_datalab_workflows_82_7.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Images with minimum and maximum individual scores for blurry issue:

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_82_9.png" src="../../_images/tutorials_datalab_workflows_82_9.png" />
</div>
</div>
</section>
<section id="3.-Interpret-the-Results">
<h3>3. Interpret the Results<a class="headerlink" href="#3.-Interpret-the-Results" title="Permalink to this heading">#</a></h3>
<p>While the <code class="docutils literal notranslate"><span class="pre">lab.report()</span></code> output is comprehensive, we can use more targeted methods to examine the results:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="c1"># Get scores for label uncorrelatedness with image properties</span>
<span class="n">label_uncorrelatedness_scores</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_info</span><span class="p">(</span><span class="s2">&quot;spurious_correlations&quot;</span><span class="p">)[</span><span class="s2">&quot;correlations_df&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Label uncorrelatedness scores for image properties:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">label_uncorrelatedness_scores</span><span class="p">)</span>

<span class="c1"># Get image-specific issues</span>
<span class="n">issue_name</span> <span class="o">=</span> <span class="s2">&quot;dark&quot;</span>
<span class="n">image_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="n">issue_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Image-specific issues:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">image_issues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Label uncorrelatedness scores for image properties:
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>property</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>odd_size_score</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>odd_aspect_ratio_score</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>low_information_score</td>
      <td>0.015</td>
    </tr>
    <tr>
      <th>3</th>
      <td>light_score</td>
      <td>0.180</td>
    </tr>
    <tr>
      <th>4</th>
      <td>grayscale_score</td>
      <td>0.500</td>
    </tr>
    <tr>
      <th>5</th>
      <td>dark_score</td>
      <td>0.000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>blurry_score</td>
      <td>0.015</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Image-specific issues:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_dark_issue</th>
      <th>dark_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>0.237196</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>0.197229</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
      <td>0.254188</td>
    </tr>
    <tr>
      <th>3</th>
      <td>True</td>
      <td>0.229170</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
      <td>0.208907</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>False</td>
      <td>0.793840</td>
    </tr>
    <tr>
      <th>196</th>
      <td>False</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>197</th>
      <td>False</td>
      <td>0.971560</td>
    </tr>
    <tr>
      <th>198</th>
      <td>False</td>
      <td>0.862236</td>
    </tr>
    <tr>
      <th>199</th>
      <td>False</td>
      <td>0.973533</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 2 columns</p>
</div></div>
</div>
<p>Interpreting the results:</p>
<ol class="arabic simple">
<li><p><strong>Label Uncorrelatedness Scores</strong>: The <code class="docutils literal notranslate"><span class="pre">label_uncorrelatedness_scores</span></code> DataFrame shows scores for various image properties. Lower scores (closer to 0) indicate stronger correlations with class labels, suggesting potential spurious correlations.</p></li>
<li><p><strong>Image-Specific Issues</strong>: The <code class="docutils literal notranslate"><span class="pre">image_issues</span></code> DataFrame provides details on detected image-specific problems, including the issue type and affected samples.</p></li>
</ol>
<p>In our CIFAR-10 subset example, you should see that the ‘dark’ property has a low score in the label_uncorrelatedness_scores, indicating a strong correlation with one of the classes (likely the ‘frog’ class). This is due to our artificial darkening of these images to demonstrate the concept.</p>
<p>For real-world datasets, pay attention to:</p>
<ul class="simple">
<li><p>Properties with notably low scores in the label_uncorrelatedness_scores DataFrame</p></li>
<li><p>Prevalent issues in the image_issues DataFrame</p></li>
</ul>
<p>These may represent unintended biases in your data collection or preprocessing steps and warrant further investigation.</p>
<blockquote>
<div><p><strong>Note</strong>: Using these methods provides a more programmatic and focused way to analyze the results compared to the verbose output of <code class="docutils literal notranslate"><span class="pre">lab.report()</span></code>.</p>
</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_scores_labels</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span> <span class="nb">property</span><span class="o">=</span><span class="s2">&quot;dark_score&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots the scores of image-specific properties like &#39;dark_score&#39;, &#39;blurry_score&#39;, etc.</span>
<span class="sd">    against labels for each instance in the dataset using &#39;Datalab&#39; object.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    lab : &#39;Datalab&#39; object</span>

<span class="sd">    property : str, optional</span>
<span class="sd">        The name of the property to be plotted against the labels.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    None</span>
<span class="sd">        This function does not return any value. It generates a plot of the specified</span>
<span class="sd">        property against the labels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">issues_copy</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">issues_copy</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">labels</span>
    <span class="n">issues_copy</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="nb">property</span><span class="p">],</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>

<span class="c1"># Plotting &#39;dark_score&#39; value of each instance in the dataset against class label</span>
<span class="n">plot_scores_labels</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span> <span class="s2">&quot;dark_score&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_datalab_workflows_86_0.png" src="../../_images/tutorials_datalab_workflows_86_0.png" />
</div>
</div>
<p>The above plot illustrates the distribution of dark scores across class labels. In this dataset, 100 images from the <code class="docutils literal notranslate"><span class="pre">Frog</span></code> class (Class 0 in the plot) have been darkened, while 100 images from the <code class="docutils literal notranslate"><span class="pre">Truck</span></code> class (Class 1 in the plot) remain unchanged, as in the CIFAR-10 dataset. This creates a clear spurious correlation between the ‘darkness’ feature and the class labels: <code class="docutils literal notranslate"><span class="pre">Frog</span></code> images are dark, whereas <code class="docutils literal notranslate"><span class="pre">Truck</span></code> images are not. We can see that the <code class="docutils literal notranslate"><span class="pre">dark_score</span></code> values between the two
classes are non-overlapping. This characteristic of the dataset is identified by <code class="docutils literal notranslate"><span class="pre">Datalab</span></code>.</p>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"8acac174342248c593c91aafe89e73e1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e9362db738e04fd9a3eac5a56aca3161": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "ddddb4b31a2c471a9f7befa77f3a9797": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_8acac174342248c593c91aafe89e73e1", "max": 200.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_e9362db738e04fd9a3eac5a56aca3161", "tabbable": null, "tooltip": null, "value": 200.0}}, "17bbfc5527d144ae8377f3fd9c2ccc18": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6106564e3fba4502a9c9c2299ea1298c": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "26c1e40ecb454bbabfb6a3d4e1d562ce": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_17bbfc5527d144ae8377f3fd9c2ccc18", "placeholder": "\u200b", "style": "IPY_MODEL_6106564e3fba4502a9c9c2299ea1298c", "tabbable": null, "tooltip": null, "value": "100%"}}, "7d31e33909a342e0b5264155387083d8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "206fda0eb7694395afa84091ea9708d1": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "e0a48a865755487b9c2606d255b477bb": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_7d31e33909a342e0b5264155387083d8", "placeholder": "\u200b", "style": "IPY_MODEL_206fda0eb7694395afa84091ea9708d1", "tabbable": null, "tooltip": null, "value": "\u2007200/200\u2007[00:00&lt;00:00,\u2007781.82it/s]"}}, "237785cd21d24441b208666c51834eff": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fa519d7dd6874ad9abdd73a57dc2b828": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_26c1e40ecb454bbabfb6a3d4e1d562ce", "IPY_MODEL_ddddb4b31a2c471a9f7befa77f3a9797", "IPY_MODEL_e0a48a865755487b9c2606d255b477bb"], "layout": "IPY_MODEL_237785cd21d24441b208666c51834eff", "tabbable": null, "tooltip": null}}, "3569c47d20ac4b00bf5e738910beaf4a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9c58b8cd99c64466943e332c0a8f6d2e": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "d7787ecb4a41452fa80a3d8693063d69": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3569c47d20ac4b00bf5e738910beaf4a", "max": 200.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_9c58b8cd99c64466943e332c0a8f6d2e", "tabbable": null, "tooltip": null, "value": 200.0}}, "7624e6da34ca485b94e0b4df25bde74c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d9809c5eed0f432e81e5695cb680d8b3": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "125bade6078f4825b6db7802d49b71c4": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_7624e6da34ca485b94e0b4df25bde74c", "placeholder": "\u200b", "style": "IPY_MODEL_d9809c5eed0f432e81e5695cb680d8b3", "tabbable": null, "tooltip": null, "value": "100%"}}, "17b10f89f4fa4b459a8d6089d052ee98": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "781467b9aa304e849bd919aa2dce6371": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d7cbb18ffb7e4482a3459f326b6cca27": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_17b10f89f4fa4b459a8d6089d052ee98", "placeholder": "\u200b", "style": "IPY_MODEL_781467b9aa304e849bd919aa2dce6371", "tabbable": null, "tooltip": null, "value": "\u2007200/200\u2007[00:00&lt;00:00,\u2007715.50it/s]"}}, "b497e8c1c7044bc8978c85064c037671": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "662e1b37ae78478b91d3c4f153b0c53e": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_125bade6078f4825b6db7802d49b71c4", "IPY_MODEL_d7787ecb4a41452fa80a3d8693063d69", "IPY_MODEL_d7cbb18ffb7e4482a3459f326b6cca27"], "layout": "IPY_MODEL_b497e8c1c7044bc8978c85064c037671", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}
</script></section>
</section>
</section>
 
        </article>
      </div>
      <footer>
         
        <div class="related-pages">
          <a class="next-page" href="../improving_ml_performance.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Improving ML Performance via Data Curation with Train vs Test Splits</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../../cleanlab/datalab/guide/issue_type_description.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Datalab Issue Types</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Cleanlab Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/cleanlab/cleanlab" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        

<script type="text/javascript">
    window.addEventListener("load", () => {
        let elements = document.getElementsByClassName("left-details");

        elements[0].insertAdjacentHTML(
            "afterbegin",
            `<code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> is distributed on <a href="https://pypi.org/project/cleanlab/">PyPI</a> and <a href="https://anaconda.org/conda-forge/cleanlab">conda</a>.`
        );
    });
</script>


      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Miscellaneous workflows with Datalab</a><ul>
<li><a class="reference internal" href="#Accelerate-Issue-Checks-with-Pre-computed-kNN-Graphs">Accelerate Issue Checks with Pre-computed kNN Graphs</a><ul>
<li><a class="reference internal" href="#1.-Load-and-Prepare-Your-Dataset">1. Load and Prepare Your Dataset</a></li>
<li><a class="reference internal" href="#2.-Compute-kNN-Graph">2. Compute kNN Graph</a></li>
<li><a class="reference internal" href="#3.-Train-a-Classifier-and-Obtain-Predicted-Probabilities">3. Train a Classifier and Obtain Predicted Probabilities</a></li>
<li><a class="reference internal" href="#4.-Identify-Data-Issues-Using-Datalab">4. Identify Data Issues Using Datalab</a><ul>
<li><a class="reference internal" href="#Explanation:">Explanation:</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Data-Valuation">Data Valuation</a><ul>
<li><a class="reference internal" href="#1.-Load-and-Prepare-the-Dataset">1. Load and Prepare the Dataset</a></li>
<li><a class="reference internal" href="#2.-Vectorize-the-Text-Data">2. Vectorize the Text Data</a></li>
<li><a class="reference internal" href="#3.-Perform-Data-Valuation-with-Datalab">3. Perform Data Valuation with Datalab</a></li>
<li><a class="reference internal" href="#4.-(Optional)-Visualize-Data-Valuation-Scores">4. (Optional) Visualize Data Valuation Scores</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Find-Underperforming-Groups-in-a-Dataset">Find Underperforming Groups in a Dataset</a><ul>
<li><a class="reference internal" href="#1.-Generate-a-Synthetic-Dataset">1. Generate a Synthetic Dataset</a></li>
<li><a class="reference internal" href="#2.-Train-a-Classifier-and-Obtain-Predicted-Probabilities">2. Train a Classifier and Obtain Predicted Probabilities</a></li>
<li><a class="reference internal" href="#3.-(Optional)-Cluster-the-Data">3. (Optional) Cluster the Data</a></li>
<li><a class="reference internal" href="#4.-Identify-Underperforming-Groups-with-Datalab">4. Identify Underperforming Groups with Datalab</a></li>
<li><a class="reference internal" href="#5.-(Optional)-Visualize-the-Results">5. (Optional) Visualize the Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Predefining-Data-Slices-for-Detecting-Underperforming-Groups">Predefining Data Slices for Detecting Underperforming Groups</a><ul>
<li><a class="reference internal" href="#id2">1. Load and Prepare the Dataset</a></li>
<li><a class="reference internal" href="#id3">2. Train a Classifier and Obtain Predicted Probabilities</a></li>
<li><a class="reference internal" href="#3.-Define-a-Data-Slice">3. Define a Data Slice</a></li>
<li><a class="reference internal" href="#id4">4. Identify Underperforming Groups with Datalab</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Detect-if-your-dataset-is-non-IID">Detect if your dataset is non-IID</a><ul>
<li><a class="reference internal" href="#id5">1. Load and Prepare the Dataset</a></li>
<li><a class="reference internal" href="#2.-Detect-Non-IID-Issues-Using-Datalab">2. Detect Non-IID Issues Using Datalab</a></li>
<li><a class="reference internal" href="#3.-(Optional)-Visualize-the-Results">3. (Optional) Visualize the Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Catch-Null-Values-in-a-Dataset">Catch Null Values in a Dataset</a><ul>
<li><a class="reference internal" href="#1.-Load-the-Dataset">1. Load the Dataset</a></li>
<li><a class="reference internal" href="#2:-Encode-Categorical-Values">2: Encode Categorical Values</a></li>
<li><a class="reference internal" href="#3.-Initialize-Datalab">3. Initialize Datalab</a></li>
<li><a class="reference internal" href="#4.-Detect-Null-Values">4. Detect Null Values</a></li>
<li><a class="reference internal" href="#5.-Sort-the-Dataset-by-Null-Issues">5. Sort the Dataset by Null Issues</a></li>
<li><a class="reference internal" href="#6.-(Optional)-Visualize-the-Results">6. (Optional) Visualize the Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Detect-class-imbalance-in-your-dataset">Detect class imbalance in your dataset</a><ul>
<li><a class="reference internal" href="#1.-Prepare-data">1. Prepare data</a></li>
<li><a class="reference internal" href="#2.-Detect-class-imbalance-with-Datalab">2. Detect class imbalance with Datalab</a></li>
<li><a class="reference internal" href="#3.-(Optional)-Visualize-class-imbalance-issues">3. (Optional) Visualize class imbalance issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Identify-Spurious-Correlations-in-Image-Datasets">Identify Spurious Correlations in Image Datasets</a><ul>
<li><a class="reference internal" href="#id8">1. Load the Dataset</a></li>
<li><a class="reference internal" href="#2.-Run-Datalab-Analysis">2. Run Datalab Analysis</a></li>
<li><a class="reference internal" href="#3.-Interpret-the-Results">3. Interpret the Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=2b91c5f0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    
<script async defer src="https://buttons.github.io/buttons.js"></script>
</body>
</html>