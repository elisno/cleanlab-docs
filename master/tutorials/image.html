<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-EV8RVEFX82"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-EV8RVEFX82');
            
        </script>
    <meta property="og:title" content="Image Classification with PyTorch and Cleanlab" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.cleanlab.ai/master/tutorials/image.html" />
<meta property="og:site_name" content="cleanlab" />
<meta property="og:description" content="This quickstart tutorial demonstrates how to find issues in image classification data. Here we use the Fashion-MNIST dataset (60,000 images of fashion products from 10 categories), but you can repl..." />
<meta property="og:image" content="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/clos-preview-card.png" />
<meta property="og:image:alt" content="cleanlab" />
<meta name="description" content="This quickstart tutorial demonstrates how to find issues in image classification data. Here we use the Fashion-MNIST dataset (60,000 images of fashion products from 10 categories), but you can repl..." />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Text Classification with Noisy Labels" href="text.html" /><link rel="prev" title="The Workflows of Data-centric AI for Classification with Noisy Labels" href="indepth_overview.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/cleanlab/assets/a4483476d449f2f05a4c7cde329e72358099cc07/cleanlab/cleanlab_favicon.svg"/><meta name="generator" content="sphinx-5.1.1, furo 2022.06.21"/>
        <title>Image Classification with PyTorch and Cleanlab - cleanlab</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">cleanlab</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a style="padding-bottom: 0px;" class="sidebar-brand centered" href="../index.html">
    
    <div class="sidebar-logo-container">
        <img class="sidebar-logo" src="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/cleanlab_logo_only.png" alt="Logo" />
    </div>
    
    <span style="margin-bottom:0px" class="sidebar-brand-text">
        cleanlab
    </span>
    
</a>

<div class="centered">
    <a style="margin-top: 6px;" class="github-button" href="https://github.com/cleanlab/cleanlab" data-size="large" data-show-count="true"
    aria-label="Star cleanlab/cleanlab on GitHub">Star</a>
</div>
<form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="datalab/index.html">Datalab Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="datalab/datalab_quickstart.html">Detecting Common Data Issues with Datalab</a></li>
<li class="toctree-l2"><a class="reference internal" href="datalab/datalab_advanced.html">Advanced Data Auditing with Datalab</a></li>
<li class="toctree-l2"><a class="reference internal" href="datalab/text.html">Text Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="datalab/tabular.html">Tabular Data (Numeric/Categorical)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="indepth_overview.html">Workflows of Data-Centric AI</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Image Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="text.html">Text Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="tabular.html">Tabular Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">Audio Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_health.html">Find Dataset-level Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="outliers.html">Identifying Outliers</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiannotator.html">Improving Consensus Labels for Multiannotator Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="multilabel_classification.html">Multi-Label Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">Noisy Labels in Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="token_classification.html">Token Classification (text)</a></li>
<li class="toctree-l1"><a class="reference internal" href="segmentation.html">Image Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_detection.html">Object Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="pred_probs_cross_val.html">Predicted Probabilities via Cross Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/datalab/index.html">datalab</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cleanlab/datalab/guide/index.html">Datalab guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cleanlab/datalab/guide/issue_type_description.html">Datalab Issue Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cleanlab/datalab/guide/custom_issue_manager.html">Creating Your Own Issues Manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/datalab/datalab.html">datalab</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cleanlab/datalab/internal/index.html">internal</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../cleanlab/datalab/internal/data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cleanlab/datalab/internal/data_issues.html">data_issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cleanlab/datalab/internal/issue_finder.html">issue_finder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cleanlab/datalab/internal/factory.html">factory</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/index.html">issue_manager</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/issue_manager.html">Base issue_manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/label.html">label</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/outlier.html">outlier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/duplicate.html">duplicate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/noniid.html">noniid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/imbalance.html">imbalance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/underperforming_group.html">underperforming_group</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/null.html">null</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/data_valuation.html">data_valuation</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/regression/index.html">regression</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../cleanlab/datalab/internal/issue_manager/regression/label.html">label</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../cleanlab/datalab/internal/report.html">report</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cleanlab/classification.html">classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cleanlab/filter.html">filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cleanlab/rank.html">rank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cleanlab/count.html">count</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cleanlab/dataset.html">dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cleanlab/outlier.html">outlier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cleanlab/multiannotator.html">multiannotator</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/multilabel_classification/index.html">multilabel_classification</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/multilabel_classification/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/multilabel_classification/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/multilabel_classification/dataset.html">dataset</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/regression/index.html">regression</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/regression/rank.html">regression.rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/regression/learn.html">regression.learn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/token_classification/index.html">token_classification</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/token_classification/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/token_classification/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/token_classification/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/segmentation/index.html">segmentation</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/segmentation/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/segmentation/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/segmentation/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/object_detection/index.html">object_detection</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/object_detection/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/object_detection/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/object_detection/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/benchmarking/index.html">benchmarking</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/benchmarking/noise_generation.html">noise_generation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/models/index.html">models</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/models/keras.html">keras</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/models/fasttext.html">fasttext</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/experimental/index.html">experimental</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/experimental/label_issues_batched.html">label_issues_batched</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/experimental/mnist_pytorch.html">mnist_pytorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/experimental/coteaching.html">coteaching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/experimental/cifar_cnn.html">cifar_cnn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/internal/index.html">internal</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/util.html">util</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/latent_algebra.html">latent_algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/label_quality_utils.html">label_quality_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/multilabel_utils.html">multilabel_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/multilabel_scorer.html">multilabel_scorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/outlier.html">outlier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/token_classification_utils.html">token_classification_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/internal/validation.html">validation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cleanlab/datalab/guide/index.html">Datalab issue types</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/datalab/guide/issue_type_description.html">Datalab Issue Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cleanlab/datalab/guide/custom_issue_manager.html">Creating Your Own Issues Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/cleanlab/cleanlab/blob/master/CONTRIBUTING.md">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai">Website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/cleanlab/cleanlab">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/cleanlab/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://anaconda.org/Cleanlab/cleanlab">Conda</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai/blog/data-centric-ai/">Cleanlab Studio (Easy Mode)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://help.cleanlab.ai">Cleanlab Studio Docs</a></li>
</ul>

</div>


<!-- Start of versioning -->

<div class="sidebar-tree">
    <p class="caption" role="heading">
        <span class="caption-text">Versions</span>
    </p>
    <ul>
        <li class="toctree-l1">
            <a
                id="version_number"
                class="reference internal"
                href="/cleanlab-docs/"
                >stable</a
            >
        </li>
        <li class="toctree-l1">
            <a
                id="commit_hash"
                class="reference internal"
                href="/cleanlab-docs/master/"
                >developer</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.5.0"
                class="reference internal"
                href="/cleanlab-docs/v2.5.0/"
                >v2.5.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.4.0"
                class="reference internal"
                href="/cleanlab-docs/v2.4.0/"
                >v2.4.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.3.1"
                class="reference internal"
                href="/cleanlab-docs/v2.3.1/"
                >v2.3.1</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.3.0"
                class="reference internal"
                href="/cleanlab-docs/v2.3.0/"
                >v2.3.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.2.0"
                class="reference internal"
                href="/cleanlab-docs/v2.2.0/"
                >v2.2.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.1.0"
                class="reference internal"
                href="/cleanlab-docs/v2.1.0/"
                >v2.1.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.0.0"
                class="reference internal"
                href="/cleanlab-docs/v2.0.0/"
                >v2.0.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v1.0.1"
                class="reference internal"
                href="/cleanlab-docs/v1.0.1/"
                >v1.0.1</a
            >
        </li>
        
    </ul>
</div>

<br>
<br>

<script
    type="text/javascript"
    src="/cleanlab-docs/versioning.js"
></script>

<script type="text/javascript">
    window.addEventListener("load", () => {
        const version_number = Version.version_number;
        const commit_hash = Version.commit_hash;

        document.getElementById("version_number").innerHTML =
            "stable <code class='docutils literal notranslate'><span class='pre'> (" +
            version_number +
            ")</span></code>";
        document.getElementById("commit_hash").innerHTML =
            "master <code class='docutils literal notranslate'><span class='pre'> (" +
            commit_hash.slice(0, 7) +
            "&hellip;)</span></code>";
    });
</script>

<!-- End of versioning -->

</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          

<noscript>
  <div class="admonition warning">
    <p class="admonition-title">Warning</p>
    <p>Parts of this site uses JavaScript, but your browser does not support it.</p>
  </div>
</noscript>



<!-- Start of Version Warning Banner -->

<p id="doc_ver_warning"></p>

<script
    type="text/javascript"
    src="/cleanlab-docs/versioning.js"
></script>
<script type="text/javascript">
    window.addEventListener("load", () => {
        const version_number = Version.version_number;
        const path_arr = window.location.pathname.split("/");

        if (path_arr.includes("master")) {
            document.getElementById("doc_ver_warning").innerHTML =
            `<div class="admonition warning">
            <p class="admonition-title">Warning</p>
            <p>This version of the documentation corresponds to the master branch of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> source code from <a href="https://github.com/cleanlab/cleanlab/">GitHub</a>. To see the documentation for the latest <code class="docutils literal notranslate"><span class="pre">pip</span></code>-installed version, click <a href="/cleanlab-docs/">here</a>.</p>
            </div>`;
        } else if (!path_arr.includes(version_number) && !path_arr.includes("stable")) {
            document.getElementById("doc_ver_warning").innerHTML =
            `<div class="admonition warning">
            <p class="admonition-title">Warning</p>
            <p>This documentation is for an old version (<code class="docutils literal notranslate"><span class="pre">master</span></code>) of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code>. To see the documentation for the latest stable version (<code class="docutils literal notranslate"><span class="pre">` + version_number + `</span></code>), click <a href="/cleanlab-docs/">here</a>.</p>
            </div>`;
        } else {
            document.getElementById("doc_ver_warning").remove();
        }
    });
</script>

<!-- End of Version Warning Banner -->

 
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }

    .output_area {
        max-height: 300px;
        overflow: auto;
    }

    .dataframe {
        background: #D7D7D7;
    }

    th {
        color:black;
    }
</style>

<script type="text/javascript">
    window.addEventListener('load', () => {
        const h1_element = document.getElementsByTagName("h1");
        h1_element[0].insertAdjacentHTML("afterend", `
        <p>
            <a style="background-color:white;color:black;padding:4px 12px;text-decoration:none;display:inline-block;border-radius:8px;box-shadow:0 2px 4px 0 rgba(0, 0, 0, 0.2), 0 3px 10px 0 rgba(0, 0, 0, 0.19)" href="https://colab.research.google.com/github/elisno/cleanlab-docs/blob/master/master/tutorials/image.ipynb" target="_blank">
            <img src="https://colab.research.google.com/img/colab_favicon_256px.png" alt="" style="width:40px;height:40px;vertical-align:middle">
            <span style="vertical-align:middle">Run in Google Colab</span>
            </a>
        </p>
        `);
    })

</script><section id="Image-Classification-with-PyTorch-and-Cleanlab">
<h1>Image Classification with PyTorch and Cleanlab<a class="headerlink" href="#Image-Classification-with-PyTorch-and-Cleanlab" title="Permalink to this heading">#</a></h1>
<p>This quickstart tutorial demonstrates how to find issues in image classification data. Here we use the Fashion-MNIST dataset (60,000 images of fashion products from 10 categories), but you can replace this with your own image classification dataset and still follow the same tutorial.</p>
<p><strong>Overview of what weâ€™ll do in this tutorial:</strong></p>
<ul class="simple">
<li><p>Build a simple <a class="reference external" href="https://pytorch.org/">PyTorch</a> neural net.</p></li>
<li><p>Use cross-validation to compute out-of-sample predicted probabilities (<code class="docutils literal notranslate"><span class="pre">pred_probs</span></code>) and feature embeddings (<code class="docutils literal notranslate"><span class="pre">features</span></code>) for each image in the dataset.</p></li>
<li><p>Utilize these <code class="docutils literal notranslate"><span class="pre">pred_probs</span></code> and <code class="docutils literal notranslate"><span class="pre">features</span></code> to identify potential issues within the dataset using the <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> class from cleanlab. The issues found by cleanlab include mislabeled examples, near duplicates, outliers, and image-specific problems such as excessively dark or low information images.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Quickstart</p>
<p>Already have a ML model? Run cross-validation to get out-of-sample <code class="docutils literal notranslate"><span class="pre">pred_probs</span></code> and provide <code class="docutils literal notranslate"><span class="pre">features</span></code> (embeddings of the data). Then use the code below to find any potential issues in your dataset (you can also run this code with one of <code class="docutils literal notranslate"><span class="pre">pred_probs</span></code> or <code class="docutils literal notranslate"><span class="pre">features</span></code> instead of both, but less issue types will be considered).</p>
<div class="markdown" style="background:white;margin:16px"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>

<span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">your_dataset</span><span class="p">,</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;column_name_of_labels&quot;</span><span class="p">)</span>  <span class="c1"># include `image_key` to detect low-quality images</span>
<span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span><span class="n">pred_probs</span><span class="o">=</span><span class="n">pred_probs</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">)</span>

<span class="n">lab</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div><section id="1.-Install-and-import-required-dependencies">
<h2>1. Install and import required dependencies<a class="headerlink" href="#1.-Install-and-import-required-dependencies" title="Permalink to this heading">#</a></h2>
<p>You can use <code class="docutils literal notranslate"><span class="pre">pip</span></code> to install all packages required for this tutorial as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>matplotlib<span class="w"> </span>torch<span class="w"> </span>torchvision<span class="w"> </span>datasets
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;cleanlab[image]&quot;</span>
<span class="c1"># We install cleanlab with extra dependencies for image data</span>
<span class="c1"># Make sure to install the version corresponding to this tutorial</span>
<span class="c1"># E.g. if viewing master branch documentation:</span>
<span class="c1">#     !pip install &quot;cleanlab[image] @ git+https://github.com/cleanlab/cleanlab.git&quot;</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span><span class="p">,</span> <span class="n">Subset</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>

<span class="kn">from</span> <span class="nn">cleanlab</span> <span class="kn">import</span> <span class="n">Datalab</span>
<span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Fetch-and-normalize-the-Fashion-MNIST-dataset">
<h2>2. Fetch and normalize the Fashion-MNIST dataset<a class="headerlink" href="#2.-Fetch-and-normalize-the-Fashion-MNIST-dataset" title="Permalink to this heading">#</a></h2>
<p>Load train split of the fashion_mnist dataset and view the number of rows and columns in the dataset</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;fashion_mnist&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
<span class="n">dataset</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "9c4bc8c9eed640d1b4669bdd2a531117"}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "570fa3bab67b4d5185fa8072ec14b1a3"}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "86a310889e704d9b9b3913233080a7fe"}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "a6edecaba4a24772b01ccf7c6d7b5316"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset({
    features: [&#39;image&#39;, &#39;label&#39;],
    num_rows: 60000
})
</pre></div></div>
</div>
<p>Get number of classes in the dataset</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">features</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
<span class="n">num_classes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
10
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert PIL image to torch tensors</span>
<span class="n">transformed_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">with_format</span><span class="p">(</span><span class="s2">&quot;torch&quot;</span><span class="p">)</span>


<span class="c1"># Apply transformations</span>
<span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">example</span><span class="p">):</span>
    <span class="n">example</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">example</span>


<span class="n">transformed_dataset</span> <span class="o">=</span> <span class="n">transformed_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">normalize</span><span class="p">,</span> <span class="n">num_proc</span><span class="o">=</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5027eafb00b345138871357852dc200f"}</script></div>
</div>
<p>Convert the transformed dataset to a torch dataset. Torch datasets are more efficient with dataloading in practice.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torch_dataset</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">transformed_dataset</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">],</span> <span class="n">transformed_dataset</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Bringing Your Own Data (BYOD)?</p>
<p>Load any huggingface dataset or your local image folder dataset, apply relevant transformations, and continue with the rest of the tutorial.</p>
</div>
</section>
<section id="3.-Define-a-classification-model">
<h2>3. Define a classification model<a class="headerlink" href="#3.-Define-a-classification-model" title="Permalink to this heading">#</a></h2>
<p>Here, we define a simple neural network with PyTorch. Note this is just a toy model to ensure quick runtimes for the tutorial, you can replace it with any other (larger) PyTorch network.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">LazyLinear</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">embeddings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cnn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># flatten all dimensions except batch</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<details><summary><p>Helper methods for cross validation <strong>(click to expand)</strong></p>
</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: This pulldown content is for docs.cleanlab.ai, if running on local Jupyter or Colab, please ignore it.</span>

<span class="c1"># Set device</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>


<span class="c1"># Method to calculate validation accuracy in each epoch</span>
<span class="k">def</span> <span class="nf">get_test_accuracy</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">testloader</span><span class="p">):</span>
    <span class="n">net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">testloader</span><span class="p">:</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

            <span class="c1"># run the model on the test set to predict labels</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>

            <span class="c1"># the label with the highest energy will be our prediction</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">labels</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">accuracy</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="c1"># compute the accuracy over all test images</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">accuracy</span> <span class="o">/</span> <span class="n">total</span>
    <span class="k">return</span> <span class="n">accuracy</span>


<span class="c1"># Method for training the model</span>
<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="n">testloader</span><span class="p">,</span> <span class="n">n_epochs</span><span class="p">,</span> <span class="n">patience</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>

    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

    <span class="n">best_test_accuracy</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>  <span class="c1"># loop over the dataset multiple times</span>
        <span class="n">start_epoch</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">):</span>
            <span class="c1"># get the inputs; data is a dict of {&quot;image&quot;: images, &quot;label&quot;: labels}</span>

            <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

            <span class="c1"># zero the parameter gradients</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

            <span class="c1"># forward + backward + optimize</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

            <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

        <span class="c1"># Get accuracy on the test set</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">get_test_accuracy</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">testloader</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accuracy</span> <span class="o">&gt;</span> <span class="n">best_test_accuracy</span><span class="p">:</span>
            <span class="n">best_epoch</span> <span class="o">=</span> <span class="n">epoch</span>

        <span class="c1"># Condition for early stopping</span>
        <span class="k">if</span> <span class="n">epoch</span> <span class="o">-</span> <span class="n">best_epoch</span> <span class="o">&gt;</span> <span class="n">patience</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Early stopping at epoch </span><span class="si">{</span><span class="n">epoch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">end_epoch</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;epoch: </span><span class="si">{</span><span class="n">epoch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> loss: </span><span class="si">{</span><span class="n">running_loss</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">trainloader</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> test acc: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> time_taken: </span><span class="si">{</span><span class="n">end_epoch</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_epoch</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>


<span class="c1"># Method for computing out-of-sample embeddings</span>
<span class="k">def</span> <span class="nf">compute_embeddings</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">testloader</span><span class="p">):</span>
    <span class="n">embeddings_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">testloader</span><span class="p">):</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

            <span class="n">embeddings</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
            <span class="n">embeddings_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">embeddings</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">embeddings_list</span><span class="p">)</span>


<span class="c1"># Method for computing out-of-sample predicted probabilities</span>
<span class="k">def</span> <span class="nf">compute_pred_probs</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">testloader</span><span class="p">):</span>
    <span class="n">pred_probs_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">testloader</span><span class="p">):</span>
            <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

            <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
            <span class="n">pred_probs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">pred_probs_list</span><span class="p">)</span>
</pre></div>
</div>
</details></section>
<section id="4.-Prepare-the-dataset-for-K-fold-cross-validation">
<h2>4. Prepare the dataset for K-fold cross-validation<a class="headerlink" href="#4.-Prepare-the-dataset-for-K-fold-cross-validation" title="Permalink to this heading">#</a></h2>
<p>To find label issues based on <code class="docutils literal notranslate"><span class="pre">pred_probs</span></code>, we recommend out-of-sample predictions, which can be produced <a class="reference external" href="https://docs.cleanlab.ai/stable/tutorials/pred_probs_cross_val.html">via K-fold cross-validation</a>. To ensure this tutorial runs quickly, we set K and other important neural network training hyperparameters to small values here. Use larger values to get good results in practice!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Number of cross-validation folds. Set to small value here to ensure quick runtimes, we recommend 5 or 10 in practice for more accurate estimates.</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Number of epochs to train model for. Set to a small value here for quick runtime, you should use a larger value in practice.</span>
<span class="n">patience</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Parameter for early stopping. If the validation accuracy does not improve for this many epochs, training will stop.</span>
<span class="n">train_batch_size</span> <span class="o">=</span> <span class="mi">64</span>  <span class="c1"># Batch size for training</span>
<span class="n">test_batch_size</span> <span class="o">=</span> <span class="mi">512</span>  <span class="c1"># Batch size for testing</span>
<span class="n">num_workers</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>  <span class="c1"># Number of workers for data loaders</span>

<span class="c1"># Create k splits of the dataset</span>
<span class="n">kfold</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">kfold</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">transformed_dataset</span><span class="p">,</span> <span class="n">transformed_dataset</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">])</span>

<span class="n">train_id_list</span><span class="p">,</span> <span class="n">test_id_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">fold</span><span class="p">,</span> <span class="p">(</span><span class="n">train_ids</span><span class="p">,</span> <span class="n">test_ids</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">splits</span><span class="p">):</span>
    <span class="n">train_id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_ids</span><span class="p">)</span>
    <span class="n">test_id_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="5.-Compute-out-of-sample-predicted-probabilities-and-feature-embeddings">
<h2>5. Compute out-of-sample predicted probabilities and feature embeddings<a class="headerlink" href="#5.-Compute-out-of-sample-predicted-probabilities-and-feature-embeddings" title="Permalink to this heading">#</a></h2>
<p>We use cross-validation to compute out-of-sample predicted probabilities separately for each dataset fold. However, we use only one model to generate embeddings for all the images across the full dataset. This ensures all feature embeddings lie in the same representation space for more accurate detection of data issues. Here we embed all the data using our model trained in theÂ first cross-validation fold, but you could also train a separate embedding model on the full dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_probs_list</span><span class="p">,</span> <span class="n">embeddings_list</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="n">embeddings_model</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Training on fold: </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> ...&quot;</span><span class="p">)</span>

    <span class="c1"># Create train and test sets and corresponding dataloaders</span>
    <span class="n">trainset</span> <span class="o">=</span> <span class="n">Subset</span><span class="p">(</span><span class="n">torch_dataset</span><span class="p">,</span> <span class="n">train_id_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">testset</span> <span class="o">=</span> <span class="n">Subset</span><span class="p">(</span><span class="n">torch_dataset</span><span class="p">,</span> <span class="n">test_id_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">trainloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">trainset</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">train_batch_size</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span>
        <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">testloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">testset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">test_batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="n">num_workers</span><span class="p">,</span> <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1"># Train model</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="n">testloader</span><span class="p">,</span> <span class="n">n_epochs</span><span class="p">,</span> <span class="n">patience</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">embeddings_model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">embeddings_model</span> <span class="o">=</span> <span class="n">model</span>

    <span class="c1"># Compute out-of-sample embeddings</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing feature embeddings ...&quot;</span><span class="p">)</span>
    <span class="n">fold_embeddings</span> <span class="o">=</span> <span class="n">compute_embeddings</span><span class="p">(</span><span class="n">embeddings_model</span><span class="p">,</span> <span class="n">testloader</span><span class="p">)</span>
    <span class="n">embeddings_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fold_embeddings</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Computing predicted probabilities ...&quot;</span><span class="p">)</span>
    <span class="c1"># Compute out-of-sample predicted probabilities</span>
    <span class="n">fold_pred_probs</span> <span class="o">=</span> <span class="n">compute_pred_probs</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">testloader</span><span class="p">)</span>
    <span class="n">pred_probs_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fold_pred_probs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished Training&quot;</span><span class="p">)</span>


<span class="c1"># Combine embeddings and predicted probabilities from each fold</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">embeddings_list</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="n">logits</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">pred_probs_list</span><span class="p">)</span>
<span class="n">pred_probs</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">logits</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Training on fold: 1 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
epoch: 1 loss: 0.483 test acc: 86.835 time_taken: 4.643
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
epoch: 2 loss: 0.331 test acc: 88.310 time_taken: 4.266
Computing feature embeddings ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>0%|          | 0/40 [00:00&amp;lt;?, ?it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>0%|          | 0/40 [00:00&lt;?, ?it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>0%|          | 0/40 [00:00&lt;?, ?it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>2%|â–Ž         | 1/40 [00:00&amp;lt;00:04,  9.60it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>2%|â–Ž         | 1/40 [00:00&lt;00:04,  9.60it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>2%|â–Ž         | 1/40 [00:00&lt;00:04,  9.60it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>20%|â–ˆâ–ˆ        | 8/40 [00:00&amp;lt;00:00, 43.20it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>20%|â–ˆâ–ˆ        | 8/40 [00:00&lt;00:00, 43.20it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>20%|â–ˆâ–ˆ        | 8/40 [00:00&lt;00:00, 43.20it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 16/40 [00:00&amp;lt;00:00, 58.72it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 16/40 [00:00&lt;00:00, 58.72it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 16/40 [00:00&lt;00:00, 58.72it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 24/40 [00:00&amp;lt;00:00, 65.48it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 24/40 [00:00&lt;00:00, 65.48it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 24/40 [00:00&lt;00:00, 65.48it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 32/40 [00:00&amp;lt;00:00, 69.61it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 32/40 [00:00&lt;00:00, 69.61it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 32/40 [00:00&lt;00:00, 69.61it/s]</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre></div></div>
</div>
<dl>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&amp;lt;00:00, 64.50it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 64.50it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 64.50it/s]</p>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing predicted probabilities ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>0%|          | 0/40 [00:00&amp;lt;?, ?it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>0%|          | 0/40 [00:00&lt;?, ?it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>0%|          | 0/40 [00:00&lt;?, ?it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>5%|â–Œ         | 2/40 [00:00&amp;lt;00:01, 19.57it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>5%|â–Œ         | 2/40 [00:00&lt;00:01, 19.57it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>5%|â–Œ         | 2/40 [00:00&lt;00:01, 19.57it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&amp;lt;00:00, 52.62it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&lt;00:00, 52.62it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&lt;00:00, 52.62it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&amp;lt;00:00, 62.21it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&lt;00:00, 62.21it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&lt;00:00, 62.21it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&amp;lt;00:00, 67.33it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&lt;00:00, 67.33it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&lt;00:00, 67.33it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:00&amp;lt;00:00, 71.64it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:00&lt;00:00, 71.64it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:00&lt;00:00, 71.64it/s]</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre></div></div>
</div>
<dl>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&amp;lt;00:00, 66.52it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 66.52it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 66.52it/s]</p>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Training on fold: 2 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
epoch: 1 loss: 0.492 test acc: 87.085 time_taken: 4.608
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
epoch: 2 loss: 0.330 test acc: 88.290 time_taken: 4.331
Computing feature embeddings ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>0%|          | 0/40 [00:00&amp;lt;?, ?it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>0%|          | 0/40 [00:00&lt;?, ?it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>0%|          | 0/40 [00:00&lt;?, ?it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>2%|â–Ž         | 1/40 [00:00&amp;lt;00:03,  9.85it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>2%|â–Ž         | 1/40 [00:00&lt;00:03,  9.85it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>2%|â–Ž         | 1/40 [00:00&lt;00:03,  9.85it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>22%|â–ˆâ–ˆâ–Ž       | 9/40 [00:00&amp;lt;00:00, 49.11it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>22%|â–ˆâ–ˆâ–Ž       | 9/40 [00:00&lt;00:00, 49.11it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>22%|â–ˆâ–ˆâ–Ž       | 9/40 [00:00&lt;00:00, 49.11it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 17/40 [00:00&amp;lt;00:00, 60.52it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 17/40 [00:00&lt;00:00, 60.52it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 17/40 [00:00&lt;00:00, 60.52it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 25/40 [00:00&amp;lt;00:00, 66.28it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 25/40 [00:00&lt;00:00, 66.28it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 25/40 [00:00&lt;00:00, 66.28it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 33/40 [00:00&amp;lt;00:00, 70.52it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 33/40 [00:00&lt;00:00, 70.52it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 33/40 [00:00&lt;00:00, 70.52it/s]</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre></div></div>
</div>
<dl>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&amp;lt;00:00, 65.09it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 65.09it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 65.09it/s]</p>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing predicted probabilities ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>0%|          | 0/40 [00:00&amp;lt;?, ?it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>0%|          | 0/40 [00:00&lt;?, ?it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>0%|          | 0/40 [00:00&lt;?, ?it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>5%|â–Œ         | 2/40 [00:00&amp;lt;00:02, 18.18it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>5%|â–Œ         | 2/40 [00:00&lt;00:02, 18.18it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>5%|â–Œ         | 2/40 [00:00&lt;00:02, 18.18it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&amp;lt;00:00, 51.39it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&lt;00:00, 51.39it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&lt;00:00, 51.39it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&amp;lt;00:00, 62.81it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&lt;00:00, 62.81it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&lt;00:00, 62.81it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&amp;lt;00:00, 67.42it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&lt;00:00, 67.42it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&lt;00:00, 67.42it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:00&amp;lt;00:00, 69.48it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:00&lt;00:00, 69.48it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 34/40 [00:00&lt;00:00, 69.48it/s]</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre></div></div>
</div>
<dl>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&amp;lt;00:00, 65.20it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 65.20it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 65.20it/s]</p>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Training on fold: 3 ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
epoch: 1 loss: 0.476 test acc: 86.305 time_taken: 4.558
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
epoch: 2 loss: 0.328 test acc: 86.335 time_taken: 4.272
Computing feature embeddings ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>0%|          | 0/40 [00:00&amp;lt;?, ?it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>0%|          | 0/40 [00:00&lt;?, ?it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>0%|          | 0/40 [00:00&lt;?, ?it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>5%|â–Œ         | 2/40 [00:00&amp;lt;00:02, 17.37it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>5%|â–Œ         | 2/40 [00:00&lt;00:02, 17.37it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>5%|â–Œ         | 2/40 [00:00&lt;00:02, 17.37it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&amp;lt;00:00, 50.97it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&lt;00:00, 50.97it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>25%|â–ˆâ–ˆâ–Œ       | 10/40 [00:00&lt;00:00, 50.97it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&amp;lt;00:00, 61.83it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&lt;00:00, 61.83it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 18/40 [00:00&lt;00:00, 61.83it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&amp;lt;00:00, 67.20it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&lt;00:00, 67.20it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 26/40 [00:00&lt;00:00, 67.20it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:00&amp;lt;00:00, 72.39it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:00&lt;00:00, 72.39it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:00&lt;00:00, 72.39it/s]</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre></div></div>
</div>
<dl>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&amp;lt;00:00, 65.55it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 65.55it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 65.55it/s]</p>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing predicted probabilities ...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>0%|          | 0/40 [00:00&amp;lt;?, ?it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>0%|          | 0/40 [00:00&lt;?, ?it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>0%|          | 0/40 [00:00&lt;?, ?it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>8%|â–Š         | 3/40 [00:00&amp;lt;00:01, 26.51it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>8%|â–Š         | 3/40 [00:00&lt;00:01, 26.51it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>8%|â–Š         | 3/40 [00:00&lt;00:01, 26.51it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>28%|â–ˆâ–ˆâ–Š       | 11/40 [00:00&amp;lt;00:00, 54.82it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>28%|â–ˆâ–ˆâ–Š       | 11/40 [00:00&lt;00:00, 54.82it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>28%|â–ˆâ–ˆâ–Š       | 11/40 [00:00&lt;00:00, 54.82it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 19/40 [00:00&amp;lt;00:00, 64.96it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 19/40 [00:00&lt;00:00, 64.96it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 19/40 [00:00&lt;00:00, 64.96it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 27/40 [00:00&amp;lt;00:00, 70.23it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 27/40 [00:00&lt;00:00, 70.23it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 27/40 [00:00&lt;00:00, 70.23it/s]</p>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">more-to-come<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">class<span class="colon">:</span></dt>
<dd class="field-even"><p>stderr</p>
</dd>
</dl>
<div class="highlight"><pre></div></div></blockquote>
<dl>
<dt>88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:00&amp;lt;00:00, 73.31it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:00&lt;00:00, 73.31it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 35/40 [00:00&lt;00:00, 73.31it/s]</p>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre></div></div>
</div>
<dl>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&amp;lt;00:00, 67.95it/s]</dt><dd><blockquote>
<div><p>&lt;/pre&gt;</p>
</div></blockquote>
</dd>
<dt>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 67.95it/s]</dt><dd><blockquote>
<div><p>end{sphinxVerbatim}</p>
</div></blockquote>
</dd>
</dl>
<p>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00&lt;00:00, 67.95it/s]</p>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finished Training
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>Reorder rows of the dataset based on row order in <code class="docutils literal notranslate"><span class="pre">features</span></code> and <code class="docutils literal notranslate"><span class="pre">pred_probs</span></code>. <strong>Carefully ensure your ordering of the dataset matches these objects!</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">test_id_list</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="7.-Use-cleanlab-to-find-issues">
<h2>7. Use cleanlab to find issues<a class="headerlink" href="#7.-Use-cleanlab-to-find-issues" title="Permalink to this heading">#</a></h2>
<p>Based on the out-of-sample predicted probabilities and feature embeddings from our ML model, cleanlab can automatically detect issues in our labeled dataset.</p>
<p>Here we use cleanlabâ€™s <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> class to find issues in our data. <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> supports several dataÂ formats, in this tutorial we have a Hugging Face Dataset. <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> takes in two optional dataset arguments: <code class="docutils literal notranslate"><span class="pre">label_name</span></code>, which corresponds to the column containing labels (if your dataset is labeled), and <code class="docutils literal notranslate"><span class="pre">image_key</span></code>, corresponding to the name of a key in your vision dataset to access the raw images. When you provide these optional arguments, <code class="docutils literal notranslate"><span class="pre">Datalab</span></code> will audit your dataset for more
types of issues than it would by default.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lab</span> <span class="o">=</span> <span class="n">Datalab</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> <span class="n">image_key</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">find_issues</span></code> method can automatically infer the types of issues to be checked for based on the provided arguments. Here, we provide <code class="docutils literal notranslate"><span class="pre">features</span></code> and <code class="docutils literal notranslate"><span class="pre">pred_probs</span></code> as arguments. If you want to check for a specific issue type, you can do so using the <code class="docutils literal notranslate"><span class="pre">issue_types</span></code> argument. Check the <a class="reference external" href="https://docs.cleanlab.ai/stable/cleanlab/datalab/datalab.html#cleanlab.datalab.datalab.Datalab.find_issues">documentation</a> for a more comprehensive guide on <code class="docutils literal notranslate"><span class="pre">find_issues</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lab</span><span class="o">.</span><span class="n">find_issues</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">features</span><span class="p">,</span> <span class="n">pred_probs</span><span class="o">=</span><span class="n">pred_probs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding null issues ...
Finding label issues ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding outlier issues ...
Fitting OOD estimator based on provided features ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding near_duplicate issues ...
Finding non_iid issues ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Finding class_imbalance issues ...
Finding dark, light, low_information, odd_aspect_ratio, odd_size, grayscale, blurry images ...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "e08ceedeea77417695ed56bd0f74a6ce"}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Removing grayscale from potential issues in the dataset as it exceeds max_prevalence=0.1

Audit complete. 7620 issues found in the dataset.
</pre></div></div>
</div>
<section id="View-report">
<h3>View report<a class="headerlink" href="#View-report" title="Permalink to this heading">#</a></h3>
<p>After the audit is complete, we can view a high-level report of detected data issues.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lab</span><span class="o">.</span><span class="n">report</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Here is a summary of the different kinds of issues found in the data:

      issue_type  num_issues
         outlier        3692
           label        3521
  near_duplicate         225
 low_information         166
            dark          16
            null           0
         non_iid           0
 class_imbalance           0
          blurry           0
           light           0
odd_aspect_ratio           0
        odd_size           0

Dataset Information: num_examples: 60000, num_classes: 10


---------------------- outlier issues ----------------------

About this issue:
        Examples that are very different from the rest of the dataset
    (i.e. potentially out-of-distribution or rare/anomalous instances).


Number of examples with this issue: 3692
Overall dataset quality in terms of this issue: 0.3691

Examples representing most severe instances of this issue:
       is_outlier_issue  outlier_score
40378              True   3.943831e-07
54473              True   1.066211e-06
29412              True   1.899069e-06
25316              True   1.984817e-06
52247              True   3.245879e-06


----------------------- label issues -----------------------

About this issue:
        Examples whose given label is estimated to be potentially incorrect
    (e.g. due to annotation error) are flagged as having label issues.


Number of examples with this issue: 3521
Overall dataset quality in terms of this issue: 0.9581

Examples representing most severe instances of this issue:
       is_label_issue  label_score given_label  predicted_label
19228            True     0.000005       Dress            Shirt
54078            True     0.000010    Pullover            Dress
32657           False     0.000010         Bag  T - shirt / top
21282           False     0.000011         Bag            Dress
11262            True     0.000014        Coat  T - shirt / top


------------------ near_duplicate issues -------------------

About this issue:
        A (near) duplicate issue refers to two or more examples in
    a dataset that are extremely similar to each other, relative
    to the rest of the dataset.  The examples flagged with this issue
    may be exactly duplicated, or lie atypically close together when
    represented as vectors (i.e. feature embeddings).


Number of examples with this issue: 225
Overall dataset quality in terms of this issue: 0.6294

Examples representing most severe instances of this issue:
       is_near_duplicate_issue  near_duplicate_score   near_duplicate_sets  distance_to_nearest_neighbor
30659                     True              0.000798               [30968]                      0.000015
30968                     True              0.000798               [30659]                      0.000015
258                       True              0.000907  [9762, 54565, 47139]                      0.000017
9762                      True              0.000907   [258, 54565, 47139]                      0.000017
54565                     True              0.001423    [9762, 258, 47139]                      0.000026


----------------------- null issues ------------------------

About this issue:
        Examples identified with the null issue correspond to rows that have null/missing values across all feature columns (i.e. the entire row is missing values).


Number of examples with this issue: 0
Overall dataset quality in terms of this issue: 1.0000

Examples representing most severe instances of this issue:
       is_null_issue  null_score
0              False         1.0
39992          False         1.0
39993          False         1.0
39994          False         1.0
39995          False         1.0


---------------------- non_iid issues ----------------------

About this issue:
        Whether the dataset exhibits statistically significant
    violations of the IID assumption like:
    changepoints or shift, drift, autocorrelation, etc.
    The specific violation considered is whether the
    examples are ordered such that almost adjacent examples
    tend to have more similar feature values.


Number of examples with this issue: 0
Overall dataset quality in terms of this issue: 0.7834

Examples representing most severe instances of this issue:
       is_non_iid_issue  non_iid_score
42819             False       0.629362
51431             False       0.654330
55548             False       0.658364
51191             False       0.668572
50081             False       0.669703

Additional Information:
p-value: 0.7834321613629787


------------------ class_imbalance issues ------------------

About this issue:
        Examples belonging to the most under-represented class in the dataset.

Number of examples with this issue: 0
Overall dataset quality in terms of this issue: 0.1000

Examples representing most severe instances of this issue:
       is_class_imbalance_issue  class_imbalance_score      given_label
0                         False                    0.1  T - shirt / top
13732                     False                    0.1  T - shirt / top
13733                     False                    0.1  T - shirt / top
13734                     False                    0.1  T - shirt / top
47635                     False                    0.1  T - shirt / top

Additional Information:
Rarest Class: NA



Removing grayscale from potential issues in the dataset as it exceeds max_prevalence=0.5
------------------ low_information images ------------------

Number of examples with this issue: 166
Examples representing most severe instances of this issue:

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_30_1.png" src="../_images/tutorials_image_30_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
----------------------- dark images ------------------------

Number of examples with this issue: 16
Examples representing most severe instances of this issue:

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_30_3.png" src="../_images/tutorials_image_30_3.png" />
</div>
</div>
</section>
<section id="Label-issues">
<h3>Label issues<a class="headerlink" href="#Label-issues" title="Permalink to this heading">#</a></h3>
<p>Letâ€™s first inspect mislabeled examples in the dataset. Such errors occur when the given label for an image is incorrect, usually due to mistakes made by data annotators. Cleanlab automatically detects mislabeled data that you can correct to improve your dataset.</p>
<p>For each type of issue that Cleanlab detects, you can use the <code class="docutils literal notranslate"><span class="pre">get_issues</span></code> method to see which examples in the dataset exhibit this type of issue (and how severely). Letâ€™s see which images in our dataset are estimated to be mislabeled:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">)</span>
<span class="n">label_issues</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_label_issue</th>
      <th>label_score</th>
      <th>given_label</th>
      <th>predicted_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>True</td>
      <td>0.110901</td>
      <td>T - shirt / top</td>
      <td>Dress</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>0.974390</td>
      <td>T - shirt / top</td>
      <td>T - shirt / top</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>0.998733</td>
      <td>Sandal</td>
      <td>Sandal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>0.937117</td>
      <td>Sandal</td>
      <td>Sandal</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>0.998755</td>
      <td>Dress</td>
      <td>Dress</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>The above dataframe contains a <code class="docutils literal notranslate"><span class="pre">label_score</span></code> for each example in the dataset. These numeric quality scores lie between 0 and 1, where lower scores indicate examples more likely to be mislabeled. It contains a boolean column <code class="docutils literal notranslate"><span class="pre">is_label_issue</span></code> specifying whether or not each example appears to have a label issue (indicating it is likely mislabeled).</p>
<p>Filter the <code class="docutils literal notranslate"><span class="pre">label_issues</span></code> DataFrame to see which examples have label issues, and sort by <code class="docutils literal notranslate"><span class="pre">label_score</span></code>(in ascending order) to see the most likely mislabeled examples first.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">label_issues_df</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_label_issue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;label_score&quot;</span><span class="p">)</span>
<span class="n">label_issues_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_label_issue</th>
      <th>label_score</th>
      <th>given_label</th>
      <th>predicted_label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19228</th>
      <td>True</td>
      <td>0.000005</td>
      <td>Dress</td>
      <td>Shirt</td>
    </tr>
    <tr>
      <th>54078</th>
      <td>True</td>
      <td>0.000010</td>
      <td>Pullover</td>
      <td>Dress</td>
    </tr>
    <tr>
      <th>11262</th>
      <td>True</td>
      <td>0.000014</td>
      <td>Coat</td>
      <td>T - shirt / top</td>
    </tr>
    <tr>
      <th>53564</th>
      <td>True</td>
      <td>0.000017</td>
      <td>Pullover</td>
      <td>T - shirt / top</td>
    </tr>
    <tr>
      <th>5473</th>
      <td>True</td>
      <td>0.000017</td>
      <td>Pullover</td>
      <td>Trouser</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<details><summary><p>We define a helper method plot_label_issue_examples to visualize results. <strong>(click to expand)</strong></p>
</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: This pulldown content is for docs.cleanlab.ai, if running on local Jupyter or Colab, please ignore it.</span>

<span class="k">def</span> <span class="nf">plot_label_issue_examples</span><span class="p">(</span><span class="n">label_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_examples</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">))</span>
    <span class="n">axes_list</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">label_issue_indices</span> <span class="o">=</span> <span class="n">label_issues_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">num_examples</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">label_issue_indices</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;id: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="se">\n</span><span class="s2"> GL: </span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">given_label</span><span class="si">}</span><span class="se">\n</span><span class="s2"> SL: </span><span class="si">{</span><span class="n">row</span><span class="o">.</span><span class="n">predicted_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</details><section id="View-most-likely-examples-with-label-errors">
<h4>View most likely examples with label errors<a class="headerlink" href="#View-most-likely-examples-with-label-errors" title="Permalink to this heading">#</a></h4>
<p>Here we define <code class="docutils literal notranslate"><span class="pre">GL</span></code> : given label in the original dataset <code class="docutils literal notranslate"><span class="pre">SL</span></code> : suggested alternative label by cleanlab</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_label_issue_examples</span><span class="p">(</span><span class="n">label_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_38_0.png" src="../_images/tutorials_image_38_0.png" />
</div>
</div>
</section>
</section>
<section id="Outlier-issues">
<h3>Outlier issues<a class="headerlink" href="#Outlier-issues" title="Permalink to this heading">#</a></h3>
<p>Datalab also detects atypical images lurking in our dataset. Such outliers are significantly different from the majority of the dataset and may have an outsized impact on how models fit to this data.</p>
<p>Similarly to the previous section, we filter the <code class="docutils literal notranslate"><span class="pre">outlier_issues</span></code> DataFrame to find examples that are considered to be outliers. We then sort the filtered results by their outlier quality score, where examples with the lowest scores are those that appear least typical relative to the rest of the dataset.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outlier_issues_df</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;outlier&quot;</span><span class="p">)</span>
<span class="n">outlier_issues_df</span> <span class="o">=</span> <span class="n">outlier_issues_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_outlier_issue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;outlier_score&quot;</span><span class="p">)</span>
<span class="n">outlier_issues_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_outlier_issue</th>
      <th>outlier_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>40378</th>
      <td>True</td>
      <td>3.943831e-07</td>
    </tr>
    <tr>
      <th>54473</th>
      <td>True</td>
      <td>1.066211e-06</td>
    </tr>
    <tr>
      <th>29412</th>
      <td>True</td>
      <td>1.899069e-06</td>
    </tr>
    <tr>
      <th>25316</th>
      <td>True</td>
      <td>1.984817e-06</td>
    </tr>
    <tr>
      <th>52247</th>
      <td>True</td>
      <td>3.245879e-06</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="View-most-severe-outliers">
<h4>View most severe outliers<a class="headerlink" href="#View-most-severe-outliers" title="Permalink to this heading">#</a></h4>
<p>In this visualization, the first image in every row shows the potential outlier, while the remaining images in the same row depict typical instances from the corresponding class.</p>
<details><summary><p>We define a helper method plot_outlier_issues_examples to visualize results. <strong>(click to expand)</strong></p>
</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: This pulldown content is for docs.cleanlab.ai, if running on local Jupyter or Colab, please ignore it.</span>

<span class="k">def</span> <span class="nf">plot_outlier_issues_examples</span><span class="p">(</span><span class="n">outlier_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="p">):</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">num_examples</span>
    <span class="n">N_comparison_images</span> <span class="o">=</span> <span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">sample_from_class</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">number_of_samples</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="n">non_outlier_indices</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">label_issues</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outlier_issues_df</span><span class="p">)</span>
            <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;given_label == @label and is_outlier_issue.isnull()&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">index</span>
        <span class="p">)</span>
        <span class="n">non_outlier_indices_excluding_current</span> <span class="o">=</span> <span class="n">non_outlier_indices</span><span class="p">[</span><span class="n">non_outlier_indices</span> <span class="o">!=</span> <span class="n">index</span><span class="p">]</span>

        <span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="n">non_outlier_indices_excluding_current</span><span class="p">,</span> <span class="n">number_of_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="n">label_scores_of_sampled</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sampled_indices</span><span class="p">][</span><span class="s2">&quot;label_score&quot;</span><span class="p">]</span>

        <span class="n">top_score_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">label_scores_of_sampled</span><span class="o">.</span><span class="n">values</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="n">N_comparison_images</span><span class="p">]</span>

        <span class="n">top_label_indices</span> <span class="o">=</span> <span class="n">sampled_indices</span><span class="p">[</span><span class="n">top_score_indices</span><span class="p">]</span>

        <span class="n">sampled_images</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">top_label_indices</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">sampled_images</span>

    <span class="k">def</span> <span class="nf">get_image_given_label_and_samples</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
        <span class="n">image_from_dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span>
        <span class="n">corresponding_label</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;given_label&quot;</span><span class="p">]</span>
        <span class="n">comparison_images</span> <span class="o">=</span> <span class="n">sample_from_class</span><span class="p">(</span><span class="n">corresponding_label</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">idx</span><span class="p">)[:</span><span class="n">N_comparison_images</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">image_from_dataset</span><span class="p">,</span> <span class="n">corresponding_label</span><span class="p">,</span> <span class="n">comparison_images</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">images_to_plot</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">idlist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">outlier_issues_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">name</span>
        <span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">comparison_images</span> <span class="o">=</span> <span class="n">get_image_given_label_and_samples</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">idlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">images_to_plot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="n">images_to_plot</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">comparison_images</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">nrows</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">N_comparison_images</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">))</span>
    <span class="n">axes_list</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="n">ncols</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;id: </span><span class="si">{</span><span class="n">idlist</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">ncols</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s2"> GL: </span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">ncols</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images_to_plot</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</details><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_outlier_issues_examples</span><span class="p">(</span><span class="n">outlier_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_44_0.png" src="../_images/tutorials_image_44_0.png" />
</div>
</div>
</section>
</section>
<section id="Near-duplicate-issues">
<h3>Near duplicate issues<a class="headerlink" href="#Near-duplicate-issues" title="Permalink to this heading">#</a></h3>
<p>Datalab also detects which examples are (near) duplicates of other examples in the dataset. Near duplicate images in a dataset can lead to model overfitting and have an outsized impact on evaluation metrics (especially when you have duplicates between training and test splits).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">near_duplicate_issues</span></code> DataFrame tells us which examples are considered to be nearly duplicated in the dataset (including exact duplicates as well). We can sort all images via the <code class="docutils literal notranslate"><span class="pre">near_duplicate_score</span></code> which quantifies how severe this issue is for each image (lower values indicate more severe instances of a type of issue, in this case, how similar the image is to its closest neighbor in the dataset).</p>
<p>This allows us to visualize examples in the dataset that are considered nearly duplicated, along with their highly similar counterparts.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">near_duplicate_issues_df</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;near_duplicate&quot;</span><span class="p">)</span>
<span class="n">near_duplicate_issues_df</span> <span class="o">=</span> <span class="n">near_duplicate_issues_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_near_duplicate_issue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="s2">&quot;near_duplicate_score&quot;</span>
<span class="p">)</span>
<span class="n">near_duplicate_issues_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>is_near_duplicate_issue</th>
      <th>near_duplicate_score</th>
      <th>near_duplicate_sets</th>
      <th>distance_to_nearest_neighbor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>30659</th>
      <td>True</td>
      <td>0.000798</td>
      <td>[30968]</td>
      <td>0.000015</td>
    </tr>
    <tr>
      <th>30968</th>
      <td>True</td>
      <td>0.000798</td>
      <td>[30659]</td>
      <td>0.000015</td>
    </tr>
    <tr>
      <th>258</th>
      <td>True</td>
      <td>0.000907</td>
      <td>[9762, 54565, 47139]</td>
      <td>0.000017</td>
    </tr>
    <tr>
      <th>9762</th>
      <td>True</td>
      <td>0.000907</td>
      <td>[258, 54565, 47139]</td>
      <td>0.000017</td>
    </tr>
    <tr>
      <th>54565</th>
      <td>True</td>
      <td>0.001423</td>
      <td>[9762, 258, 47139]</td>
      <td>0.000026</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="View-sets-of-near-duplicate-images">
<h4>View sets of near duplicate images<a class="headerlink" href="#View-sets-of-near-duplicate-images" title="Permalink to this heading">#</a></h4>
<details><summary><p>We define a helper method plot_near_duplicate_issue_examples to visualize results. <strong>(click to expand)</strong></p>
</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: This pulldown content is for docs.cleanlab.ai, if running on local Jupyter or Colab, please ignore it.</span>

<span class="k">def</span> <span class="nf">plot_near_duplicate_issue_examples</span><span class="p">(</span><span class="n">near_duplicate_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="n">num_examples</span>
    <span class="n">seen_id_pairs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_image_and_given_label_and_predicted_label</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;given_label&quot;</span><span class="p">]</span>
        <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;predicted_label&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">predicted_label</span>

    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">near_duplicate_issues_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">image</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">get_image_and_given_label_and_predicted_label</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">duplicate_images</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">near_duplicate_sets</span>
        <span class="n">nd_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">duplicate_images</span><span class="p">])</span>
        <span class="n">nd_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">nd_set</span> <span class="o">&amp;</span> <span class="n">seen_id_pairs</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd_set</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nd_set</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nd_set</span><span class="p">),</span> <span class="n">axes</span><span class="p">):</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;given_label&quot;</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;id: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2"> GL: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
        <span class="n">seen_id_pairs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">nd_set</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">nrows</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</details><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_near_duplicate_issue_examples</span><span class="p">(</span><span class="n">near_duplicate_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_50_0.png" src="../_images/tutorials_image_50_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_50_1.png" src="../_images/tutorials_image_50_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_50_2.png" src="../_images/tutorials_image_50_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_50_3.png" src="../_images/tutorials_image_50_3.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_50_4.png" src="../_images/tutorials_image_50_4.png" />
</div>
</div>
<p>Learn more about handling near duplicates detected in a dataset from <a class="reference external" href="../faq.html#How-to-handle-near-duplicate-data-identified-by-cleanlab?">the FAQ</a>.</p>
</section>
</section>
<section id="Dark-images">
<h3>Dark images<a class="headerlink" href="#Dark-images" title="Permalink to this heading">#</a></h3>
<p>Datalab can also detect low-quality images in the dataset, such as those that are abnormally dark. It can be challenging for both annotators and models to assign a proper class label for low-quality data, which can hamper model training and testing.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dark_issues</span></code> DataFrame reveals which examples are considered to be abnormally dark. We can sort them via the <code class="docutils literal notranslate"><span class="pre">dark_score</span></code> which quantifies how severe this issue is for each image (lower values indicate more severe instances of a type of issue). This allows us to visualize images in the dataset considered to be too dark (you might consider omitting such low-quality examples from a training dataset).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dark_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;dark&quot;</span><span class="p">)</span>
<span class="n">dark_issues_df</span> <span class="o">=</span> <span class="n">dark_issues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_dark_issue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;dark_score&quot;</span><span class="p">)</span>
<span class="n">dark_issues_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dark_score</th>
      <th>is_dark_issue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>34848</th>
      <td>0.203922</td>
      <td>True</td>
    </tr>
    <tr>
      <th>50270</th>
      <td>0.204588</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3936</th>
      <td>0.213098</td>
      <td>True</td>
    </tr>
    <tr>
      <th>733</th>
      <td>0.217686</td>
      <td>True</td>
    </tr>
    <tr>
      <th>8094</th>
      <td>0.230118</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<section id="View-top-examples-of-dark-images">
<h4>View top examples of dark images<a class="headerlink" href="#View-top-examples-of-dark-images" title="Permalink to this heading">#</a></h4>
<details><summary><p>We define a helper method plot_image_issue_examples to visualize results. <strong>(click to expand)</strong></p>
</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: This pulldown content is for docs.cleanlab.ai, if running on local Jupyter or Colab, please ignore it.</span>

<span class="k">def</span> <span class="nf">plot_image_issue_examples</span><span class="p">(</span><span class="n">issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">num_examples</span> <span class="o">/</span> <span class="n">ncols</span><span class="p">))</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="n">ncols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">ncols</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">nrows</span><span class="p">))</span>
    <span class="n">axes_list</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">issue_indices</span> <span class="o">=</span> <span class="n">issues_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">num_examples</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">issue_indices</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;given_label&quot;</span><span class="p">]</span>
        <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">label_issues</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;predicted_label&quot;</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;id: </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="se">\n</span><span class="s2"> GL: </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="se">\n</span><span class="s2"> SL: </span><span class="si">{</span><span class="n">predicted_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s2">&quot;image&quot;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</details><div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_image_issue_examples</span><span class="p">(</span><span class="n">dark_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_57_0.png" src="../_images/tutorials_image_57_0.png" />
</div>
</div>
<p>We can see from above examples that too dark images can also lead to label errors as it is difficult to see the contents of the image clearly.</p>
</section>
</section>
<section id="Low-information-images">
<h3>Low information images<a class="headerlink" href="#Low-information-images" title="Permalink to this heading">#</a></h3>
<p>Other types of low-quality images that Datalab can automatically detect include images whose information content is low. Low information images can hamper model generalization if they are present disproportionately in some classes.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">lowinfo_issues</span></code> DataFrame reveals which images are considered to be low information. We can sort them via the <code class="docutils literal notranslate"><span class="pre">low_information_score</span></code> which quantifies how severe this issue is for each image (lower values indicate more severe instances of a type of issue). This allows us to visualize the images in our dataset containing the least amount of information (you might consider omitting such low-quality examples from a training dataset).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lowinfo_issues</span> <span class="o">=</span> <span class="n">lab</span><span class="o">.</span><span class="n">get_issues</span><span class="p">(</span><span class="s2">&quot;low_information&quot;</span><span class="p">)</span>
<span class="n">lowinfo_issues_df</span> <span class="o">=</span> <span class="n">lowinfo_issues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;is_low_information_issue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="s2">&quot;low_information_score&quot;</span>
<span class="p">)</span>
<span class="n">lowinfo_issues_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>low_information_score</th>
      <th>is_low_information_issue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53050</th>
      <td>0.067975</td>
      <td>True</td>
    </tr>
    <tr>
      <th>40875</th>
      <td>0.089929</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9594</th>
      <td>0.092601</td>
      <td>True</td>
    </tr>
    <tr>
      <th>34825</th>
      <td>0.107744</td>
      <td>True</td>
    </tr>
    <tr>
      <th>37530</th>
      <td>0.108516</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_image_issue_examples</span><span class="p">(</span><span class="n">lowinfo_issues_df</span><span class="p">,</span> <span class="n">num_examples</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_image_61_0.png" src="../_images/tutorials_image_61_0.png" />
</div>
</div>
<p>Here we can see a lot of low information images belong to the Sandal class.</p>
</section>
<section id="Easy-Mode">
<h3>Easy Mode<a class="headerlink" href="#Easy-Mode" title="Permalink to this heading">#</a></h3>
<p>Cleanlab is most effective when you run this code with a good ML model. Try to produce the best ML model you can for your data (instead of the toy model from this tutorial). If you donâ€™t know the best ML model for your data, try <a class="reference external" href="https://cleanlab.ai/blog/data-centric-ai/">Cleanlab Studio</a> which will automatically produce one for you. Super easy to use, <a class="reference external" href="https://cleanlab.ai/blog/data-centric-ai/">Cleanlab Studio</a> isÂ no-code platform for data-centric AI that automatically: detects data
issues (more types of issues than this cleanlab package), helps you quickly correct these data issues, confidently labels large subsets of an unlabeled dataset, and provides other smart metadata about each of your data points â€“ all powered by a system that automatically trains/deploys the best ML model for your data. <a class="reference external" href="https://cleanlab.ai/signup/">Try it for free!</a></p>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"92b4f2f2eb894b508297d9ddab68019a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4526bda0a2254de19b864a8b42e69957": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "ab45d10614e443618c9150375bbda0d5": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_92b4f2f2eb894b508297d9ddab68019a", "max": 30931277.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_4526bda0a2254de19b864a8b42e69957", "value": 30931277.0}}, "fae984fb303f446490ad44b73921a66a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bfcc128e1ddc44e69455d3924104e811": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "c5024a8b65bd49278b2f6be3af262fe8": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_fae984fb303f446490ad44b73921a66a", "placeholder": "\u200b", "style": "IPY_MODEL_bfcc128e1ddc44e69455d3924104e811", "value": "Downloading data: 100%"}}, "a0882dd0f11746728c7209a68fd1b5aa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "215d6ab38b444d6c8bf96610bb8f2619": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "5a84fd72423d47f1a96e346234764cae": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_a0882dd0f11746728c7209a68fd1b5aa", "placeholder": "\u200b", "style": "IPY_MODEL_215d6ab38b444d6c8bf96610bb8f2619", "value": " 30.9M/30.9M [00:00&lt;00:00, 83.8MB/s]"}}, "b273e7ccdf874fff85e8df7de20b1183": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9c4bc8c9eed640d1b4669bdd2a531117": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_c5024a8b65bd49278b2f6be3af262fe8", "IPY_MODEL_ab45d10614e443618c9150375bbda0d5", "IPY_MODEL_5a84fd72423d47f1a96e346234764cae"], "layout": "IPY_MODEL_b273e7ccdf874fff85e8df7de20b1183"}}, "5dee5cb09e7341d0ba0fadbbfac6500b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "59e675fe3e09471da51f4f31fcfc56a4": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "974e06989af44050a5e15e2b753f34af": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_5dee5cb09e7341d0ba0fadbbfac6500b", "max": 5175617.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_59e675fe3e09471da51f4f31fcfc56a4", "value": 5175617.0}}, "4461302acce34ee1a95a1e5b948ea437": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c8f2259adb434dde9bf3a9f3b246a726": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "728ce02f7de44dd1ad331d1e189052ed": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_4461302acce34ee1a95a1e5b948ea437", "placeholder": "\u200b", "style": "IPY_MODEL_c8f2259adb434dde9bf3a9f3b246a726", "value": "Downloading data: 100%"}}, "14d195260dd043a18024e8d731303782": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf5692a72cb84aa399db9605721a9097": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "bb99261a27014658a2b9f52223ec5ead": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_14d195260dd043a18024e8d731303782", "placeholder": "\u200b", "style": "IPY_MODEL_cf5692a72cb84aa399db9605721a9097", "value": " 5.18M/5.18M [00:00&lt;00:00, 67.2MB/s]"}}, "033c99c39d714469b05863e467e93876": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "570fa3bab67b4d5185fa8072ec14b1a3": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_728ce02f7de44dd1ad331d1e189052ed", "IPY_MODEL_974e06989af44050a5e15e2b753f34af", "IPY_MODEL_bb99261a27014658a2b9f52223ec5ead"], "layout": "IPY_MODEL_033c99c39d714469b05863e467e93876"}}, "13bdb7e3b81845e291cfe13f5340139b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a0120b590d114ff1a79c6ab47abb1639": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "46bb7da44f464a15926447ca877d85b7": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_13bdb7e3b81845e291cfe13f5340139b", "max": 2.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_a0120b590d114ff1a79c6ab47abb1639", "value": 2.0}}, "626e4ccf6410411ea92327b3a3389655": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1a19efd26d394b978e721d9db4bb920c": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "85e9e6ba956941358e6eb339a7b1a52f": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_626e4ccf6410411ea92327b3a3389655", "placeholder": "\u200b", "style": "IPY_MODEL_1a19efd26d394b978e721d9db4bb920c", "value": "Computing checksums: 100%"}}, "206713630f754936b7d5ff170cd5c042": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "74e997b9d24849cf866dbd394b68d8dc": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "f5668126805e49b78cc8a7606f74b696": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_206713630f754936b7d5ff170cd5c042", "placeholder": "\u200b", "style": "IPY_MODEL_74e997b9d24849cf866dbd394b68d8dc", "value": " 2/2 [00:00&lt;00:00, 311.96it/s]"}}, "cf74ebfa91cd4b33930c963877aabf2c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6b0387b3936e4511917a45fac34215e1": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_85e9e6ba956941358e6eb339a7b1a52f", "IPY_MODEL_46bb7da44f464a15926447ca877d85b7", "IPY_MODEL_f5668126805e49b78cc8a7606f74b696"], "layout": "IPY_MODEL_cf74ebfa91cd4b33930c963877aabf2c"}}, "43a296a0721940c5b7d22eb34d940c04": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "20px"}}, "7c92ebd5cb9b4cafa16f539d6e173c77": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "1f3392b142f4406c89416e111723a696": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_43a296a0721940c5b7d22eb34d940c04", "max": 1.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_7c92ebd5cb9b4cafa16f539d6e173c77", "value": 1.0}}, "17274fac7eb04aa0b75b585d27dfa9ac": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "42c3ccc33ebc417f8770137387aafeb7": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "114ef1d71e264ab7a1ba4ef67038def0": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_17274fac7eb04aa0b75b585d27dfa9ac", "placeholder": "\u200b", "style": "IPY_MODEL_42c3ccc33ebc417f8770137387aafeb7", "value": "Generating train split: "}}, "15f74254ea2c454d8f6846e63960135e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d3b7cff1b9e4ff1876ce80f8a887e68": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "bf868a32f5d645148233b4bf1ed8bbb2": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_15f74254ea2c454d8f6846e63960135e", "placeholder": "\u200b", "style": "IPY_MODEL_4d3b7cff1b9e4ff1876ce80f8a887e68", "value": " 60000/0 [00:00&lt;00:00, 973574.27 examples/s]"}}, "5824aac9c8954a238bf74754f2398630": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "86a310889e704d9b9b3913233080a7fe": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_114ef1d71e264ab7a1ba4ef67038def0", "IPY_MODEL_1f3392b142f4406c89416e111723a696", "IPY_MODEL_bf868a32f5d645148233b4bf1ed8bbb2"], "layout": "IPY_MODEL_5824aac9c8954a238bf74754f2398630"}}, "33e2700698ac4c3faffa04104b4cabc6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "20px"}}, "ea43a2c5244343acb5c3999251e05660": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "4d46a3dc5a8c43d5a1eef0f625e44ed6": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_33e2700698ac4c3faffa04104b4cabc6", "max": 1.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_ea43a2c5244343acb5c3999251e05660", "value": 1.0}}, "160b4c6e4e0a4d4bbb6030701efed1e8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d5d41c2be334ebc81625da820976f01": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "e91f4769339942a5933d03864ec554bd": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_160b4c6e4e0a4d4bbb6030701efed1e8", "placeholder": "\u200b", "style": "IPY_MODEL_8d5d41c2be334ebc81625da820976f01", "value": "Generating test split: "}}, "f49891a0831c4dcf83666461f8117ef9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "24f5bf6987b54350b22e1027fdfb7e83": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "45cd5d48bf354266a3ec464e5bc4baa9": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_f49891a0831c4dcf83666461f8117ef9", "placeholder": "\u200b", "style": "IPY_MODEL_24f5bf6987b54350b22e1027fdfb7e83", "value": " 10000/0 [00:00&lt;00:00, 462738.05 examples/s]"}}, "e4f7c52a7ee448b787f1042663ee4ea5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a6edecaba4a24772b01ccf7c6d7b5316": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_e91f4769339942a5933d03864ec554bd", "IPY_MODEL_4d46a3dc5a8c43d5a1eef0f625e44ed6", "IPY_MODEL_45cd5d48bf354266a3ec464e5bc4baa9"], "layout": "IPY_MODEL_e4f7c52a7ee448b787f1042663ee4ea5"}}, "cd1fd56c44ac41d6a7f3117090f29309": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a6bd778b5e2e4864a173ed1eb70e3536": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "0568c9d8ab4f4f2ab33a9d814442d8bd": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_cd1fd56c44ac41d6a7f3117090f29309", "max": 60000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_a6bd778b5e2e4864a173ed1eb70e3536", "value": 60000.0}}, "574ddd57cb504f35921b9ec912895a62": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c95c362ea4cb458b8ccb1c2b5d6f4cab": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "d978e2eeca9342c08658072315f7159a": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_574ddd57cb504f35921b9ec912895a62", "placeholder": "\u200b", "style": "IPY_MODEL_c95c362ea4cb458b8ccb1c2b5d6f4cab", "value": "Map (num_proc=4): 100%"}}, "ff4ada78260546f4a1c587793ba593b4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "25b51166eb7b409db68e3ad6c195feab": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "ff32495113104e15ade6f4b56b2963a5": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_ff4ada78260546f4a1c587793ba593b4", "placeholder": "\u200b", "style": "IPY_MODEL_25b51166eb7b409db68e3ad6c195feab", "value": " 60000/60000 [00:11&lt;00:00, 7119.94 examples/s]"}}, "4afa4986b455488bba91dc7583b35e3e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5027eafb00b345138871357852dc200f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d978e2eeca9342c08658072315f7159a", "IPY_MODEL_0568c9d8ab4f4f2ab33a9d814442d8bd", "IPY_MODEL_ff32495113104e15ade6f4b56b2963a5"], "layout": "IPY_MODEL_4afa4986b455488bba91dc7583b35e3e"}}, "2a02364968b64a6fa71668ec43f11a3b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "528317fd0a294bc9bb31b204cf05f75f": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "e155e2d1374148ffb0445079e98ab8c6": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_2a02364968b64a6fa71668ec43f11a3b", "max": 60000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_528317fd0a294bc9bb31b204cf05f75f", "value": 60000.0}}, "28227f6abc1d4f93aee5267679af0222": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8ca06cf3660d4b81b33a50ad3f86698e": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "0d54fde9aee54a7b8f7929b3f6ae3e33": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_28227f6abc1d4f93aee5267679af0222", "placeholder": "\u200b", "style": "IPY_MODEL_8ca06cf3660d4b81b33a50ad3f86698e", "value": "100%"}}, "eb5788b041844ebb8dda0156a9876b36": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a63c0818036c49369fd17b11f48766b4": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "e78bbdf53fa9451196d5b69296b3930a": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_eb5788b041844ebb8dda0156a9876b36", "placeholder": "\u200b", "style": "IPY_MODEL_a63c0818036c49369fd17b11f48766b4", "value": " 60000/60000 [00:34&lt;00:00, 1747.73it/s]"}}, "e0a1bfd36158480b80789954a0b5d8cc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e08ceedeea77417695ed56bd0f74a6ce": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_0d54fde9aee54a7b8f7929b3f6ae3e33", "IPY_MODEL_e155e2d1374148ffb0445079e98ab8c6", "IPY_MODEL_e78bbdf53fa9451196d5b69296b3930a"], "layout": "IPY_MODEL_e0a1bfd36158480b80789954a0b5d8cc"}}}, "version_major": 2, "version_minor": 0}
</script></section>
</section>
</section>
 
        </article>
      </div>
      <footer>
         
        <div class="related-pages">
          <a class="next-page" href="text.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Text Classification with Noisy Labels</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="indepth_overview.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">The Workflows of Data-centric AI for Classification with Noisy Labels</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Cleanlab Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/cleanlab/cleanlab" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        

<script type="text/javascript">
    window.addEventListener("load", () => {
        let elements = document.getElementsByClassName("left-details");

        elements[0].insertAdjacentHTML(
            "afterbegin",
            `<code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> is distributed on <a href="https://pypi.org/project/cleanlab/">PyPI</a> and <a href="https://anaconda.org/conda-forge/cleanlab">conda</a>.`
        );
    });
</script>


      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Image Classification with PyTorch and Cleanlab</a><ul>
<li><a class="reference internal" href="#1.-Install-and-import-required-dependencies">1. Install and import required dependencies</a></li>
<li><a class="reference internal" href="#2.-Fetch-and-normalize-the-Fashion-MNIST-dataset">2. Fetch and normalize the Fashion-MNIST dataset</a></li>
<li><a class="reference internal" href="#3.-Define-a-classification-model">3. Define a classification model</a></li>
<li><a class="reference internal" href="#4.-Prepare-the-dataset-for-K-fold-cross-validation">4. Prepare the dataset for K-fold cross-validation</a></li>
<li><a class="reference internal" href="#5.-Compute-out-of-sample-predicted-probabilities-and-feature-embeddings">5. Compute out-of-sample predicted probabilities and feature embeddings</a></li>
<li><a class="reference internal" href="#7.-Use-cleanlab-to-find-issues">7. Use cleanlab to find issues</a><ul>
<li><a class="reference internal" href="#View-report">View report</a></li>
<li><a class="reference internal" href="#Label-issues">Label issues</a><ul>
<li><a class="reference internal" href="#View-most-likely-examples-with-label-errors">View most likely examples with label errors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Outlier-issues">Outlier issues</a><ul>
<li><a class="reference internal" href="#View-most-severe-outliers">View most severe outliers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Near-duplicate-issues">Near duplicate issues</a><ul>
<li><a class="reference internal" href="#View-sets-of-near-duplicate-images">View sets of near duplicate images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Dark-images">Dark images</a><ul>
<li><a class="reference internal" href="#View-top-examples-of-dark-images">View top examples of dark images</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Low-information-images">Low information images</a></li>
<li><a class="reference internal" href="#Easy-Mode">Easy Mode</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    
<script async defer src="https://buttons.github.io/buttons.js"></script>
</body>
</html>