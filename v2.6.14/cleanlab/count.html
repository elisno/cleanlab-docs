<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

        <script async src="https://www.googletagmanager.com/gtag/js?id=G-EV8RVEFX82"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-EV8RVEFX82');
            
        </script>
    <meta property="og:title" content="count" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.cleanlab.ai/stable/cleanlab/count.html" />
<meta property="og:site_name" content="cleanlab" />
<meta property="og:description" content="Methods to estimate latent structures used for confident learning, including: Latent prior of the unobserved, error-less labels: py: p(y), Latent noisy channel (noise matrix) characterizing the fli..." />
<meta property="og:image" content="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/clos-preview-card.png" />
<meta property="og:image:alt" content="cleanlab" />
<meta name="description" content="Methods to estimate latent structures used for confident learning, including: Latent prior of the unobserved, error-less labels: py: p(y), Latent noisy channel (noise matrix) characterizing the fli..." />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="dataset" href="dataset.html" /><link rel="prev" title="rank" href="rank.html" />

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/cleanlab/assets/a4483476d449f2f05a4c7cde329e72358099cc07/cleanlab/cleanlab_favicon.svg"/><!-- Generated with Sphinx 7.1.2 and Furo 2023.09.10 -->
        <title>count - cleanlab</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=96bccb3e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">cleanlab</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a style="padding-bottom: 0px;" class="sidebar-brand" href="../index.html">
    
    <div class="sidebar-logo-container">
        <img class="sidebar-logo" src="https://raw.githubusercontent.com/cleanlab/assets/master/cleanlab/cleanlab_logo_only.png" alt="Logo" />
    </div>
    
    <span style="margin-bottom:0px" class="sidebar-brand-text">
        cleanlab
    </span>
    
</a>

<div class="centered">
    <a style="margin-top: 6px;" class="github-button" href="https://github.com/cleanlab/cleanlab" data-size="large" data-show-count="true"
    aria-label="Star cleanlab/cleanlab on GitHub">Star</a>
</div>
<form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Quickstart</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/datalab/index.html">Datalab Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Datalab Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/datalab/datalab_quickstart.html">Detecting Common Data Issues with Datalab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/datalab/datalab_advanced.html">Advanced Data Auditing with Datalab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/datalab/text.html">Text Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/datalab/tabular.html">Tabular Data (Numeric/Categorical)</a></li>
<li class="toctree-l2"><a class="reference internal" href="datalab/guide/issue_type_description.html">Guide to Datalab Issue Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/indepth_overview.html">Workflows of Data-Centric AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/image.html">Image Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/text.html">Text Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tabular.html">Tabular Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/audio.html">Audio Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/dataset_health.html">Find Dataset-level Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/outliers.html">Identifying Outliers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multiannotator.html">Improving Consensus Labels for Multiannotator Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/multilabel_classification.html">Multi-Label Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/regression.html">Noisy Labels in Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/token_classification.html">Token Classification (text)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/segmentation.html">Image Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/object_detection.html">Object Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/pred_probs_cross_val.html">Predicted Probabilities via Cross Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="datalab/index.html">datalab</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of datalab</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="datalab/guide/index.html">Datalab guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Datalab guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="datalab/guide/issue_type_description.html">Datalab Issue Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="datalab/guide/custom_issue_manager.html">Creating Your Own Issues Manager</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="datalab/datalab.html">datalab</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="datalab/internal/index.html">internal</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of internal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="datalab/internal/data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="datalab/internal/data_issues.html">data_issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="datalab/internal/issue_finder.html">issue_finder</a></li>
<li class="toctree-l3"><a class="reference internal" href="datalab/internal/factory.html">factory</a></li>
<li class="toctree-l3"><a class="reference internal" href="datalab/internal/model_outputs.html">model_outputs</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="datalab/internal/issue_manager/index.html">issue_manager</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of issue_manager</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/issue_manager.html">Base issue_manager module</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/label.html">label</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/outlier.html">outlier</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/duplicate.html">duplicate</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/noniid.html">noniid</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/imbalance.html">imbalance</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/underperforming_group.html">underperforming_group</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/null.html">null</a></li>
<li class="toctree-l4"><a class="reference internal" href="datalab/internal/issue_manager/data_valuation.html">data_valuation</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="datalab/internal/issue_manager/regression/index.html">regression</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of regression</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="datalab/internal/issue_manager/regression/label.html">label</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="datalab/internal/issue_manager/multilabel/index.html">multilabel</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of multilabel</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="datalab/internal/issue_manager/multilabel/label.html">label</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="datalab/internal/report.html">report</a></li>
<li class="toctree-l3"><a class="reference internal" href="datalab/internal/task.html">task</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="classification.html">classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter.html">filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="rank.html">rank</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">count</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="outlier.html">outlier</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiannotator.html">multiannotator</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="multilabel_classification/index.html">multilabel_classification</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of multilabel_classification</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="multilabel_classification/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="multilabel_classification/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="multilabel_classification/dataset.html">dataset</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="regression/index.html">regression</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of regression</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="regression/rank.html">regression.rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="regression/learn.html">regression.learn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="token_classification/index.html">token_classification</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of token_classification</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="token_classification/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="token_classification/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="token_classification/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="segmentation/index.html">segmentation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of segmentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="segmentation/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="segmentation/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="object_detection/index.html">object_detection</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of object_detection</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="object_detection/rank.html">rank</a></li>
<li class="toctree-l2"><a class="reference internal" href="object_detection/filter.html">filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="object_detection/summary.html">summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="benchmarking/index.html">benchmarking</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of benchmarking</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="benchmarking/noise_generation.html">noise_generation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="models/index.html">models</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="models/keras.html">keras</a></li>
<li class="toctree-l2"><a class="reference internal" href="models/fasttext.html">fasttext</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="experimental/index.html">experimental</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of experimental</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="experimental/label_issues_batched.html">label_issues_batched</a></li>
<li class="toctree-l2"><a class="reference internal" href="experimental/span_classification.html">span_classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="experimental/mnist_pytorch.html">mnist_pytorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="experimental/coteaching.html">coteaching</a></li>
<li class="toctree-l2"><a class="reference internal" href="experimental/cifar_cnn.html">cifar_cnn</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="internal/index.html">internal</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of internal</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="internal/util.html">util</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/latent_algebra.html">latent_algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/label_quality_utils.html">label_quality_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/multilabel_utils.html">multilabel_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/multilabel_scorer.html">multilabel_scorer</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/outlier.html">outlier</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/token_classification_utils.html">token_classification_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal/validation.html">validation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="datalab/guide/index.html">Datalab issue types</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Datalab issue types</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="datalab/guide/issue_type_description.html">Datalab Issue Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="datalab/guide/custom_issue_manager.html">Creating Your Own Issues Manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/cleanlab/cleanlab/blob/master/CONTRIBUTING.md">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai">Website</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/cleanlab/cleanlab">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/cleanlab/">PyPI</a></li>
<li class="toctree-l1"><a class="reference external" href="https://anaconda.org/Cleanlab/cleanlab">Conda</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cleanlab.ai/blog/data-centric-ai/">Cleanlab Studio (Easy Mode)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://help.cleanlab.ai">Cleanlab Studio Docs</a></li>
</ul>

</div>


<!-- Start of versioning -->

<div class="sidebar-tree">
    <p class="caption" role="heading">
        <span class="caption-text">Versions</span>
    </p>
    <ul>
        <li class="toctree-l1">
            <a
                id="version_number"
                class="reference internal"
                href="/cleanlab-docs/"
                >stable</a
            >
        </li>
        <li class="toctree-l1">
            <a
                id="commit_hash"
                class="reference internal"
                href="/cleanlab-docs/master/"
                >developer</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.6.0"
                class="reference internal"
                href="/cleanlab-docs/v2.6.0/"
                >v2.6.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.5.0"
                class="reference internal"
                href="/cleanlab-docs/v2.5.0/"
                >v2.5.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.4.0"
                class="reference internal"
                href="/cleanlab-docs/v2.4.0/"
                >v2.4.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.3.1"
                class="reference internal"
                href="/cleanlab-docs/v2.3.1/"
                >v2.3.1</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.3.0"
                class="reference internal"
                href="/cleanlab-docs/v2.3.0/"
                >v2.3.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.2.0"
                class="reference internal"
                href="/cleanlab-docs/v2.2.0/"
                >v2.2.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.1.0"
                class="reference internal"
                href="/cleanlab-docs/v2.1.0/"
                >v2.1.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v2.0.0"
                class="reference internal"
                href="/cleanlab-docs/v2.0.0/"
                >v2.0.0</a
            >
        </li>
        
        <li class="toctree-l1">
            <a
                id="v1.0.1"
                class="reference internal"
                href="/cleanlab-docs/v1.0.1/"
                >v1.0.1</a
            >
        </li>
        
    </ul>
</div>

<br>
<br>

<script
    type="text/javascript"
    src="/cleanlab-docs/versioning.js"
></script>

<script type="text/javascript">
    window.addEventListener("load", () => {
        const version_number = Version.version_number;
        const commit_hash = Version.commit_hash;

        document.getElementById("version_number").innerHTML =
            "stable <code class='docutils literal notranslate'><span class='pre'> (" +
            version_number +
            ")</span></code>";
        document.getElementById("commit_hash").innerHTML =
            "master <code class='docutils literal notranslate'><span class='pre'> (" +
            commit_hash.slice(0, 7) +
            "&hellip;)</span></code>";
    });
</script>

<!-- End of versioning -->

</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          

<noscript>
  <div class="admonition warning">
    <p class="admonition-title">Warning</p>
    <p>Parts of this site uses JavaScript, but your browser does not support it.</p>
  </div>
</noscript>



<!-- Start of Version Warning Banner -->

<p id="doc_ver_warning"></p>

<script
    type="text/javascript"
    src="/cleanlab-docs/versioning.js"
></script>
<script type="text/javascript">
    window.addEventListener("load", () => {
        const version_number = Version.version_number;
        const path_arr = window.location.pathname.split("/");

        if (path_arr.includes("master")) {
            document.getElementById("doc_ver_warning").innerHTML =
            `<div class="admonition warning">
            <p class="admonition-title">Warning</p>
            <p>This version of the documentation corresponds to the master branch of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> source code from <a href="https://github.com/cleanlab/cleanlab/">GitHub</a>. To see the documentation for the latest <code class="docutils literal notranslate"><span class="pre">pip</span></code>-installed version, click <a href="/cleanlab-docs/">here</a>.</p>
            </div>`;
        } else if (!path_arr.includes(version_number) && !path_arr.includes("stable")) {
            document.getElementById("doc_ver_warning").innerHTML =
            `<div class="admonition warning">
            <p class="admonition-title">Warning</p>
            <p>This documentation is for an old version (<code class="docutils literal notranslate"><span class="pre">v2.6.14</span></code>) of <code class="docutils literal notranslate"><span class="pre">cleanlab</span></code>. To see the documentation for the latest stable version (<code class="docutils literal notranslate"><span class="pre">` + version_number + `</span></code>), click <a href="/cleanlab-docs/">here</a>.</p>
            </div>`;
        } else {
            document.getElementById("doc_ver_warning").remove();
        }
    });
</script>

<!-- End of Version Warning Banner -->

 <section id="module-cleanlab.count">
<span id="count"></span><h1>count<a class="headerlink" href="#module-cleanlab.count" title="Permalink to this heading">#</a></h1>
<p>Methods to estimate latent structures used for confident learning, including:</p>
<ul class="simple">
<li><p>Latent prior of the unobserved, error-less labels: <code class="xref py py-obj docutils literal notranslate"><span class="pre">py</span></code>: <code class="docutils literal notranslate"><span class="pre">p(y)</span></code></p></li>
<li><p>Latent noisy channel (noise matrix) characterizing the flipping rates: <code class="xref py py-obj docutils literal notranslate"><span class="pre">nm</span></code>: <code class="docutils literal notranslate"><span class="pre">P(given</span> <span class="pre">label</span> <span class="pre">|</span> <span class="pre">true</span> <span class="pre">label)</span></code></p></li>
<li><p>Latent inverse noise matrix characterizing the flipping process: <code class="xref py py-obj docutils literal notranslate"><span class="pre">inv</span></code>: <code class="docutils literal notranslate"><span class="pre">P(true</span> <span class="pre">label</span> <span class="pre">|</span> <span class="pre">given</span> <span class="pre">label)</span></code></p></li>
<li><p>Latent <code class="xref py py-obj docutils literal notranslate"><span class="pre">confident_joint</span></code>, an un-normalized matrix that counts the confident subset of label errors under the joint distribution for true/given label</p></li>
</ul>
<p>These are estimated from a classification dataset. This module considers two types of datasets:</p>
<ul class="simple">
<li><p>standard (multi-class) classification where each example is labeled as belonging to exactly one of K classes (e.g. <code class="docutils literal notranslate"><span class="pre">labels</span> <span class="pre">=</span> <span class="pre">np.array([0,0,1,0,2,1])</span></code>)</p></li>
<li><p>multi-label classification where each example can be labeled as belonging to multiple classes (e.g. <code class="docutils literal notranslate"><span class="pre">labels</span> <span class="pre">=</span> <span class="pre">[[1,2],[1],[0],[],...]</span></code>)</p></li>
</ul>
<p><strong>Functions:</strong></p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.count.num_label_issues" title="cleanlab.count.num_label_issues"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_label_issues</span></code></a>(labels, pred_probs, *[, ...])</p></td>
<td><p>Estimates the number of label issues in a classification dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.count.calibrate_confident_joint" title="cleanlab.count.calibrate_confident_joint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calibrate_confident_joint</span></code></a>(confident_joint, ...)</p></td>
<td><p>Calibrates any confident joint estimate <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> such that <code class="docutils literal notranslate"><span class="pre">np.sum(cj)</span> <span class="pre">==</span> <span class="pre">len(labels)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.sum(cj,</span> <span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">==</span> <span class="pre">np.bincount(labels)</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.count.estimate_joint" title="cleanlab.count.estimate_joint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_joint</span></code></a>(labels, pred_probs, *[, ...])</p></td>
<td><p>Estimates the joint distribution of label noise <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> guaranteed to:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.count.compute_confident_joint" title="cleanlab.count.compute_confident_joint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_confident_joint</span></code></a>(labels, pred_probs, *)</p></td>
<td><p>Estimates the confident counts of latent true vs observed noisy labels for the examples in our dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.count.estimate_latent" title="cleanlab.count.estimate_latent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_latent</span></code></a>(confident_joint, labels, *)</p></td>
<td><p>Computes the latent prior <code class="docutils literal notranslate"><span class="pre">p(y)</span></code>, the noise matrix <code class="docutils literal notranslate"><span class="pre">P(labels|y)</span></code> and the inverse noise matrix <code class="docutils literal notranslate"><span class="pre">P(y|labels)</span></code> from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">confident_joint</span></code> <code class="docutils literal notranslate"><span class="pre">count(labels,</span> <span class="pre">y)</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.count.estimate_py_and_noise_matrices_from_probabilities" title="cleanlab.count.estimate_py_and_noise_matrices_from_probabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_py_and_noise_matrices_from_probabilities</span></code></a>(...)</p></td>
<td><p>Computes the confident counts estimate of latent variables <code class="xref py py-obj docutils literal notranslate"><span class="pre">py</span></code> and the noise rates using observed labels and predicted probabilities, <code class="xref py py-obj docutils literal notranslate"><span class="pre">pred_probs</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.count.estimate_confident_joint_and_cv_pred_proba" title="cleanlab.count.estimate_confident_joint_and_cv_pred_proba"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_confident_joint_and_cv_pred_proba</span></code></a>(X, ...)</p></td>
<td><p>Estimates <code class="docutils literal notranslate"><span class="pre">P(labels,</span> <span class="pre">y)</span></code>, the confident counts of the latent joint distribution of true and noisy labels using observed <code class="xref py py-obj docutils literal notranslate"><span class="pre">labels</span></code> and predicted probabilities <code class="xref py py-obj docutils literal notranslate"><span class="pre">pred_probs</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.count.estimate_py_noise_matrices_and_cv_pred_proba" title="cleanlab.count.estimate_py_noise_matrices_and_cv_pred_proba"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_py_noise_matrices_and_cv_pred_proba</span></code></a>(X, ...)</p></td>
<td><p>This function computes the out-of-sample predicted probability <code class="docutils literal notranslate"><span class="pre">P(label=k|x)</span></code> for every example x in <code class="xref py py-obj docutils literal notranslate"><span class="pre">X</span></code> using cross validation while also computing the confident counts noise rates within each cross-validated subset and returning the average noise rate across all examples.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.count.estimate_cv_predicted_probabilities" title="cleanlab.count.estimate_cv_predicted_probabilities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_cv_predicted_probabilities</span></code></a>(X, labels)</p></td>
<td><p>This function computes the out-of-sample predicted probability [P(label=k|x)] for every example in X using cross validation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cleanlab.count.estimate_noise_matrices" title="cleanlab.count.estimate_noise_matrices"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_noise_matrices</span></code></a>(X, labels[, clf, ...])</p></td>
<td><p>Estimates the <code class="xref py py-obj docutils literal notranslate"><span class="pre">noise_matrix</span></code> of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cleanlab.count.get_confident_thresholds" title="cleanlab.count.get_confident_thresholds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_confident_thresholds</span></code></a>(labels, pred_probs)</p></td>
<td><p>Returns expected (average) &quot;self-confidence&quot; for each class.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.num_label_issues">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">num_label_issues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_probs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confident_joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimation_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'off_diagonal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#num_label_issues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.num_label_issues" title="Permalink to this definition">#</a></dt>
<dd><p>Estimates the number of label issues in a classification dataset. Use this method to get the most accurate
estimate of number of label issues when you don’t need the indices of the examples with label issues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – Given class labels for each example in the dataset, some of which may be erroneous,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>pred_probs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span>) – Model-predicted class probabilities for each example in the dataset,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>confident_joint</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – Array of estimated class label error statisics used for identifying label issues,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.
The <cite>confident_joint</cite> can be computed using <cite>~cleanlab.count.compute_confident_joint</cite>.
It is internally computed from the given (noisy) <cite>labels</cite> and <cite>pred_probs</cite>.</p></li>
<li><p><strong>estimation_method</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – <p>Method for estimating the number of label issues in dataset by counting the examples in the off-diagonal of the <cite>confident_joint</cite> <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'off_diagonal'</span></code>: Counts the number of examples in the off-diagonal of the <cite>confident_joint</cite>. Returns the same value as <code class="docutils literal notranslate"><span class="pre">sum(find_label_issues(filter_by='confident_learning'))</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'off_diagonal_calibrated'</span></code>: Calibrates confident joint estimate <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">np.sum(cj)</span> <span class="pre">==</span> <span class="pre">len(labels)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.sum(cj,</span> <span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">==</span> <span class="pre">np.bincount(labels)</span></code> before counting the number
of examples in the off-diagonal. Number will always be equal to or greater than
<code class="docutils literal notranslate"><span class="pre">estimate_issues='off_diagonal'</span></code>. You can use this value as the cutoff threshold used with ranking/scoring
functions from <a class="reference internal" href="rank.html#module-cleanlab.rank" title="cleanlab.rank"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cleanlab.rank</span></code></a> with <cite>num_label_issues</cite> over <code class="docutils literal notranslate"><span class="pre">estimation_method='off_diagonal'</span></code> in
two cases:</p>
<ol class="arabic simple">
<li><p>As we add more label and data quality scoring functions in <a class="reference internal" href="rank.html#module-cleanlab.rank" title="cleanlab.rank"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cleanlab.rank</span></code></a>, this approach will always work.</p></li>
<li><p>If you have a custom score to rank your data by label quality and you just need to know the cut-off of likely label issues.</p></li>
</ol>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">'off_diagonal_custom'</span></code>: Counts the number of examples in the off-diagonal of a provided <cite>confident_joint</cite> matrix.</p></li>
</ul>
<p>TL;DR: Use this method to get the most accurate estimate of number of label issues when you don’t need the indices of the label issues.</p>
<p>Note: <code class="docutils literal notranslate"><span class="pre">'off_diagonal'</span></code> may sometimes underestimate issues for data with few classes, so consider using <code class="docutils literal notranslate"><span class="pre">'off_diagonal_calibrated'</span></code> instead if your data has &lt; 4 classes.</p>
</p></li>
<li><p><strong>multi_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – Set <code class="docutils literal notranslate"><span class="pre">False</span></code> if your dataset is for regular (multi-class) classification, where each example belongs to exactly one class.
Set <code class="docutils literal notranslate"><span class="pre">True</span></code> if your dataset is for multi-label classification, where each example can belong to multiple classes.
See documentation of <cite>~cleanlab.count.compute_confident_joint</cite> for details.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">num_issues</span></code> – The estimated number of examples with label issues in the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.calibrate_confident_joint">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">calibrate_confident_joint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confident_joint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#calibrate_confident_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.calibrate_confident_joint" title="Permalink to this definition">#</a></dt>
<dd><p>Calibrates any confident joint estimate <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">np.sum(cj)</span> <span class="pre">==</span> <span class="pre">len(labels)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.sum(cj,</span> <span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">==</span> <span class="pre">np.bincount(labels)</span></code>.</p>
<p>In other words, this function forces the confident joint to have the
true noisy prior <code class="docutils literal notranslate"><span class="pre">p(labels)</span></code> (summed over columns for each row) and also
forces the confident joint to add up to the total number of examples.</p>
<p>This method makes the confident joint a valid counts estimate
of the actual joint of noisy and true labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confident_joint</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code> representing the confident joint, the matrix used for identifying label issues, which
estimates a confident subset of the joint distribution of the noisy and true labels, <code class="docutils literal notranslate"><span class="pre">P_{noisy</span> <span class="pre">label,</span> <span class="pre">true</span> <span class="pre">label}</span></code>.
Entry <code class="docutils literal notranslate"><span class="pre">(j,</span> <span class="pre">k)</span></code> in the matrix is the number of examples confidently counted into the pair of <code class="docutils literal notranslate"><span class="pre">(noisy</span> <span class="pre">label=j,</span> <span class="pre">true</span> <span class="pre">label=k)</span></code> classes.
The <cite>confident_joint</cite> can be computed using <cite>~cleanlab.count.compute_confident_joint</cite>.
If not provided, it is computed from the given (noisy) <cite>labels</cite> and <cite>pred_probs</cite>.
If <cite>multi_label</cite> is True, then the <cite>confident_joint</cite> should be a one-vs-rest array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">2,</span> <span class="pre">2)</span></code>, and an array of the same shape will be returned.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – Given class labels for each example in the dataset, some of which may be erroneous,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>multi_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, dataset is for regular (multi-class) classification, where each example belongs to exactly one class.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, dataset is for multi-label classification, where each example can belong to multiple classes.
See documentation of <cite>~cleanlab.count.compute_confident_joint</cite> for details.
In multi-label classification, the confident/calibrated joint arrays have shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">2,</span> <span class="pre">2)</span></code>
formatted in a one-vs-rest fashion such that they contain a 2x2 matrix for each class
that counts examples which are correctly/incorrectly labeled as belonging to that class.
After calibration, the entries in each class-specific 2x2 matrix will sum to the number of examples.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>calibrated_cj</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code> representing a valid estimate of the joint <em>counts</em> of noisy and true labels (if <cite>multi_label</cite> is False).
If <cite>multi_label</cite> is True, the returned <cite>calibrated_cj</cite> is instead an one-vs-rest array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">2,</span> <span class="pre">2)</span></code>,
where for class <cite>c</cite>: entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">0,</span> <span class="pre">0)</span></code> in this one-vs-rest  array is the number of examples whose noisy label contains <cite>c</cite> confidently identified as truly belonging to class <cite>c</cite> as well.
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">1,</span> <span class="pre">0)</span></code> in this one-vs-rest  array is the number of examples whose noisy label contains <cite>c</cite> confidently identified as not actually belonging to class <cite>c</cite>.
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">0,</span> <span class="pre">1)</span></code> in this one-vs-rest array is the number of examples whose noisy label does not contain <cite>c</cite> confidently identified as truly belonging to class <cite>c</cite>.
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">1,</span> <span class="pre">1)</span></code> in this one-vs-rest array is the number of examples whose noisy label does not contain <cite>c</cite> confidently identified as actually not belonging to class <cite>c</cite> as well.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.estimate_joint">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">estimate_joint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_probs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confident_joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#estimate_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.estimate_joint" title="Permalink to this definition">#</a></dt>
<dd><p>Estimates the joint distribution of label noise <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> guaranteed to:</p>
<ul class="simple">
<li><p>Sum to 1</p></li>
<li><p>Satisfy <code class="docutils literal notranslate"><span class="pre">np.sum(joint_estimate,</span> <span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">==</span> <span class="pre">p(labels)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – Given class labels for each example in the dataset, some of which may be erroneous,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>pred_probs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Model-predicted class probabilities for each example in the dataset,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>confident_joint</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <em>optional</em>) – Array of estimated class label error statisics used for identifying label issues,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.
The <cite>confident_joint</cite> can be computed using <cite>~cleanlab.count.compute_confident_joint</cite>.
If not provided, it is internally computed from the given (noisy) <cite>labels</cite> and <cite>pred_probs</cite>.</p></li>
<li><p><strong>multi_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">False</span></code>, dataset is for regular (multi-class) classification, where each example belongs to exactly one class.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, dataset is for multi-label classification, where each example can belong to multiple classes.
See documentation of <cite>~cleanlab.count.compute_confident_joint</cite> for details.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>confident_joint_distribution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code> representing an
estimate of the true joint distribution of noisy and true labels (if <cite>multi_label</cite> is False).
If <cite>multi_label</cite> is True, an array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">2,</span> <span class="pre">2)</span></code> representing an
estimate of the true joint distribution of noisy and true labels for each class in a one-vs-rest fashion.
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">i,</span> <span class="pre">j)</span></code> in this array is the number of examples confidently counted into a <code class="docutils literal notranslate"><span class="pre">(class</span> <span class="pre">c,</span> <span class="pre">noisy</span> <span class="pre">label=i,</span> <span class="pre">true</span> <span class="pre">label=j)</span></code> bin,
where <cite>i, j</cite> are either 0 or 1 to denote whether this example belongs to class <cite>c</cite> or not
(recall examples can belong to multiple classes in multi-label classification).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.compute_confident_joint">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">compute_confident_joint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_probs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices_of_off_diagonals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#compute_confident_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.compute_confident_joint" title="Permalink to this definition">#</a></dt>
<dd><p>Estimates the confident counts of latent true vs observed noisy labels
for the examples in our dataset. This array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code> is called the <strong>confident joint</strong>
and contains counts of examples in every class, confidently labeled as every other class.
These counts may subsequently be used to estimate the joint distribution of true and noisy labels
(by normalizing them to frequencies).</p>
<p>Important: this function assumes that <cite>pred_probs</cite> are out-of-sample
holdout probabilities. This can be <a class="reference internal" href="../tutorials/pred_probs_cross_val.html#pred-probs-cross-val"><span class="std std-ref">done with cross validation</span></a>. If
the probabilities are not computed out-of-sample, overfitting may occur.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – Given class labels for each example in the dataset, some of which may be erroneous,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>pred_probs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Model-predicted class probabilities for each example in the dataset,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>thresholds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – <p>An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">1)</span></code> or <code class="docutils literal notranslate"><span class="pre">(K,)</span></code> of per-class threshold
probabilities, used to determine the cutoff probability necessary to
consider an example as a given class label (see <a class="reference external" href="https://jair.org/index.php/jair/article/view/12125">Northcutt et al.,
2021</a>, Section
3.1, Equation 2).</p>
<p>This is for advanced users only. If not specified, these are computed
for you automatically. If an example has a predicted probability
greater than this threshold, it is counted as having true_label =
k. This is not used for pruning/filtering, only for estimating the
noise rates using confident counts.</p>
</p></li>
<li><p><strong>calibrate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>default</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>) – Calibrates confident joint estimate <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">np.sum(cj)</span> <span class="pre">==</span> <span class="pre">len(labels)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.sum(cj,</span> <span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">==</span> <span class="pre">np.bincount(labels)</span></code>.
When <code class="docutils literal notranslate"><span class="pre">calibrate=True</span></code>, this method returns an estimate of
the latent true joint counts of noisy and true labels.</p></li>
<li><p><strong>multi_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this is multi-label classification dataset (where each example can belong to more than one class)
rather than a regular (multi-class) classifiction dataset.
In this case, <cite>labels</cite> should be an iterable (e.g. list) of iterables (e.g. <code class="docutils literal notranslate"><span class="pre">List[List[int]]</span></code>),
containing the list of classes to which each example belongs, instead of just a single class.
Example of <cite>labels</cite> for a multi-label classification dataset: <code class="docutils literal notranslate"><span class="pre">[[0,1],</span> <span class="pre">[1],</span> <span class="pre">[0,2],</span> <span class="pre">[0,1,2],</span> <span class="pre">[0],</span> <span class="pre">[1],</span> <span class="pre">[],</span> <span class="pre">...]</span></code>.</p></li>
<li><p><strong>return_indices_of_off_diagonals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, returns indices of examples that were counted in off-diagonals
of confident joint as a baseline proxy for the label issues. This
sometimes works as well as <code class="docutils literal notranslate"><span class="pre">filter.find_label_issues(confident_joint)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt><strong>confident_joint_counts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code> representing counts of examples</dt><dd><p>for which we are confident about their given and true label (if <cite>multi_label</cite> is False).
If <cite>multi_label</cite> is True,
this array instead has shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">2,</span> <span class="pre">2)</span></code> representing a one-vs-rest format for the  confident joint, where for each class <cite>c</cite>:
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">0,</span> <span class="pre">0)</span></code> in this one-vs-rest array is the number of examples whose noisy label contains <cite>c</cite> confidently identified as truly belonging to class <cite>c</cite> as well.
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">1,</span> <span class="pre">0)</span></code> in this one-vs-rest array is the number of examples whose noisy label contains <cite>c</cite> confidently identified as not actually belonging to class <cite>c</cite>.
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">0,</span> <span class="pre">1)</span></code> in this one-vs-rest array is the number of examples whose noisy label does not contain <cite>c</cite> confidently identified as truly belonging to class <cite>c</cite>.
Entry <code class="docutils literal notranslate"><span class="pre">(c,</span> <span class="pre">1,</span> <span class="pre">1)</span></code> in this one-vs-rest array is the number of examples whose noisy label does not contain <cite>c</cite> confidently identified as actually not belonging to class <cite>c</cite> as well.</p>
</dd>
</dl>
<p>If <cite>return_indices_of_off_diagonals</cite> is set as True, this function instead returns a tuple <cite>(confident_joint, indices_off_diagonal)</cite>
where <cite>indices_off_diagonal</cite> is a list of arrays and each array contains the indices of examples counted in off-diagonals of confident joint.</p>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We provide a for-loop based simplification of the confident joint
below. This implementation is not efficient, not used in practice, and
not complete, but covers the gist of how the confident joint is computed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confident examples are those that we are confident have true_label = k</span>
<span class="c1"># Estimate (K, K) matrix of confident examples with label = k_s and true_label = k_y</span>
<span class="n">cj_ish</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">K</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k_s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span> <span class="c1"># k_s is the class value k of noisy labels `s`</span>
    <span class="k">for</span> <span class="n">k_y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span> <span class="c1"># k_y is the (guessed) class k of true_label k_y</span>
        <span class="n">cj_ish</span><span class="p">[</span><span class="n">k_s</span><span class="p">][</span><span class="n">k_y</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">pred_probs</span><span class="p">[:,</span><span class="n">k_y</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">thresholds</span><span class="p">[</span><span class="n">k_y</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1e-8</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">labels</span> <span class="o">==</span> <span class="n">k_s</span><span class="p">))</span>
</pre></div>
</div>
<p>The following is a vectorized (but non-parallelized) implementation of the
confident joint, again slow, using for-loops/simplified for understanding.
This implementation is 100% accurate, it’s just not optimized for speed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">confident_joint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">K</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pred_probs</span><span class="p">):</span>
    <span class="n">s_label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">confident_bins</span> <span class="o">=</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="n">thresholds</span> <span class="o">-</span> <span class="mf">1e-6</span>
    <span class="n">num_confident_bins</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">confident_bins</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num_confident_bins</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">confident_joint</span><span class="p">[</span><span class="n">s_label</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">confident_bins</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">num_confident_bins</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">confident_joint</span><span class="p">[</span><span class="n">s_label</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">row</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.estimate_latent">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">estimate_latent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">confident_joint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cnt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converge_latent_estimates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#estimate_latent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.estimate_latent" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the latent prior <code class="docutils literal notranslate"><span class="pre">p(y)</span></code>, the noise matrix <code class="docutils literal notranslate"><span class="pre">P(labels|y)</span></code> and the
inverse noise matrix <code class="docutils literal notranslate"><span class="pre">P(y|labels)</span></code> from the <cite>confident_joint</cite> <code class="docutils literal notranslate"><span class="pre">count(labels,</span> <span class="pre">y)</span></code>. The
<cite>confident_joint</cite> can be estimated by <cite>~cleanlab.count.compute_confident_joint</cite>
which counts confident examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>confident_joint</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code> representing the confident joint, the matrix used for identifying label issues, which
estimates a confident subset of the joint distribution of the noisy and true labels, <code class="docutils literal notranslate"><span class="pre">P_{noisy</span> <span class="pre">label,</span> <span class="pre">true</span> <span class="pre">label}</span></code>.
Entry <code class="docutils literal notranslate"><span class="pre">(j,</span> <span class="pre">k)</span></code> in the matrix is the number of examples confidently counted into the pair of <code class="docutils literal notranslate"><span class="pre">(noisy</span> <span class="pre">label=j,</span> <span class="pre">true</span> <span class="pre">label=k)</span></code> classes.
The <cite>confident_joint</cite> can be computed using <cite>~cleanlab.count.compute_confident_joint</cite>.
If not provided, it is computed from the given (noisy) <cite>labels</cite> and <cite>pred_probs</cite>.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – A 1D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> containing class labels for a standard (multi-class) classification dataset. Some given labels may be erroneous.
Elements must be integers in the set 0, 1, …, K-1, where K is the number of classes.</p></li>
<li><p><strong>py_method</strong> (<code class="docutils literal notranslate"><span class="pre">{&quot;cnt&quot;,</span> <span class="pre">&quot;eqn&quot;,</span> <span class="pre">&quot;marginal&quot;,</span> <span class="pre">&quot;marginal_ps&quot;}</span></code>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">&quot;cnt&quot;</span></code>) – <cite>py</cite> is shorthand for the “class proportions (a.k.a prior) of the true labels”.
This method defines how to compute the latent prior <code class="docutils literal notranslate"><span class="pre">p(true_label=k)</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">&quot;cnt&quot;</span></code>,
which works well even when the noise matrices are estimated poorly by using
the matrix diagonals instead of all the probabilities.</p></li>
<li><p><strong>converge_latent_estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, forces numerical consistency of estimates. Each is estimated
independently, but they are related mathematically with closed form
equivalences. This will iteratively make them mathematically consistent.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – A tuple containing (py, noise_matrix, inv_noise_matrix).</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multi-label classification is not supported in this method.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.estimate_py_and_noise_matrices_from_probabilities">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">estimate_py_and_noise_matrices_from_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_probs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converge_latent_estimates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cnt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#estimate_py_and_noise_matrices_from_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.estimate_py_and_noise_matrices_from_probabilities" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the confident counts
estimate of latent variables <cite>py</cite> and the noise rates
using observed labels and predicted probabilities, <cite>pred_probs</cite>.</p>
<p>Important: this function assumes that <cite>pred_probs</cite> are out-of-sample
holdout probabilities. This can be <a class="reference internal" href="../tutorials/pred_probs_cross_val.html#pred-probs-cross-val"><span class="std std-ref">done with cross validation</span></a>. If
the probabilities are not computed out-of-sample, overfitting may occur.</p>
<p>This function estimates the <cite>noise_matrix</cite> of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code>. This is the
fraction of examples in every class, labeled as every other class. The
<cite>noise_matrix</cite> is a conditional probability matrix for <code class="docutils literal notranslate"><span class="pre">P(label=k_s|true_label=k_y)</span></code>.</p>
<p>Under certain conditions, estimates are exact, and in most
conditions, estimates are within one percent of the actual noise rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – A 1D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> containing class labels for a standard (multi-class) classification dataset. Some given labels may be erroneous.
Elements must be integers in the set 0, 1, …, K-1, where K is the number of classes.</p></li>
<li><p><strong>pred_probs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Model-predicted class probabilities for each example in the dataset,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>thresholds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – <p>An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">1)</span></code> or <code class="docutils literal notranslate"><span class="pre">(K,)</span></code> of per-class threshold
probabilities, used to determine the cutoff probability necessary to
consider an example as a given class label (see <a class="reference external" href="https://jair.org/index.php/jair/article/view/12125">Northcutt et al.,
2021</a>, Section
3.1, Equation 2).</p>
<p>This is for advanced users only. If not specified, these are computed
for you automatically. If an example has a predicted probability
greater than this threshold, it is counted as having true_label =
k. This is not used for pruning/filtering, only for estimating the
noise rates using confident counts.</p>
</p></li>
<li><p><strong>converge_latent_estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, forces numerical consistency of estimates. Each is estimated
independently, but they are related mathematically with closed form
equivalences. This will iteratively make them mathematically consistent.</p></li>
<li><p><strong>py_method</strong> (<code class="docutils literal notranslate"><span class="pre">{&quot;cnt&quot;,</span> <span class="pre">&quot;eqn&quot;,</span> <span class="pre">&quot;marginal&quot;,</span> <span class="pre">&quot;marginal_ps&quot;}</span></code>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">&quot;cnt&quot;</span></code>) – How to compute the latent prior <code class="docutils literal notranslate"><span class="pre">p(true_label=k)</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">&quot;cnt&quot;</span></code> as it often
works well even when the noise matrices are estimated poorly by using
the matrix diagonals instead of all the probabilities.</p></li>
<li><p><strong>calibrate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>default</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>) – Calibrates confident joint estimate <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">np.sum(cj)</span> <span class="pre">==</span> <span class="pre">len(labels)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.sum(cj,</span> <span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">==</span> <span class="pre">np.bincount(labels)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – A tuple of arrays: (<cite>py</cite>, <cite>noise_matrix</cite>, <cite>inverse_noise_matrix</cite>, <cite>confident_joint</cite>).</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multi-label classification is not supported in this method.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.estimate_confident_joint_and_cv_pred_proba">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">estimate_confident_joint_and_cv_pred_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">LogisticRegression()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#estimate_confident_joint_and_cv_pred_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.estimate_confident_joint_and_cv_pred_proba" title="Permalink to this definition">#</a></dt>
<dd><p>Estimates <code class="docutils literal notranslate"><span class="pre">P(labels,</span> <span class="pre">y)</span></code>, the confident counts of the latent
joint distribution of true and noisy labels
using observed <cite>labels</cite> and predicted probabilities <cite>pred_probs</cite>.</p>
<p>The output of this function is an array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code>.</p>
<p>Under certain conditions, estimates are exact, and in many
conditions, estimates are within one percent of actual.</p>
<p>Notes: There are two ways to compute the confident joint with pros/cons.
(1) For each holdout set, we compute the confident joint, then sum them up.
(2) Compute pred_proba for each fold, combine, compute the confident joint.
(1) is more accurate because it correctly computes thresholds for each fold
(2) is more accurate when you have only a little data because it computes
the confident joint using all the probabilities. For example if you had 100
examples, with 5-fold cross validation + uniform p(y) you would only have 20
examples to compute each confident joint for (1). Such small amounts of data
is bound to result in estimation errors. For this reason, we implement (2),
but we implement (1) as a commented out function at the end of this file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>) – <p>Input feature matrix of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">...)</span></code>, where N is the number of
examples. The classifier that this instance was initialized with,</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">clf</span></code>, must be able to fit() and predict() data with this format.</p>
</div></blockquote>
</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">pd.Series</span></code>) – A 1D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> containing class labels for a standard (multi-class) classification dataset.
Some given labels may be erroneous.
Elements must be integers in the set 0, 1, …, K-1, where K is the number of classes.
All classes must be present in the dataset.</p></li>
<li><p><strong>clf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">instance</span></code>, <em>optional</em>) – A classifier implementing the <a class="reference external" href="https://scikit-learn.org/stable/developers/develop.html#rolling-your-own-estimator">sklearn estimator API</a>.</p></li>
<li><p><strong>cv_n_folds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">5</span></code>) – The number of cross-validation folds used to compute
out-of-sample predicted probabilities for each example in <cite>X</cite>.</p></li>
<li><p><strong>thresholds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – <p>An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">1)</span></code> or <code class="docutils literal notranslate"><span class="pre">(K,)</span></code> of per-class threshold
probabilities, used to determine the cutoff probability necessary to
consider an example as a given class label (see <a class="reference external" href="https://jair.org/index.php/jair/article/view/12125">Northcutt et al.,
2021</a>, Section
3.1, Equation 2).</p>
<p>This is for advanced users only. If not specified, these are computed
for you automatically. If an example has a predicted probability
greater than this threshold, it is counted as having true_label =
k. This is not used for pruning/filtering, only for estimating the
noise rates using confident counts.</p>
</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>) – Set the default state of the random number generator used to split
the cross-validated folds. If None, uses np.random current random state.</p></li>
<li><p><strong>calibrate</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>default</em> <code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code>) – Calibrates confident joint estimate <code class="docutils literal notranslate"><span class="pre">P(label=i,</span> <span class="pre">true_label=j)</span></code> such that
<code class="docutils literal notranslate"><span class="pre">np.sum(cj)</span> <span class="pre">==</span> <span class="pre">len(labels)</span></code> and <code class="docutils literal notranslate"><span class="pre">np.sum(cj,</span> <span class="pre">axis</span> <span class="pre">=</span> <span class="pre">1)</span> <span class="pre">==</span> <span class="pre">np.bincount(labels)</span></code>.</p></li>
<li><p><strong>clf_kwargs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <em>optional</em>) – Optional keyword arguments to pass into <cite>clf</cite>’s <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method.</p></li>
<li><p><strong>validation_func</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">callable</span></code>, <em>optional</em>) – Specifies how to map the validation data split in cross-validation as input for <code class="docutils literal notranslate"><span class="pre">clf.fit()</span></code>.
For details, see the documentation of <a class="reference internal" href="classification.html#cleanlab.classification.CleanLearning.fit" title="cleanlab.classification.CleanLearning.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CleanLearning.fit</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – Tuple of two numpy arrays in the form:
(joint counts matrix, predicted probability matrix)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multi-label classification is not supported in this method.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.estimate_py_noise_matrices_and_cv_pred_proba">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">estimate_py_noise_matrices_and_cv_pred_proba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">LogisticRegression()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converge_latent_estimates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cnt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#estimate_py_noise_matrices_and_cv_pred_proba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.estimate_py_noise_matrices_and_cv_pred_proba" title="Permalink to this definition">#</a></dt>
<dd><p>This function computes the out-of-sample predicted
probability <code class="docutils literal notranslate"><span class="pre">P(label=k|x)</span></code> for every example x in <cite>X</cite> using cross
validation while also computing the confident counts noise
rates within each cross-validated subset and returning
the average noise rate across all examples.</p>
<p>This function estimates the <cite>noise_matrix</cite> of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code>. This is the
fraction of examples in every class, labeled as every other class. The
<cite>noise_matrix</cite> is a conditional probability matrix for <code class="docutils literal notranslate"><span class="pre">P(label=k_s|true_label=k_y)</span></code>.</p>
<p>Under certain conditions, estimates are exact, and in most
conditions, estimates are within one percent of the actual noise rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Input feature matrix of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">...)</span></code>, where N is the number of
examples. The classifier that this instance was initialized with,
<cite>clf</cite>, must be able to handle data with this shape.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – A 1D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> containing class labels for a standard (multi-class) classification dataset.
Some given labels may be erroneous.
Elements must be integers in the set 0, 1, …, K-1, where K is the number of classes.
All classes must be present in the dataset.</p></li>
<li><p><strong>clf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">instance</span></code>, <em>optional</em>) – <p>A classifier implementing the <a class="reference external" href="https://scikit-learn.org/stable/developers/develop.html#rolling-your-own-estimator">sklearn estimator API</a>.</p>
</p></li>
<li><p><strong>cv_n_folds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">5</span></code>) – The number of cross-validation folds used to compute
out-of-sample probabilities for each example in <cite>X</cite>.</p></li>
<li><p><strong>thresholds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – <p>An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">1)</span></code> or <code class="docutils literal notranslate"><span class="pre">(K,)</span></code> of per-class threshold
probabilities, used to determine the cutoff probability necessary to
consider an example as a given class label (see <a class="reference external" href="https://jair.org/index.php/jair/article/view/12125">Northcutt et al.,
2021</a>, Section
3.1, Equation 2).</p>
<p>This is for advanced users only. If not specified, these are computed
for you automatically. If an example has a predicted probability
greater than this threshold, it is counted as having true_label =
k. This is not used for pruning/filtering, only for estimating the
noise rates using confident counts.</p>
</p></li>
<li><p><strong>converge_latent_estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, forces numerical consistency of estimates. Each is estimated
independently, but they are related mathematically with closed form
equivalences. This will iteratively make them mathematically consistent.</p></li>
<li><p><strong>py_method</strong> (<code class="docutils literal notranslate"><span class="pre">{&quot;cnt&quot;,</span> <span class="pre">&quot;eqn&quot;,</span> <span class="pre">&quot;marginal&quot;,</span> <span class="pre">&quot;marginal_ps&quot;}</span></code>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">&quot;cnt&quot;</span></code>) – How to compute the latent prior <code class="docutils literal notranslate"><span class="pre">p(true_label=k)</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">&quot;cnt&quot;</span></code> as it often
works well even when the noise matrices are estimated poorly by using
the matrix diagonals instead of all the probabilities.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>) – Set the default state of the random number generator used to split
the cross-validated folds. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">np.random</span></code> current random state.</p></li>
<li><p><strong>clf_kwargs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <em>optional</em>) – Optional keyword arguments to pass into <cite>clf</cite>’s <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method.</p></li>
<li><p><strong>validation_func</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">callable</span></code>, <em>optional</em>) – Specifies how to map the validation data split in cross-validation as input for <code class="docutils literal notranslate"><span class="pre">clf.fit()</span></code>.
For details, see the documentation of <a class="reference internal" href="classification.html#cleanlab.classification.CleanLearning.fit" title="cleanlab.classification.CleanLearning.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CleanLearning.fit</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – A tuple of five arrays (py, noise matrix, inverse noise matrix, confident joint, predicted probability matrix).</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Multi-label classification is not supported in this method.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.estimate_cv_predicted_probabilities">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">estimate_cv_predicted_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">LogisticRegression()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#estimate_cv_predicted_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.estimate_cv_predicted_probabilities" title="Permalink to this definition">#</a></dt>
<dd><p>This function computes the out-of-sample predicted
probability [P(label=k|x)] for every example in X using cross
validation. Output is a np.ndarray of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">K)</span></code> where N is
the number of training examples and K is the number of classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Input feature matrix of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">...)</span></code>, where N is the number of
examples. The classifier that this instance was initialized with,
<cite>clf</cite>, must be able to handle data with this shape.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – A 1D array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> containing class labels for a standard (multi-class) classification dataset.
Some given labels may be erroneous.
Elements must be integers in the set 0, 1, …, K-1, where K is the number of classes.
All classes must be present in the dataset.</p></li>
<li><p><strong>clf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">instance</span></code>, <em>optional</em>) – <p>A classifier implementing the <a class="reference external" href="https://scikit-learn.org/stable/developers/develop.html#rolling-your-own-estimator">sklearn estimator API</a>.</p>
</p></li>
<li><p><strong>cv_n_folds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">5</span></code>) – The number of cross-validation folds used to compute
out-of-sample probabilities for each example in <cite>X</cite>.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>) – Set the default state of the random number generator used to split
the cross-validated folds. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, uses <code class="docutils literal notranslate"><span class="pre">np.random</span></code> current random state.</p></li>
<li><p><strong>clf_kwargs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <em>optional</em>) – Optional keyword arguments to pass into <cite>clf</cite>’s <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method.</p></li>
<li><p><strong>validation_func</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">callable</span></code>, <em>optional</em>) – Specifies how to map the validation data split in cross-validation as input for <code class="docutils literal notranslate"><span class="pre">clf.fit()</span></code>.
For details, see the documentation of <a class="reference internal" href="classification.html#cleanlab.classification.CleanLearning.fit" title="cleanlab.classification.CleanLearning.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CleanLearning.fit</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pred_probs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">K)</span></code> representing <code class="docutils literal notranslate"><span class="pre">P(label=k|x)</span></code>, the model-predicted probabilities.
Each row of this matrix corresponds to an example <cite>x</cite> and contains the model-predicted
probabilities that <cite>x</cite> belongs to each possible class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.estimate_noise_matrices">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">estimate_noise_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">LogisticRegression()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">converge_latent_estimates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clf_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#estimate_noise_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.estimate_noise_matrices" title="Permalink to this definition">#</a></dt>
<dd><p>Estimates the <cite>noise_matrix</cite> of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">K)</span></code>. This is the
fraction of examples in every class, labeled as every other class. The
<cite>noise_matrix</cite> is a conditional probability matrix for <code class="docutils literal notranslate"><span class="pre">P(label=k_s|true_label=k_y)</span></code>.</p>
<p>Under certain conditions, estimates are exact, and in most
conditions, estimates are within one percent of the actual noise rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Input feature matrix of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">...)</span></code>, where N is the number of
examples. The classifier that this instance was initialized with,
<cite>clf</cite>, must be able to handle data with this shape.</p></li>
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(N,)</span></code> of noisy labels, i.e. some labels may be erroneous.
Elements must be integers in the set 0, 1, …, K-1, where K is the number of classes.</p></li>
<li><p><strong>clf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">estimator</span> <span class="pre">instance</span></code>, <em>optional</em>) – <p>A classifier implementing the <a class="reference external" href="https://scikit-learn.org/stable/developers/develop.html#rolling-your-own-estimator">sklearn estimator API</a>.</p>
</p></li>
<li><p><strong>cv_n_folds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">5</span></code>) – The number of cross-validation folds used to compute
out-of-sample probabilities for each example in <cite>X</cite>.</p></li>
<li><p><strong>thresholds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">array_like</span></code>, <em>optional</em>) – <p>An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">1)</span></code> or <code class="docutils literal notranslate"><span class="pre">(K,)</span></code> of per-class threshold
probabilities, used to determine the cutoff probability necessary to
consider an example as a given class label (see <a class="reference external" href="https://jair.org/index.php/jair/article/view/12125">Northcutt et al.,
2021</a>, Section
3.1, Equation 2).</p>
<p>This is for advanced users only. If not specified, these are computed
for you automatically. If an example has a predicted probability
greater than this threshold, it is counted as having true_label =
k. This is not used for pruning/filtering, only for estimating the
noise rates using confident counts.</p>
</p></li>
<li><p><strong>converge_latent_estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, forces numerical consistency of estimates. Each is estimated
independently, but they are related mathematically with closed form
equivalences. This will iteratively make them mathematically consistent.</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>) – Set the default state of the random number generator used to split
the cross-validated folds. If None, uses np.random current random state.</p></li>
<li><p><strong>clf_kwargs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <em>optional</em>) – Optional keyword arguments to pass into <cite>clf</cite>’s <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method.</p></li>
<li><p><strong>validation_func</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">callable</span></code>, <em>optional</em>) – Specifies how to map the validation data split in cross-validation as input for <code class="docutils literal notranslate"><span class="pre">clf.fit()</span></code>.
For details, see the documentation of <a class="reference internal" href="classification.html#cleanlab.classification.CleanLearning.fit" title="cleanlab.classification.CleanLearning.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CleanLearning.fit</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>estimates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>) – A tuple containing arrays (<cite>noise_matrix</cite>, <cite>inv_noise_matrix</cite>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cleanlab.count.get_confident_thresholds">
<span class="sig-prename descclassname"><span class="pre">cleanlab.count.</span></span><span class="sig-name descname"><span class="pre">get_confident_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cleanlab/count.html#get_confident_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cleanlab.count.get_confident_thresholds" title="Permalink to this definition">#</a></dt>
<dd><p>Returns expected (average) “self-confidence” for each class.</p>
<p>The confident class threshold for a class j is the expected (average) “self-confidence” for class j,
i.e. the model-predicted probability of this class averaged amongst all examples labeled as class j.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – Given class labels for each example in the dataset, some of which may be erroneous,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>pred_probs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Model-predicted class probabilities for each example in the dataset,
in same format expected by <a class="reference internal" href="filter.html#cleanlab.filter.find_label_issues" title="cleanlab.filter.find_label_issues"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter.find_label_issues</span></code></a> function.</p></li>
<li><p><strong>multi_label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>default</em> <code class="xref py py-class docutils literal notranslate"><span class="pre">=</span> <span class="pre">False</span></code>) – Set <code class="docutils literal notranslate"><span class="pre">False</span></code> if your dataset is for regular (multi-class) classification, where each example belongs to exactly one class.
Set <code class="docutils literal notranslate"><span class="pre">True</span></code> if your dataset is for multi-label classification, where each example can belong to multiple classes.
See documentation of <cite>~cleanlab.count.compute_confident_joint</cite> for details.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>confident_thresholds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – An array of shape <code class="docutils literal notranslate"><span class="pre">(K,</span> <span class="pre">)</span></code> where K is the number of classes.</p>
</dd>
</dl>
</dd></dl>

</section>
 
        </article>
      </div>
      <footer>
         
        <div class="related-pages">
          <a class="next-page" href="dataset.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">dataset</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="rank.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">rank</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Cleanlab Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/cleanlab/cleanlab" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        

<script type="text/javascript">
    window.addEventListener("load", () => {
        let elements = document.getElementsByClassName("left-details");

        elements[0].insertAdjacentHTML(
            "afterbegin",
            `<code class="docutils literal notranslate"><span class="pre">cleanlab</span></code> is distributed on <a href="https://pypi.org/project/cleanlab/">PyPI</a> and <a href="https://anaconda.org/conda-forge/cleanlab">conda</a>.`
        );
    });
</script>


      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">count</a><ul>
<li><a class="reference internal" href="#cleanlab.count.num_label_issues"><code class="docutils literal notranslate"><span class="pre">num_label_issues()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.calibrate_confident_joint"><code class="docutils literal notranslate"><span class="pre">calibrate_confident_joint()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.estimate_joint"><code class="docutils literal notranslate"><span class="pre">estimate_joint()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.compute_confident_joint"><code class="docutils literal notranslate"><span class="pre">compute_confident_joint()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.estimate_latent"><code class="docutils literal notranslate"><span class="pre">estimate_latent()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.estimate_py_and_noise_matrices_from_probabilities"><code class="docutils literal notranslate"><span class="pre">estimate_py_and_noise_matrices_from_probabilities()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.estimate_confident_joint_and_cv_pred_proba"><code class="docutils literal notranslate"><span class="pre">estimate_confident_joint_and_cv_pred_proba()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.estimate_py_noise_matrices_and_cv_pred_proba"><code class="docutils literal notranslate"><span class="pre">estimate_py_noise_matrices_and_cv_pred_proba()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.estimate_cv_predicted_probabilities"><code class="docutils literal notranslate"><span class="pre">estimate_cv_predicted_probabilities()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.estimate_noise_matrices"><code class="docutils literal notranslate"><span class="pre">estimate_noise_matrices()</span></code></a></li>
<li><a class="reference internal" href="#cleanlab.count.get_confident_thresholds"><code class="docutils literal notranslate"><span class="pre">get_confident_thresholds()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=2b91c5f0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    
<script async defer src="https://buttons.github.io/buttons.js"></script>
</body>
</html>